# 自定义运行/调试配置

更新时间: 2025-12-16 15:58

## 配置应用可调试

应用是否支持调试，根据app.json5的debug字段和build-profile.json5的debuggable字段综合判断，app.json5的优先级高于build-profile.json5。

1. 在app.json5中配置debug字段：
    - true：应用支持调试。
    - false：应用不支持调试。
2. 如果没有配置debug字段，则根据build-profile.json5的debuggable字段判断应用是否支持调试。
    - true：应用支持调试。当[编译模式](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-compilation-options-customizing-guide#section192461528194916)不是release时，debuggable的缺省值是true，即支持调试。
    - false：应用不支持调试。当编译模式为release时，debuggable的缺省值是false，即不支持调试。

## 设置调试代码类型

点击**Run > Edit Configurations > Debugger**，选择相应模块，设置Debug type即可。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.05251535080832215078948574649549:50001231000000:2800:30D6C562BCBA892BC61AE236F3DAA34D422EABA9E9FDFBA7FC17FAA940668DB7.png)

工程调试类型默认为**Detect Automatically**，关于各调试类型的说明如下表所示：

**表1** 调试类型配置项
|调试类型|调试代码|
|:--|:--|
|**Detect Automatically**|新建工程默认调试器选项。根据工程模块及其依赖的模块涉及的编程语言，自动启动对应的调试器。|
|**ArkTS/JS**|- 调试ArkTS代码<br>- 调试JS代码|
|**Native**|仅调试C/C++代码|
|**Dual(ArkTS/JS + Native)**|调试C/C++工程的ArkTS/JS和C/C++代码|

## 设置HAP安装方式

在调试阶段，HAP在设备上的安装方式有2种，可以根据实际需要进行设置。

- 安装方式一：先卸载应用/元服务后，再重新安装，该方式会清除设备上的所有应用/元服务缓存数据。
    
    从DevEco Studio 4.1 Canary2版本开始，支持当代码无变化时，不进行推包安装。即根据模块有无变化来判断是否重新推送安装模块包，在运行调试时仅将有变化的模块及依赖它的模块重新推送安装至设备上。如entry依赖了HSP模块，当HSP模块有变化，运行调试时将同时推送安装HSP模块和entry模块。
    
- 安装方式二：采用覆盖安装方式，不卸载应用/元服务，该方式会保留应用/元服务的缓存数据。

设置方法如下：

单击**Run > Edit Configurations**，设置指定模块的HAP安装方式，勾选**Keep Application Data**，则表示采用覆盖安装方式，保留应用/元服务缓存数据。

说明

从DevEco Studio NEXT Developer Beta1开始，默认勾选“Keep Application Data”。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.36300365118801992255038682071625:50001231000000:2800:7290E0416AB2A3A517CB877DFC9BF90EBCA3532C3ED5304DCCAC217CAE1EED3C.png)

### 配置自定义调试参数

如果未进行自定义，将按默认配置安装和运行应用。如果开发者需要对应用安装、运行等流程增加参数配置，可在“Installation Options”和“Launch Options”下进行配置。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.67514111661176934296469635675625:50001231000000:2800:0F4EA7DBF5EF84278F232787AC9313C7382D431F364F6827D68E171CC48E6497.png)

- Installation Options
    - DebugLine Support：勾选Enable DebugLine表示在build产物中系统组件增加debugline属性，用于开启[ArkUI Inspector源码跳转](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-arkui-inspector#section1226015494335)功能。
    - Install Flags：输入bm install命令相关的选项，请参见[bm install 参数](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/bm-tool#%E5%AE%89%E8%A3%85%E5%91%BD%E4%BB%A4install)。如可以设置“-w 360”，表示将超时等待时间设置为360秒。
- Launch Options
    - Launch：指定在安装应用后启动的Ability。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.24599314596105348660936834744077:50001231000000:2800:EAFE6E541228F17D5AD1CCDF6C12256622FBCE9F8AC94639B1B1AD0A08E17456.png)
        
        - Nothing：只安装不启动任何Ability。
        - Default Ability：默认的EntryAbility。
            - Stage模型：module.json5文件中配置了“skills”属性的第一个ability；若无配置“skills”属性的ability，则取“mainElement”指定的ability（该ability需存在于“abilities”数组内）；若“mainElement”未指定，则取“abilities”数组内的第一个ability。
                
                ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.04480816525387713810749590819966:50001231000000:2800:0547D951C3EC08A7F2CAABC802F6D95A615414753C4B82E84CC9E1D737483476.png "点击放大")
                
            - FA模型：config.json文件中配置了“skills”属性的第一个ability；若无配置“skills”属性的ability，则取“mainAbility”指定的ability（该ability需存在于“abilities”数组内）；若“mainAbility”未指定，则取“abilities”数组内的第一个ability。
        - Specified Ability：工程中的UIAbility或ExtensionAbility。
            
            您可以在工程中添加UIAbility或ExtensionAbility，详细请查看[UIAbility开发指导](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability)或[ExtensionAbility开发指导](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/extensionability-overview)。
            
            ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.65128779760145425078448889561437:50001231000000:2800:6A747DCA4A0EB077B08566E5D6BEE726D55541EB7148F3358E4B4240A5678F04.png)
            
        
    - Launch Flags：输入aa start命令相关的选项，请参见[aa start 参数](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/aa-tool)。

### 配置环境变量

如果开发者需要配置和管理应用开发环境，以及控制应用程序的行为，可在“Environment Variables”下配置环境变量。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.30970569447322836205653731312493:50001231000000:2800:2C02C2E017B9CC47CC3395ECA33489428F0DF66BFD2D5E9E410D89FFECD8B4BF.png)

点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.82780400681684534511177911710160:50001231000000:2800:66BF9914FF5AB9BC4D89FCEA38E70BFA9FF23C4A0F2F04B7261D5317DD6E4827.png)按钮，新增一行配置项。当前支持以下配置项：

- ASAN_OPTIONS：在运行时配置ASan的行为，包括设置检测级别、输出格式、内存错误报告的详细程度等，具体可配置的value请参见[配置参数](https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-stability-asan-detection#section1496994494018)。若开发者未配置log_exe_name、abort_on_error，DevEco Studio将自动填充。ASAN_OPTIONS是应用级别的，只在entry和feature模块中配置生效，HAR/HSP模块配置不生效。

说明

当配置Environment Variables后，“Keep Application Data”覆盖安装不生效。

环境变量配置完成后，需确保环境变量已勾选，勾选后点击**Apply**才可生效。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.25039853754113841696293631651571:50001231000000:2800:F4E8FE6AF731A6D0B4ABC38B1C338C0FFCB82EAB8832BC9DA22C7639FD421932.png)

## 自动映射WebView调试链接

当应用中含有需要调试的WebView组件页面时，可以通过浏览器的DevTools工具进行页面调试，具体可参考[使用DevTools工具调试前端页面](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/web-debugging-with-devtools)。调试WebView组件需要执行转发端口等繁琐的命令行操作，因此可以在DevEco Studio中勾选**Auto WebView Debug**，该操作会在应用启动后两分钟内自动监听可调试的WebView进程并完成端口转发。

该功能从DevEco Studio 5.0.5 Release版本开始支持。

设置方法如下：

单击**Run** **>** **Edit Configurations**，在**General**中，勾选**Auto WebView Debug**。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.94221597650603452178208899112725:50001231000000:2800:4BFE7311A9B1DC6072479168297B47CE0BAF9C1AFA1409B7FDC7798865AF6FD4.png "点击放大")

开启后，当检测到设备上有可调试的WebView组件进程时，会在Run面板中打印转发成功的端口，通过浏览器的Devtools工具连接该端口即可进行WebView调试。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.44462028095046506240721416514463:50001231000000:2800:55F91278E90164B9B2F061E7DEC4A39E7BBDAFDDFB65150369E95B1ECAFD7941.png)

## 多模块调试

### 安装多个模块

如果一个工程中同一个设备存在多个模块（如存在entry和feature模块），且存在模块间的调用时，在调试阶段需要同时安装多个模块的Hap包到设备中。此时，需要在**Deploy Multi Hap****/Hsp**中选择多个模块，启动调试时，DevEco Studio会将所有的模块都安装到设备上。

设置方法如下：

单击**Run > Edit Configurations**，在**Deploy Multi Hap****/Hsp**中，勾选**Deploy Multi Hap/Hsp Packages**，选择多个模块。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155821.50163144208524608556194159884070:50001231000000:2800:07DEB52E49F2D2F775B9308955A2EADCD2AE1C226A2F378C28B9E9C999488E3C.png)

### 自动安装依赖

如果一个工程中entry/feature/HSP模块直接依赖其他HAR/HSP模块（如entry模块依赖HSP模块）及间接依赖其他模块（如entry模块依赖HAR模块，HAR又依赖HSP模块）时，在调试阶段需要同时安装模块包及其所有依赖模块的包到设备中。此时，可以设置**Auto Dependencies**，启动调试时会自动将所有依赖的模块都安装到设备上。

设置方法如下：

单击**Run > Edit Configurations**，在**General**中，勾选**Auto Dependencies。**

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.06163934810153526709658630706023:50001231000000:2800:36088F5EA79856FBD8D88771425D018868372DF45A1F2310DB61305C282A0F44.png)

在Before launch窗格中，您可以点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.26864856257750150952842881501496:50001231000000:2800:FDF37D33CC1F2F9E51A6CAFD269420798B92E4A22D3128C2C57E79F2572ACF1C.png)添加应用启动前的任务。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.94909566054396204065295264489032:50001231000000:2800:C43D9C72D5AFA8597C2EBD3F24B9D986B657CBDA1EFEF9861C480E3337B250C2.png)

也可以点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.95382109327572886916402550475459:50001231000000:2800:CFB47A926B1929990D684E6A33121B56B5C1E7E4C711C4165CE59D3CF7E1E9A3.png)移除任务。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.18631082489496593260295236017906:50001231000000:2800:78E5D80A168EDFBBDB044278A89B2B41F67F22943134DB0EFB89A7134CA584CB.png)

在勾选**Auto Dependencies**后，可以同时勾选**Deploy Multi Hap Packages**，从而达到推送所有包的效果。

[调试概述](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-device "调试概述")

[代码调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-code-debugging "代码调试")
# debug启动调试

更新时间: 2025-12-16 15:58

可以按照如下方式启动调试会话。

1. 如果需要设置断点调试，找到需要暂停的代码片段，点击该代码行的左侧边线，或将光标置于该行上并按Ctrl + F8（macOS为Command+F8）。如果无法添加断点，请查看FAQ[调试过程中无法添加断点](https://developer.huawei.com/consumer/cn/doc/harmonyos-faqs/faqs-app-debugging-1)。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.05299777397374082579247343096400:50001231000000:2800:38CF8CE78DBF04B224896C73B0753DCB85B989DD8A24BA6F1E89C085131636ED.png)
    
    设置断点后，调试能够在正确的断点处中断，并高亮显示该行。
    
2. 在设备选择框中，选择调试的设备。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.03410820868565388458511772403303:50001231000000:2800:E8769E07B8B0BE8F77D503930551E82234EC807336270980DA7F575D5DA0D81A.png)
    
3. 选择启动调试的配置，在模块选择框中选择需要调试的模块。也可以通过Edit Configurations[配置调试参数](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-run-debug-configurations)。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.71656565328467857741635323132142:50001231000000:2800:83C56FDB4B3910D558747AC5B057F621F38B29BBD90B82D16CA1EA3A4BD1E761.png)
    
4. 在工具栏中，单击Debug![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.57361355233592870985523029804645:50001231000000:2800:E71B87963582EF5FA51D6C4231F5051AB34940587D4EFCFC09F11C201B25765B.png)。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.24942311262787797481165400491344:50001231000000:2800:221CAA7980CE67915CB5C655E9CFC8F90E2D356B45331D5AE24655D3E92E84F5.png)
    
    或者在工具栏中Run中选择Debug。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.83452694149875753721960888915490:50001231000000:2800:370B5A6EBE3E63F6CFBC845B2747C6049517275F44C43A52B4B5A3D9FFAAD07E.png)
    
5. 启动调试后，开发者可以通过[调试器](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-debugger)进行代码调试。
    
    如有断点会在断点处高亮，并展示当前断点处的Frames和Variables。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.80116522823953581565568871305731:50001231000000:2800:C1AA91C7C8D0F94D794475E57286671A2D6D23AD4DFABD47A7ABE790E64863BB.png)
    

[调试场景说明](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-worker-taskpool "调试场景说明")

[attach启动调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-attach "attach启动调试")
# attach启动调试

更新时间: 2025-12-16 15:58

开发者也可以通过将调试程序attach到已运行的应用进行调试。

Attach Debugger和Debug的区别在于，Attach Debugger to Process可以先运行应用/元服务，然后再启动调试，或者直接启动设备上已安装的应用/元服务进行调试；而Debug是直接运行应用/元服务后立即启动调试。

## 前提条件

当前设备上被attach的应用代码和本地代码一致，且已提前进行构建生成必要的sourcemap文件。

## 使用约束

attach不支持的场景：

- 本地无源码。
- bundleName不匹配，将出现提示“The selected process does not match the bundlename of the current project!”，但不阻塞调试过程。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.73114077481453860636043888071662:50001231000000:2800:67DCA4CE21A0A76A819FC2994C7371F42B5358777505847BF5B74F8EE4C1E24F.png)
    

## 操作步骤

1. 在工具栏中，选择调试的设备，并单击**Attach Debugger to Process**![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.63044477518507369580277560067463:50001231000000:2800:5FDB2F964452655290CB98340D29C6E719535DC636D1AE3EC2CBCF16A384E509.png)启动调试。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.91767915884664381134309666580988:50001231000000:2800:8A5D7B0D0CF8054226A5316A764B45057E80DC3E02FF6835FAE7CD3F4C84EB19.png)
    
2. 选择要调试的设备及应用进程，若应用bundlename与当前工程不一致，则需勾选Show all process。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.78603556288453363264571603394435:50001231000000:2800:4FB95B7CAFC5746B5A4DF2BE5440A3B72701BF59C71028D00213DCF0D471E410.png)
    
3. 选择需要使用的调试配置，或者使用默认配置。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.82226769181215697777030686884832:50001231000000:2800:3AA3F0FD99B0FD4091FE317A58D6D326440A157AE803CC6DC2D5CF37653CA42E.png)
    
4. 选择需要调试的Debug type，若选择已创建的Run/Debug configuration进行attach调试，此时Debug type不可改变，只可在Run/Debug configuration界面修改。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.40695505433580850783724399851468:50001231000000:2800:3DEC5A38074055105CC51B86DE1FC0569CD2D281772C7CA6A007BF024B0B000A.png)
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.39799376376528067338797915891644:50001231000000:2800:A7880BF1C44B2F2E7B24C1E61EF6A961BF1B95C3AC076D6FEE3BE41841CE5F8A.png)
    
5. 点击**OK**开始attach调试。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.96912355714447237326032407246070:50001231000000:2800:A81F886E88F948C354F52FD403972796DC3F2923D563E5DFD6273FEA8088348E.png)
    

[debug启动调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-debug "debug启动调试")

[等待调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-attach-to-process "等待调试")
# 等待调试

更新时间: 2025-12-16 15:59

开发者可以通过将某个应用设置为“等待调试模式”，然后当开发者需要对应用进行调试时，拉起应用即可快速进入调试。

说明

- 应用设置为“等待调试模式”后，此时如果启动普通的debug调试，将会取消当前的等待调试模式。
- 设置“等待调试模式”前，需要将应用安装到设备上。

## 操作步骤

1. 在设备选择框中选择调试的设备，并单击Run > Attach to Process by Name。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.24050862801663983981898518211948:50001231000000:2800:F7378ECED829A79727C635A35FA415D8D51055BF3480FEE56BC09D0AF53911C6.png)
    
2. 选择需要设置为“等待调试模式”的应用（默认为当前工程），选择需要进行调试的调试类型。然后单击**Attach**，即可将该应用设置为“等待调试模式”。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.16290623798309468020383080041823:50001231000000:2800:37F0899A02BE87A7494854929CF38B8FCA08B4109FAAC8F7A68A9CC873DD568C.png)
    
    此时会在DevEco Studio底部显示一个等待进度条，在应用被拉起之前，将一直处于等待状态。可通过进度条右侧的取消按钮进行取消。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.09706864972044916101854289974597:50001231000000:2800:823EF6DFBB7C25685710605378AAA2B84051DF228BA243D1DA3A63DC4BD01861.png)
    
3. 拉起设备端应用，此时将会进入调试。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155900.11277678297905734708238427087795:50001231000000:2800:11BB8DDBB39EEF4D2C2EB03CB0C06345AB7AAD710F38A633A41741DCB40E98F5.png)
    

[attach启动调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-attach "attach启动调试")

[使用断点](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-breakpoint "使用断点")
# 使用断点

更新时间: 2025-12-16 15:59

DevEco Studio ArkTS支持行断点、日志断点等多种不同类型的断点，这些断点可以触发不同的操作。

## 行断点

行断点是最常见的类型，用于在指定的代码行暂停应用的执行，在暂停时，您可以检查变量，对表达式求值，然后逐行执行，以确定运行时错误的原因。

如需添加行断点，请按以下步骤操作：

1. 找到您要暂停执行的代码行。
2. 点击该代码行的左侧边线，或将光标置于该行上并按**Ctrl + F8**（macOS为**Command+F8**）。
    
    当您设置断点时，相应的代码行旁边会出现一个红点，如图。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155900.66041234803610472673702907223668:50001231000000:2800:CCFC82ED1F65018EC66D5B38B4356631321F1D5EAC9C51316B7593E2608A670D.png)
    
    在设置的断点红点处，单击鼠标右键，在Condition中可以设置条件断点，此类断点仅会在满足特定条件时才会暂停应用。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155900.44508183694538623887355544488469:50001231000000:2800:AB5555168BEF46FE938786F242923A613C3DBE2729CA21AADD3D93DF5BD5C718.png)
    
3. 点击Debug图标![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155900.71746235248221745541025608805587:50001231000000:2800:E972DE51E99AEEDB7DE5C9C6A4210891969C4AEF8221E20569ACDD27223B635A.png)，开始调试。如果您的应用已经在运行，请点击Attach Debugger to Process图标![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155900.24269294883831650157347293798583:50001231000000:2800:B11CD519814FB49F5F58395A3CABC2FDE133A804BF2C0FF269D5F874D273EC21.png)。
    
    当应用运行到代码处，会在代码处停住，并高亮显示。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155900.62785492361745841173516273834797:50001231000000:2800:3A8EBD81422BC9E8D873E0EE36CBF3801AE866B311F2C0CF32EE12BCD85EC4A2.png)
    

## 日志断点

在[BreakPoints](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-breakpoint#section168791742202819)某个断点的配置中，勾选以下类型的Log，可以使进程运行到断点时在Console窗口打印相应日志。

- 勾选**"Breakpoint hit"message**，程序运行到断点时，打印“Breakpoint reached”。
- 勾选**Stack trace**，程序运行到断点时，打印当前线程的堆栈。
- 勾选**Evaluate and log**，并添加表达式，程序运行到断点时，打印表达式的值。

说明

未勾选Enable的断点不会打印日志，未勾选Suspend execution的断点会打印日志，不满足所设置的Condition的断点不会打印日志。

## 临时断点

在[BreakPoints](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-breakpoint#section168791742202819)某个断点的配置中，勾选**Remove once hit**，该断点只生效一次，生效后该断点会被删除。

## 函数断点

从DevEco Studio 6.0.0 Beta2版本开始，支持在ArkTS代码中设置函数断点。

函数断点也叫方法断点或符号断点，使用函数名设置断点，当程序运行到对应函数时，中断进程。

在[BreakPoints](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-breakpoint#section168791742202819)中，点击**+ > ArkTS Symbolic Breakpoints**，在弹出窗口中填写函数名，添加函数断点。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155900.25117331778974769211194958759464:50001231000000:2800:2BCF9F6B089A1592914D1CE9A14848953BFBE8628CD143F90A8639EA85435629.png) ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155900.12291682907223484147727742485433:50001231000000:2800:89FB724B626E5DFDBB8C5ECBADF3703771959FC1B0B9A24B32A6E100CED4362B.png)

说明

调试过程中如果命中在C++断点，则无法添加和移除ArkTS函数断点。

## 异常断点

异常断点会在应用执行时发生异常的地方暂停应用。

在[BreakPoints](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-breakpoint#section168791742202819)中，勾选**ArkTS/Js Exception Breakpoints**，开启异常断点。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155900.43361606843815735145420178895973:50001231000000:2800:15BAF8B0D191F32CA436F9F7CBDFFDD125B384B7D87703ED607DEE873589C62D.png)

当调试应用程序中出现异常时，会在异常处高亮，并且代码左侧有![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155900.68052918347596524587840091276148:50001231000000:2800:23E571DB25B12FC5227AB7D56546129CCE6A80A4829C493E85691B03AA773EE8.png)标志，并展示当前Frames和Variable，以及错误信息。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155901.47750188718130393145352030065497:50001231000000:2800:5AE1C8F7B1B7502B5A92222A70C3AA681038DB76148F5FDBC7F064D8C29F061F.png)

## 断点管理

在设置的程序断点红点处，单击鼠标右键。然后单击**More**或按快捷键**Ctrl+Shift+F8**（macOS为**Shift+Command+F8**），可以管理断点。

或者在“Debug”窗口中点击**View Breakpoints** 图标![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155901.12364719037888770449655845620744:50001231000000:2800:9C3BBC6E8B1215BE83E266F7811C6D752DCA94F0AEAD47CE1D660CE3F256C530.png)。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155901.74486975530343838900189854100458:50001231000000:2800:29B44F68F61BC97A97EA623A6783254CEAF60549CF6F699B2EE934D75FFC3B8F.png)

[等待调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-attach-to-process "等待调试")

[检查变量](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-variables "检查变量")
# 检查变量

更新时间: 2025-12-16 15:59

当应用停止在某个断点处时，您可以在"Debugger"窗口中查看当前的变量信息。当您在"Frame"窗格中选择某个帧之后，您可以在"Variable"窗格中检查变量。此外您还可以通过对变量进行计算。

如需向"Watches"列表中添加变量或表达式，请按以下步骤操作：在"Watches"窗口中输入表达式，然后点击Add to Watches 图标![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155901.08955024178086582616085180484050:50001231000000:2800:BD2AD12B63C391DAD70827DEBDA20D6D8D4BBC61EF9A0AB8C19834D32B5513C9.png)。

如需从"Watches"列表中移除某一项，点击鼠标右键，选择Remove Watches。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155901.93903102895767797385866849787611:50001231000000:2800:A13312BBCB91D342EB243DF3B1ACAC42B1B54CFBF26F9ADBA1B71D47B783E7F7.png)

[使用断点](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-breakpoint "使用断点")

[反向调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-reverse "反向调试")
# 智能步入

更新时间: 2025-12-16 15:59

当编辑器上一行存在多个函数嵌套或调用时，开发者可以通过Smart Step Into的能力来步入到想要调试的函数内，如果在调试时想跳过某些文件，也可以自定义需要跳过的文件列表。

## 智能步入

1. 启动调试，如果断点所在的一行内存在多个方法调用，可以通过点击调试窗口的![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155904.83721633853366279294288781854850:50001231000000:2800:7CC57D1799D04E0DF0612A1BC8C028F243D613496CCDB16D17B93E9F16A5252A.png)按钮或快捷键Shift + F7高亮展示可进入函数。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155904.41778122247500852307386029870605:50001231000000:2800:89BF4A9BF8C54129E162BA321FCFF74186E353932562A1E8ECD9E9BFFD41C4DD.png)
    
2. 点击其中一个函数即可步入。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155904.00971713803704502925397431442230:50001231000000:2800:DC4B304C7D94276499128A6A2814DF4D8C91E2EC5B061444B22C85C0A86ABA31.png)
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155904.44220051720765874241716281347130:50001231000000:2800:932AD74DC2A377F8762C4940D74B488CEA13E3B609BA56A0DB53F4201FA39CF0.png)
    

## 过滤脚本文件

1. 点击**File > Settings**（macOS为**DevEco Studio > Preferences/Settings**） **>** **Build, Execution, Deployment > Debugger > Stepping**，勾选**Do not step into ArkTs scripts**， 可在调试时禁止智能步入某些脚本。使用工具栏按钮管理要跳过的脚本列表。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155904.53834438657326144479130705646258:50001231000000:2800:D115E762210F2575A138E14B8B18686593FA84BD87D7DF0917946B6DC3D0995B.png)
    
2. 单击 **+** 按钮可添加新的脚本过滤器。在打开的对话框中，输入要跳过的文件名称或使用通配符。例如，如果要始终跳过 JavaScript文件，请输入 *.js。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155904.20899738946813706683989464005347:50001231000000:2800:209E6363D100AB8DC5FA6E7B0AFB5C35D194E5093C0562ED10DFF00E1FED8182.png)
    

[打印表达式](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-evaluate-log "打印表达式")

[查看异步函数堆栈](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-async-stack-traces "查看异步函数堆栈")
# 启动调试

更新时间: 2025-12-16 15:58

Native代码调试依赖LLDB调试器，关于LLDB调试器的介绍请参考[LLDB高性能调试器](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/debug-lldb)。

在启动调试前，点击**Run > Edit Configurations**打开调试配置界面，在**Debugger**页签选择**Debug type**为Dual (ArkTS/JS + Native) 、Native 或Detect Automatically，设置调试代码类型为C/C++。

说明

- Detect Automatically类型会根据当前工程是否为native工程判断是否启动native调试。

- 如果调试时启用编译器优化，增加编译优化选项或使用[release编译模式](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-compilation-options-customizing-guide#section192461528194916)等，编译器会对编译后的汇编指令进行更改，从而使得代码运行更加高效。但优化后的指令难以与原始代码形成映射关系，可能会导致在调试的过程中出现异常或错误信息，例如局部变量信息被删除、无法正确跳转到期望的代码行等。因此，在调试的过程中需要关闭编译优化选项或者使用debug编译模式，避免因优化而导致的异常。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155853.85719001364658089476140931366606:50001231000000:2800:5271D07D3D8A6F7343502FB300DDF7483839AAA70004150651B168545F45FEA2.png)

**Debugger**页签中还支持自定义以下配置：

- **查看静态/全局变量：**勾选**Show static/global variables in the Variables Pane**，调试过程中变量列表会展示静态/全局变量。
- **符号表路径：**在**Symbol Directories**页签，点击**+**，可以添加符号表路径，即带有调试信息的so库。例如，您可以先编译带有调试信息的so库，然后将其调试信息裁减掉，在设备侧运行无调试信息的so库，调试时将带有调试信息的so库路径添加在这里，可以实现对该so库的调试。
- **预设调试器命令：**在**LLDB Startup Commands**页签和**LLDB Post Attach Commands**页签中预设lldb命令。在**LLDB Startup Commands**页签中的命令会在LLDB调试器启动之后立即执行，在**LLDB Post Attach Commands**页签中的命令会在LLDB调试器成功attach到进程之后执行。
    

配置完成后可启动Native代码调试，支持debug和attach模式启动调试，详细内容可参考[debug启动调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-debug)或[attach启动调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-arkts-attach)章节。

[Native代码调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-native "Native代码调试")

[使用断点](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-native-breakpoint "使用断点")
# 使用断点

更新时间: 2025-12-16 15:58

点击**View Breakpoints** 图标![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.31719789399837380096688363459589:50001231000000:2800:6483401FAD7DC79CA84035552982D2AFFF0C10EECF26E3CBC444275353B0888F.png)可以打开断点管理界面，您可以在断点管理界面查看或更改您的断点。

- 勾选 Enable ，使能该断点。
- 勾选 Suspend execution ，使程序运行到断点时中断。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.58683832793066325456503711151067:50001231000000:2800:3555BB9FBBD262464A2C31C57ACDA7296844CDFB1D8DFF0ABFF04ABAF4C2C820.png)

## 条件断点

在某个断点的配置中，勾选 Condition ，并设置表达式作为条件，使程序运行到断点且满足设置的条件时才会中断进程。

## 日志断点

在某个断点的配置中，勾选以下类型的log，可以使进程运行到断点时在 console 窗口打印相应 log。

- 勾选“Breakpoint hit”message，程序运行到断点时，打印“Breakpoint reached”。
- 勾选 Stack trace，程序运行到断点时，打印当前线程的堆栈。
- 勾选 Evaluate and log，并添加表达式，程序运行到断点时，打印表达式的值。

说明

未勾选 Enable 的断点不会打印日志，未勾选 Suspend execution 的断点会打印日志，不满足所设置的 Condition 的断点不会打印日志。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.49521885036487076527077780953249:50001231000000:2800:115603371879108A3521FB347944F9329E72CAAF992C33FB7223DD9F2E9F5013.png)

## 临时断点

在某个断点的配置中，勾选 Remove once hit，该断点只生效一次，生效后该断点会被删除。

## 函数断点

也叫方法断点或符号断点，使用函数名设置断点，当程序运行到对应函数时，中断进程。

在断点管理界面中点击“+”->“Cpp Symbolic Breakpoints”，在弹出窗口中填写函数名和模块名（模块名可缺省），添加函数断点。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.61335186504332180957496487615350:50001231000000:2800:4D5EED29C65B1B256DDAE6D56FF1DEF547A733A744A68F1D9A0DC0DFBA910666.png)

## 异常断点

异常断点可以使程序运行到抛异常或捕获异常的代码处停住。

说明

其他系统异常，如 SIGSEGV 等信号量异常会默认捕获并中断进程。

在断点管理界面中点选 “Cpp Exception Breakpoints” 下的 “Any exception”，勾选 Enable 使能异常断点。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.95510098359798297711045449567350:50001231000000:2800:EA786C622C1B3B56C1DB5850694005489C8DA56F3E89CF9BBE978BF5D3AE486C.png)

## 数据断点

支持三种类型的数据断点，即变量被读、被写、被读写时中断进程。

在变量列表中对某一个变量右键，在菜单中选择添加数据断点。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.63659187239666251517155055320086:50001231000000:2800:82CE7AE7DE6DD7B7B0598A2E56E8F4F06EA375B7DC9549C8866292C238DD017A.png)

在断点管理界面进行查看和修改。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.08632548067836614609716546377862:50001231000000:2800:E2A4A3560E2A2CD85B51C9D32FCF7738FFE4DA85DC23FFD47AC3D635D90AD6EC.png)

说明

1. 数据断点支持的类型受硬件限制，支持设置数据断点的变量类型 size 不能超过硬件支持的范围；
2. 受硬件限制，最多同时设置 2 个数据断点；
3. 对局部变量设置的数据断点，需要在离开作用域时手动删除，否则会由于变量地址被重用导致进程中断。

[启动调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-native-enable "启动调试")

[检查变量](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-native-variables "检查变量")
# 检查变量

更新时间: 2025-12-16 15:58

调试时，在“Variables”页面查看变量，支持查看全局/静态变量、寄存器变量和局部变量。

## 查看全局/静态变量

点击“Edit Configurations...”打开调试配置，在 native 调试配置界面中勾选“Show static/global variables in the Variables Pane”，调试过程中变量列表会展示全局/静态变量。

## Simplify STL

在菜单栏点击“File > Settings（macOS为DevEco Studio > Preferences/Settings） > Build, Execution, Deployment > Debugger > C++ Debugger”，通过勾选“Display STL variables as visualization in the Variables Pane”在变量列表中展示简化后的 STL 变量值，或去掉勾选以展示其原始结构。

## 变量监视

在"Watches"列表中输入表达式，然后点击Add to Watches 图标![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.25080539865442102074782396034210:50001231000000:2800:2F629799201E3B9815C0D3B50E4CF7EBC2B1DDF52BD5753A06E2A718F596ADBB.png)，或在某个变量右键菜单中的“Add to Watches”添加监视的表达式，在每次程序停住之后会计算表达式的值。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.26402104392734593690035601369638:50001231000000:2800:88F726F16E56EF68E195FB930D7169BFEA39ACF285B1CB47AF48D90A8582B37A.png)

## 表达式求值

通过点击“Evaluate Expression...”按钮，或Watches 页面中的输入行中，输入表达式进行计算。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.81680174618710159388330145539094:50001231000000:2800:48C16C95DD386ECE0C951A93EE5690B2649846F26E193131455498DE1CD779C8.png)

## 查看十六进制视图

在“Variables”页面点击鼠标右键，弹出框中选择“Show As Hex Values”，此时页面中的整型变量会以十六进制进行展示。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.42996152328753386732972108316490:50001231000000:2800:731BD1C03226A8053302181270A19CF0B2A08EA65AE90AE431BCEB48D644A974.png)

## 查看函数返回值

当使用“Step Out”从一个函数内步出后，变量列表中的“ReturnValues”会展示所步出函数的返回值。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.48070080590575625797176486844698:50001231000000:2800:0C911E3C223B5ACC6D4C7ED9D250664785817EBEAE8E3E81496A230A5E001AAC.png)

说明

- 无法查看长度超过64位的数据结构。
- 无法查看引用类型返回值。
- Step Out返回的位置存在断点时，无法查看函数返回值。

## 其他说明

对于特定类型的变量，还支持查看bitmap预览、查看较长的字符串等功能。

- ...View Bitmap：支持在调试时查看bitmap预览。

- ...View：支持展开查看较长的字符串。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155859.58996109801295554274191879491578:50001231000000:2800:5F23F5E9B44149D61F6E6352803123A223D9F0669B054776EE988386DE2B7C6A.png)

[使用断点](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-native-breakpoint "使用断点")

[汇编调试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-debug-native-disassembly "汇编调试")
# 开发者选项

更新时间: 2025-12-16 15:58

HarmonyOS系统上的“设置”包含开发者选项的界面，用于辅助HarmonyOS应用程序开发、测试及优化，面向开发人员提供商业发行版之外的功能（如API能力），提供更多的调试选项及能力；您可在该界面中通过配置选项来帮助您分析和调试应用，例如，您可以通过启用USB/无线调试进行应用调试、开启DFX稳定性相关选项获取更多应用的故障及性能信息、开启过度绘制等选项快速发现性能问题等等。

## 启用开发者选项

在Phone或Tablet上查看**设置 > 系统**中**开发者选项**是否存在，如果不存在，可在**设置 > _具体的设备名称_**中，连续七次单击**软件版本**，直到提示“开启开发者选项”，点击**确认开启**后输入PIN码（如果已设置），设备将自动重启，请等待设备完成重启。

## 禁用开发者选项

在Phone或Tablet上点击**设置 > 系统** **> 开发者选项**，关闭开发者选项开关，弹出提示框后点击确认关闭，设备会自动重启。

## 常规选项

- **充电温度限制**：防止手机充电时过热，用于对充电温度进行严格控制。
- **系统回退**：支持开发者将终端设备从HarmonyOS NEXT回退到HarmonyOS。

## 调试

- **USB调试**：如果开发者希望通过计算机侧命令对移动设备进行调测，需要启用USB调试，同时通过设备授权确认。开启并授权后，HarmonyOS设备才能连接到计算机进行调试，可用于在计算机和设备之间复制数据、在设备上安装或卸载调试应用、以及读取日志数据等。

- **无线调试**：通过Wi-Fi进行设备连接从而实现设备的调测，在开启无线调试后，可以查看设备的IP地址和端口，通过[DevEco Studio或hdc命令](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-run-device#section9315596477)进行设备连接。使用过程中需要确保您的设备与计算机在同一个Wi-Fi网络中，初次连接需要进行设备授权确认。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155828.11927119291776080171020431845205:50001231000000:2800:843931B00F37A9EED0D95C4AFE8406FE50AA234EA7D6A7B5EC1810E3A9FD38AC.png "点击放大")
    
- 清除受信任设备：针对之前授权过的所有计算机，撤销USB/无线调试的访问权限。

DFX稳定性配置选项包括：

- **系统trace跟踪**：可以将系统采集的trace落盘到本地文件，便于本地问题定位及故障上报。
- **冻屏信息日志**：稳定性在故障时会生成稳定性日志，提供更详细的日志信息。
- **系统资源泄漏日志**：稳定性在故障时会生成内存相关日志，用于定位资源泄漏问题，提供更详细的日志信息。

其他调试选项包括：

- **意图框架调试**：方便开发者在设备上验证意图框架，可以关闭部分校验机制并直接显示最近使用的意图。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155828.81773234257242762208488156114633:50001231000000:2800:5DC3026545CAB82E7C1E259DF6EC2D00B3D3B5E3818B84CD3D176EC12F84E634.png "点击放大")
    
- **显示刷新频率**：刷新频率是指显示器每秒钟更新画面的次数，可在屏幕左上方显示刷新率档位和RenderService实时帧率，更好地了解设备性能和屏幕表现，从而进行针对性的优化或调整。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155828.16621699820060918222544913433875:50001231000000:2800:BA21BCFE3BE280598FC98CD2D69C6BF79D236FDCDA3AAEA33DA63AB8EC56C0D1.png "点击放大")
    
- **关闭充电**：连接USB后默认充电，如果开发者希望不充电，需手动打开开关，插拔USB后可恢复默认充电状态。

## 网络

- **网络领航员**：开启网络领航员后，开发者可以选择预置的网络模拟场景或者自定义网络模拟场景进行网络验证，提升APP体验的测试及验证效率，具体使用方式请参考[网络领航员](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/network-navigator)。

## 输入

- **显示触摸操作：**开启开关后，当用户触摸屏幕时, 会有一个小圆点跟随手指移动，显示用户的触摸动作。
- **指针位置：**开启指针位置后，屏幕上会出现十字准线，可以显示指针（点按）位置。屏幕上方会显示一个条形，用于跟踪十字准线的坐标。移动指针时，该条形中的坐标会跟踪十字准线位置，且屏幕上会绘制出指针路径。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155828.58559922511969630330930933409484:50001231000000:2800:3770113E884DB1193C56BFA8A841E2CD6FE60FF85DB26BF3E7221963A0231A26.png "点击放大")
    

## 绘图

- **显示布局边界**：开启后可以显示应用的裁剪边界、外边距和设备上的其他界面结构，方便开发者查看控件布局、空白空隙及控件重叠等问题。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155828.57969270680465282979408242145298:50001231000000:2800:FBAB60B097F8CC19F5504736FC4A1936D23957F791D5887ED7D7631A7581AE30.png)
    

- **显示重绘刷新区域**：当点击、滚动屏幕或者系统自动刷新使得屏幕上的某块区域重新绘制时，该区域突出显示。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155828.27548776010297609318374738463235:50001231000000:2800:AA5E72FF738D8E70E2A36F64F978860E255BBD77772EAF477646D5C3F7715114.png)
    
- **缓存是否命中检测**：在一些属性动画的场景下，您可以使用renderGroup缓存提升属性动画性能；开启选项后，检测缓存未命中的场景，通过颜色标识。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155828.26268726514423388149327053529621:50001231000000:2800:B9DA1FAF907B567A613C2A738F5DE3A1D0C2E456D7968C86054CA6EF7B7BF6A1.png "点击放大")
    
- **过度绘制检测**：显示设备上的颜色编码，以便可视化相同像素在同一帧中绘制的次数，可视化会显示应用可能在哪里进行了不必要的渲染。过度绘制的程度可以通过颜色来表示。
- **过渡动画缩放**：设置过渡动画播放速度，便于开发者查看不同速度下的性能。缩放越小，速度越快。

## 应用

- **开发中元服务豁免管控**：嵌入式运行元服务能力默认是受限的，需要开发者申请权限才能使用。如果在申请权限之前的开发调试阶段想临时开启权限，可以通过开启本选项获取调试嵌入式元服务的权限。

[Hot Reload](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hot-reload "Hot Reload")

[布局分析](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-arkui-inspector "布局分析")
# 布局分析

更新时间: 2025-12-16 15:58

开发者可以使用ArkUI Inspector，在DevEco Studio上查看应用在真机上的UI显示效果，并通过查看多次操作后的界面状态，快速分析定位UI界面存在的问题。

ArkUI Inspector支持的功能包括：

- 查看设备上应用的UI显示效果。
- 导出及导入应用UI界面快照，脱离设备查看UI显示效果。
- 在组件树上选择组件，UI界面自动框选对应组件，属性列表显示当前组件的属性信息。
- 在UI界面点击选择组件，组件树对应组件变化为选中状态，属性列表显示当前组件的属性信息。
- UI组件源码跳转，选中UI组件后点击源码跳转按钮即可跳转至源码位置。
- 在UI界面上选择Show Component Border，可查看当前页面上所有组件显示区域。
- 在组件树上选择自定义组件，属性列表显示当前组件配置的状态变量信息以及影响组件。
- 按照组件粒度3D展开应用，方便查看组件之间的嵌套、遮挡关系。

## 使用场景

针对界面较复杂的应用：

- 通过组件树查看组件的父子关系，检查是否存在冗余组件。
- 针对应用在真机或模拟器上运行出现UI界面显示异常，尤其经过多次界面复杂操作后产生的界面错误以及后台逻辑错误，进行问题分析定位。

## 使用约束

- 仅运行在前台的应用支持Inspector查看。
- 已通过USB或WLAN连接设备。
- 仅支持Stage工程。
- 仅支持全屏应用或者焦点在前台的窗口。
- 不支持应用市场上架的商用签名应用。

## 操作步骤

1. 在DevEco Studio下方点击**ArkUI Inspector**，打开ArkUI Inspector。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.44904173516017131412722663949599:50001231000000:2800:35C636689134E84343183DFEB6E9F2FCAAF40E6686D37E28CFD4913D5B6B8155.png)
    
2. 点击RUN![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.52997774335073682124856061942007:50001231000000:2800:44B0FA640858B53591778F7B5437841A7B90BD5098B52A69B173846440E9E32F.png)或者DEBUG![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.35156370534972925835627684911275:50001231000000:2800:524D719369BB0FAE34A441F616361F85CC5AA4FEB877CDFD65EFE3C4114587BD.png)按钮，将应用推包到设备上，在设备应用列表选择当前显示在设备前端的UI进程。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.03206796260568088352242594489079:50001231000000:2800:B1EF2C2E67108DA2FFC5940F4620E736F21EE9D5A3389A0189D5A294AC5E3D32.png)
    
3. ArkUI Inspector左侧为当前的组件树结构，中间栏显示当前设备的UI界面，右侧在选中组件的情况下为当前组件的属性信息。可以在左侧组件树上或在中间UI界面点击选择组件。当设备上UI发生变化时，可点击中间栏右上角![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.18918526689863328371101462182968:50001231000000:2800:685145FEB324F73E27B6CD119471C3B9257413F63D8ED3515821A2027C9A1E76.png)按钮同步设备上的UI效果。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.47493625358251712676705311256470:50001231000000:2800:3656E6D5A3DFF7E6CA0F6662751A177DC76A672702BBFE231D6CD7719B676899.png)
    
4. 在设备框，点击设备列表的最后一项**Stop inspector**，可断开与设备的连接。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.22328912251936632499171064511838:50001231000000:2800:6B980F52CF72A037CEC13043EA0F5BA9E16D6B20182B236D2FA312E2223235D4.png)
    

## 显示组件信息

- 点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.23117530886231776888028191325519:50001231000000:2800:886148A1E38514961F09918C8F9F9F6F7165225AD3801A13A2D15D737E5106E9.png)，勾选**Show Tree Statistics**，可显示组件树组件信息。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.25832555001216170681536735947901:50001231000000:2800:1708CFDF10999F688B419C1073C030A472CA3E6610592E472D2CFD2EDE3DAE23.png)
    
- 点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.75568552679935444051898101813516:50001231000000:2800:631920121653E177E993335D1CA73661F7B178EFCE73C30DA98FDDED454C1028.png)，勾选**Show Hidden Components**，可显示隐藏的组件。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.04247680534793792600076314552049:50001231000000:2800:F5195E5B1E7F45A1C8297A86B611AB241AB96774DB4BD6C32A5848A134E00754.png)
    
- 点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.50598708685659175944302126217606:50001231000000:2800:A9B7C2CFA6754420A649596D10F24BC9DBF5FC3F4056F58BDC7EF8C99AE7F629.png)，勾选**Show Custom Components**，可过滤自定义组件。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.79792075252592340939755978928885:50001231000000:2800:6559582D7F9F7A1D527E14C5CBB8F366A298787DF19404447B9EB84650520286.png)
    
- 点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155829.51655821434335293442260561178972:50001231000000:2800:2491FC98FA32768452D10BCB6C2D082E9F24910EA017622321D20D6464A71603.png)，勾选**Show System Components**，可过滤系统组件。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.26595564147773551336706076534463:50001231000000:2800:1CDDE5493970ADD6BE6B47FEBC19997CBF89502DA5D8760A382A4AA8D17B6B46.png)
    

## 导入/导出UI界面快照

ArkUI Inspector支持导出及导入应用UI界面快照，脱离设备查看应用UI界面显示效果。

- 在中间栏点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.29971392320434329796225470464985:50001231000000:2800:F9430FB243BDE581C56F6100DFE348C3CB82896A29CB222DED5A4E2AC3E503AC.png)可以导入本地的应用UI界面快照。导入成功后将在DevEco Studio中打开该快照。
- 在中间栏点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.72247785462851528477082530206044:50001231000000:2800:16FD603C899A59F45B854F1B855D6D10AAF2EB04438649106618EBEAFDA7F2CD.png)可以将应用UI界面快照导出到本地。导出成功后将默认在DevEco Studio中打开该快照。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.60184613770540624287212779879719:50001231000000:2800:4AE7804DBF20CAEA8D956EA8F342729A77C8F5ED5F4D0C2FCE4BB552DDC804BB.png)

## UI组件源码跳转

1. 单击**Run > Edit Configurations**，勾选“**Enable DebugLine**”，点击**OK**保存后，重新运行工程，表示开启源码跳转功能。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.80658635726403905055546421596131:50001231000000:2800:5F8B3CDAE434073B6D2EB44E733EE2FD943B8EBC900D63B052591F26A3D70E0F.png)
    
2. 在ArkUI Inspector中，选中要进行源码跳转的UI组件，点击右侧的源码跳转，即可跳转到UI组件源码位置。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.79211679995702572468792754991299:50001231000000:2800:AC32EF686B1C9DBA077D89C0DFF2E1AC7059553D1A6C9D01CBAA83193E228ACF.png "点击放大")
    

## 显示布局边框

在UI显示设置上，勾选“**Show Component Border**”，可显示当前页面所有组件的布局信息。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.17053560785247949310906877812831:50001231000000:2800:09580E279289CB45C70AD51459970AE97EE5D20537575B89484F2EF5775C518C.png)

## 查看UI组件的状态变量

点击自定义组件，可以查看自定义组件的状态变量，以及状态变量影响的下一层组件。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.81878634436897010384591348005721:50001231000000:2800:7B2C88C7C0C590E16F2DA180B6198C0ED3F08E8E1582D8309317CCEE1AD55677.png)

## 3D展开应用

ArkUI Inspector支持将应用按照组件粒度进行3D展开，即UI界面能够在Z轴展开，方便查看组件之间的嵌套、遮挡关系。

该功能从DevEco Studio 6.0.0 Beta1版本开始支持，同时设备系统版本需要升级到API 20。

### 使用场景

- 点击图层可以精准选中和查看被遮挡的组件，可用于定位组件是否被遮挡等问题。
- 3D视图展示的图层均是组件树上参与渲染的组件，可帮助开发者判断组件是否需要进行渲染，例如过长的列表、不可见区域是否需要渲染，帮助开发者优化渲染性能。
- 对于页面复杂、小组件较多的场景，在组件树或者2D视图中难以选中，通过3D视图增加图层之间的距离，能够有效地突出小组件，使其更易于选中。

### 进入3D视图

点击3D View按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.09963512365247821737100900708863:50001231000000:2800:C2AAE34F9249A47920E10EEFAC9101E5B645B9749744A57ECEE10F25227560C2.png)，进入3D视图。首次进入3D视图会加载3D数据，请等待数据加载完成。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.42056755624252841179892046180572:50001231000000:2800:5665E097AD57942F76EC957BD4AEE0C172D314890CCF0043D33B85BBF040BF43.png)

### 基础操作

- 旋转视图：按住鼠标左键移动。
- 平移视图：按住鼠标右键移动。
- 放大/缩小视图：滚动鼠标滚轮。

### 隐藏前方图层

选中图层后，图层会显示蓝色边框，点击Hide Views in Front按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.01569344000280545959397319484899:50001231000000:2800:E7BC0A76957FED353525BB70E43283054F598D15B7A9A1900FA4E5409A1F4B08.png)，能够隐藏当前选中图层前方（朝向用户）的所有图层，避免不必要图层的干扰。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.82636104338977323701537820930714:50001231000000:2800:88A88F23021074314E9C841AA0687FC4119B7C6A7709D0F4BD9B45E22F118E3F.png)

### 隐藏后方图层

和隐藏前方图层类似，选中图层后，点击Hide Views Behind按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.46019875047749235930797060896114:50001231000000:2800:BADB43300DD4D6CDCCF16DBD7BBC4E27BCB4BE563B34C83A9591489382F75C3E.png)，能够隐藏当前选中图层后方的所有图层。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.17646247406117477800872193625718:50001231000000:2800:93724D7555C3DAB8691FA18E77FAEFA89D87B44B65CCB02600AA03ABC157D9AD.png)

### 恢复隐藏图层

点击Restore Hidden Views按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.73236950192734766415948085378311:50001231000000:2800:83E60744DF881ADFF26A4FC2B35C9A71553CA23325D411C16421A6B15498878B.png)，能够恢复所有隐藏的前方图层和后方图层。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.51968194687592262028895738530220:50001231000000:2800:9F5BAE27A3D10BFF4B86928941158A08C3CBD5BD4E4FBAFC8645F5412FFD3C89.png)

### 切换图层排列顺序

图层有两种排列顺序，id顺序和层级顺序。

- id顺序：默认顺序，即渲染的顺序，也是组件真实显示的顺序，图层的遮挡关系和实际应用一致，每个图层显示在一个Z轴平面上，但如果图层数量较多，会导致Z轴过长，操作不方便。
- 层级顺序：组件树上同一层级的组件，在3D视图中会显示在相同Z轴平面上，能够有效减少3D视图下Z轴长度。

切换方式：点击Switch to Layer Order/Switch to Id Order按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155830.64678523134245333055983116066459:50001231000000:2800:5352AB2B3C829AD9DC5DCA53E72EB6CDE52591C28B6FFF376CFC25EEE88375BC.png)，可以将图层的排列顺序分别切换至层级顺序/id顺序。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.82800083975871347927970045041213:50001231000000:2800:1CD092DFE60F09835F150C36205074D58E2F575143AD5B64BA79E2702395BEF9.png)

### 调节图层间距

鼠标悬浮在Adjust the Gap of Layers按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.77252564750072695446039817017197:50001231000000:2800:F95BB3B2CDD69B763D16AB2D52EAA39E08D90376D74358D4B138A3430A19B81C.png)上，出现一个拖动条，拖动后可调节图层间的距离，范围是0~100px。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.09464623838555334856468060367800:50001231000000:2800:C527259804EF3D24578FEA6F30D4333E1407D45C248455C1D4B7841DBD088518.png)

### 显示/隐藏图层边框

DevEco Studio默认给图层加了边框，此边框并非应用自身边框，便于查看透明图层。点击Hide Border按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.47987214280712197711737884154667:50001231000000:2800:47A6A4DB715C6DEE5711A43A283DAC72136C5BF45F57BAB88ACC57BEFAE6BCC3.png)或Show Border![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.86058655357632609932787233058394:50001231000000:2800:F06DD58FB06A94ADA6137BFAE765420F727A9F9135C5F25F46A04AC37816BA5A.png)可以隐藏或显示图层边框。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.71739302542685858203767073050266:50001231000000:2800:797647F1784D017E233D7B1E3B17248C040F081A78831ACC258E41FC89993459.png)

### 放大/缩小视图

点击Zoom In按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.08557728548176811392483973132441:50001231000000:2800:006B4ED17CCAFBD5FBFB29015C3B89AE4B9A96785DF96CF569E31C40E3B60E5A.png)或Zoom Out按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.79271294979066463888945739824237:50001231000000:2800:A5A0625B40D924C9C70144CF38D4A45EE85A25B0558AFC74CB9007B681AFCB70.png)，能够放大或缩小3D视图。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.54861666078112808050250437963493:50001231000000:2800:565E3714AD32C9FB29CA939C2459DEB96608F14E4728EB8C32E10F0FA7180A17.png)

### 自适应窗口

点击Zoom to Fit Screen按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.59595580544174390953903326281848:50001231000000:2800:A32F3BA644D5C7C3F049EB74E38DB1436A57B926AD8B498984ADB5617BAF76A4.png)，能够自动根据窗口大小，调整3D图层的缩放比例，并使3D视图回到区域中间。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.04653182054382704429676575173816:50001231000000:2800:EFBF391538CF0BC0AB9FC4615B4B761A328EFC3D1ECFE841A6ACC04522B493FE.png)

### 切换正面/侧面视图

DevEco Studio默认展示侧面视图，经过复杂的旋转后，可点击Switch to Front View按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.31033324702146878055361982778169:50001231000000:2800:52165BAAB53097820749D50785B31AAE40986378698293298E3FBE64531CB958.png)或Switch to Side View按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.80327099468782564634776233340676:50001231000000:2800:6DE73AF0CBEEBFC92711D0288BAA500574649B10AB4FBB5857A00207ED84151A.png)，将3D视图自动调整到预设的正面或侧面视角。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.55804211179576330747784643681565:50001231000000:2800:A695E0C0FD893DAFF1F460B713FDCE952CF7FF28F9037E579EFAD24D6B1E5400.png)

### 返回2D视图

点击2D View按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.65144736255002622923752853689131:50001231000000:2800:A20810E6721419B1D92FF069C6817998075FC5008239D54D7CF464AA0D2DEEB6.png)，可切换至2D视图。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155831.06447459200171309333280639311695:50001231000000:2800:190A7936B68AE25036166420831FB2FA81AEEB56078572BB10F9AF88449D05E5.png)

[开发者选项](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-developer-mode "开发者选项")

[访问设备文件](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-device-file-explorer "访问设备文件")
# 访问设备文件

更新时间: 2025-12-16 15:58

开发者可以使用Device File Browser，在DevEco Studio上如PC端操作一样，对设备文件进行新建、删除、上传、下载等操作，而无需使用命令行，提升开发效率，当前支持普通文件视图与应用沙箱视图两种模式。

## 使用场景

- 查看设备上的文件列表及基本信息。
- 在设备上搜索文件及文件夹。
- 在设备上新建、删除文件。
- 从PC本地上传文件到设备上，从设备上下载文件到PC本地。

## 使用约束

- 已通过USB或Wi-Fi连接设备。
- 不支持访问无权限目录，新建、删除、上传、下载文件受设备权限约束。
- 不支持文件拖拽。
- 不支持文件修改。如需对文件进行修改，需下载至PC，在本地修改后再上传至设备。
- 不支持上传文件或文件夹的快捷方式。
- 应用沙箱视图不支持模拟器设备。
- 只支持访问调试态应用的沙箱数据目录。
- 应用需为debug应用才可使用沙箱视图查看文件结构、对应用沙箱内的文件/文件夹进行新建、删除、上传或下载操作。

## 操作步骤

1. 在菜单栏单击**View > Tool Windows > Device File Browser**，打开Device File Browser。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.37468789936711271266840662532911:50001231000000:2800:191C0F0715AC3ACF25F96CBC73221BADB3529D4E21EF89475A89F10478B12378.png)
    
2. 从下拉列表中选择设备（设备需已连接）。
3. 选择设备后，显示文件/文件夹列表，可进行以下操作：
    
    1. 右键单击目录或文件，进行新建/删除操作。
    2. 右键单击**Save As**将选定的文件或目录下载到PC上，右键单击**Upload**将PC上的文件上传到设备指定目录。
        
        如果需要查看数据库文件，可以通过该方式将数据库文件（路径举例：data > app > el2 > 100 > database >项目名称 > entry > rdb > 数据库文件）下载到PC上，再通过其他工具进行可视化查看。
        
        说明
        
        从DevEco Studio 6.0.0 Beta2版本开始，支持使用快捷键**Ctrl或Shift+鼠标左键**（macOS为**Command或Shift+鼠标左键**），选中多个文件或目录下载到本地计算机。
        
    3. 焦点在Device File Browser框中，输入字母可以快速进行搜索。
    4. 双击某个文件可在DevEco Studio中将其打开。打开文件会默认下载文件到临时目录（%USER%\AppData\Local\Huawei\DevecoStudio{版本号}\device-file-browser\{设备名称}\{设备上的文件路径}），关闭文件后，临时文件将被删除。
    5. 如果通过命令行方式上传文件到设备后，需要右键对应文件夹，选择**Synchronize**后才可以在Device File Browser窗口中显示该文件。
    

## 可访问目录

当前Device File Browser可访问的文件夹有四种类型：[应用沙箱目录](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-sandbox-directory)、一般暂存区目录、日志目录、设备公共目录。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.26961211319980086764663306388162:50001231000000:2800:5F0EBE1CAEFC7DC9455F71899B2F5854C8865A660012FF35D061904D3AB0FC82.png)

### 应用沙箱目录

此目录用于存放应用自身相关的数据、资源文件等，有两种访问方式。

- **普通文件视图**
    
    普通文件视图将按照设备的真实物理路径显示当前设备上的文件结构。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.41846552182656451553129873395358:50001231000000:2800:3EFBEEE6468B809D310DBCC2BF4335D1E8EA196E0D4946A42A2A1D9705B6AF9D.png)
    
    应用沙箱在设备上的物理路径位于/data/app/{el1，el2}/100/{base，database}/{packageName}路径下。
    
    在普通文件视图下，el1目录下的文件仅具备查看文件目录结构的权限，无法执行新建、删除、上传或下载操作；与el1相比，el2目录下的文件允许下载，但其他操作仍无权限执行。
    

- **应用沙箱视图**
    
    应用沙箱视图会展示所有debug类型的应用，按照应用的沙箱文件路径显示应用的沙箱文件结构。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.90319668424777810895257699683629:50001231000000:2800:498E513A343C08B3C9B703FFECD044A64D1131D009ACD9C501F553977330CC1C.png)
    
    API 15以下的版本，当需要以沙箱视图查看应用的文件结构时，需在module.json5文件内配置ohos.permission.INTERNET开启网络权限，卸载并重新安装应用。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.72273952937732553909061432796811:50001231000000:2800:0629CA2A7E709DDD7279AEA8E1AA22C2724333235EE13967A748794A280DF7EE.png)
    
    对应于物理路径，沙箱路径为/data/storage/{el1，el2}/{base，database}。
    
    在应用沙箱视图下，el1和el2目录下的文件均支持新建、删除、上传、下载操作。
    

### 一般暂存区目录

一般暂存区目录位于/data/local/tmp/路径下，支持新建、删除、上传、下载操作，在DevEco Studio进行调试、测试等操作时，将在此目录下生成相关的文件。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.93031746243840096334571468480605:50001231000000:2800:8EA00BF4ABB07645C635AE5C378A89534D3FD53222683CF22E051BA84EFFE289.png)

### 日志目录

应用运行时的日志通过HiLog工具实时输出，此工具的输出缓存区一般为256K，超出大小的历史日志将会以压缩包的形式保存在/data/log/hilog/路径下。

当需要查看历史日志时，需要将此目录下的压缩包文件和数据字典压缩包文件hilog_dict.XXX.zip下载到本地计算机，然后使用[hilogtool工具](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hilog-tool)解析出对应的日志原文件。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.34323350103314249542485317699595:50001231000000:2800:CFA225682090988863A599404B225BF2A667E0DB0F9D8B0103737A5F363F2B38.png)

### 公共目录

用户的桌面、文档、下载等公共目录位于/storage/media/100/local/files/Docs路径下，支持删除、上传、下载操作。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.50362142136366171456185839415482:50001231000000:2800:36E0185D4F57E33347BB93DE03848B0EB8B283053A42DB2C26A104CB99A92091.png)

## 特殊目录

设备上存在两个特殊的目录：faultlog目录和图库目录，这两个目录有下载权限，但没有查看权限，Device File Browser中无法显示这两个目录，但其下的文件可以通过hdc命令查看并导出。

### faultlog目录

当应用崩溃时，会在/data/log/faultlog/faultlogger路径下生成相关的崩溃日志，可通过以下方式查询并下载日志。

1. 执行命令，查询此路径下的崩溃日志文件列表。
    - 设备版本低于5.1.0.54时，执行以下命令。
        
        1. hdc shell hidumper -s 1201 -a "-p Faultlogger"
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.18594862907230795018897345355409:50001231000000:2800:16E0CEB37020F12F3E4814C75E2EF8B0CB243E50993177CEC65889704432B76F.png)
        
    - 设备版本为5.1.0.54及以上时，崩溃日志文件名时间戳新增了毫秒级信息，执行以下命令。
        
        1. hdc shell hidumper -s 1201 -a "-p Faultlogger %s -LogSuffixWithMs"
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.90309525147874068108460853632206:50001231000000:2800:FAF34F284FD2FA38C3AFA1B514E749FC54A12E60B76A83B9729B2A9390F55BAB.png)
        
2. 执行命令，查看指定的崩溃日志文件的内容。
    
    1. hdc shell hidumper -s 1201 -a "-p Faultlogger -f {filename}"
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.33341030590265677394043762535124:50001231000000:2800:6B4CCA4694E9B4FB94C7D3004B1E2FB7DFACB1B1D41FE28A68E45B4E02EF1BCA.png)
    
3. 执行命令，将文件保存到本地计算机指定的路径下。
    
    1. hdc file recv /data/log/faultlog/faultlogger/{filename} {path}
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.87622568180553227267784561519263:50001231000000:2800:15CD97812483AAE67FC41A61813169E376B3236F28E266EF68F4790F891B6614.png)
    

### 图库目录

图库目录中保存了录屏工具、照相机等系统应用生成的图片、视频文件，可通过以下方式将文件下载到本地计算机。

1. 在图库中查看文件名及后缀，例如a.mp4。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.73841135194020705690141213621920:50001231000000:2800:12B62534493B5152818C899425402B58C458090DCC05827DFC3DAD1190B340CF.png)
    
2. 查询文件路径，记录为{FilePath}。
    
    1. hdc shell mediatool query a.mp4 -u
    
    - 如果查询的结果中包含uri字段，则返回值第三行对应的文件路径不允许直接下载。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.72023128998606926973947084770506:50001231000000:2800:90736E9C667C6268F8917CEA0211B5699D46C9AB279549397C745BB9F9FB26BE.png)
        
        需要再执行如下命令，指定该uri，将文件复制到有下载权限的路径中（如/data/local/tmp）。
        
        1. hdc shell mediatool recv file://media/Photo/2/VID_1744944984_000/a.mp4 /data/local/tmp
        
        命令返回值第二行即为文件路径{FilePath}。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.74161621113061408550262502949199:50001231000000:2800:A18629DE9B1880E09EA01F323FE8148E705FACF46B9C4849DF618F0E710C768A.png)
        
    
    - 如果查询结果不包含uri字段，则返回值第二行即为文件路径{FilePath}。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.91160172548473361384121742118908:50001231000000:2800:F3A03B5F205D171FF087CC85E6303C951CCB70E9287A1FB4350ECDE72737F910.png)
        
3. 指定上一个步骤中获取到的文件路径{FilePath}，下载文件到本地。
    
    1. hdc file recv {FilePath} .\
    

## 命令行方式访问应用沙箱

可以通过命令行的方式访问debug应用的[沙箱目录](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-sandbox-directory#%E5%BA%94%E7%94%A8%E6%B2%99%E7%AE%B1%E8%B7%AF%E5%BE%84%E5%92%8C%E7%9C%9F%E5%AE%9E%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E7%9A%84%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB)。

- 从API 15开始，支持通过hdc工具访问debug应用的沙箱目录，推荐开发者使用此种方式。更多关于命令行工具hdc的说明请参见[hdc工具使用指导](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hdc)。
    1. 在设备侧启动应用。
        
        1. $ hdc shell aa start -a {abilityName} -b {bundleName}
        2. start ability successfully.
        
        - abilityName：应用的ability名称。
        - bundleName：调试应用包名。
        
    2. 通过命令访问沙箱文件目录，创建目录文件，删除指定目录下的文件。
        
        1. $ hdc shell -b {bundleName} ls -lZ -A "./data/storage/el2/base"          // 查看应用沙箱下/el2/base目录文件（返回文件全部信息）
        2. $ hdc shell -b {bundleName} ls -A "./data/storage/el2/base"          // 查看应用沙箱下/el2/base目录文件（仅返回文件名）
        3. $ hdc shell -b {bundleName} mkdir -p "./data/storage/el2/base/test"     // 在应用沙箱下/el2/base目录下创建test目录
        4. $ hdc shell -b {bundleName} rm -r "./data/storage/el2/base/test.txt"  // 在应用沙箱下/el2/base目录下删除test.txt文件
        5. $ hdc shell -b {bundleName} rm -r "./data/storage/el2/base/test"      // 在应用沙箱下/el2/base目录下删除test目录
        
    3. 通过命令往应用沙箱目录中发送文件，从沙箱目录中下载文件到本地计算机。
        
        1. $ hdc file send -b {bundleName} "D:\test.txt" "./data/storage/el2/base"    // 发送文件到设备沙箱目录/el2/base
        2. $ hdc file recv -b {bundleName} "./data/storage/el2/base/test.txt" D:\  // 从设备沙箱目录/el2/base下载文件到本地计算机
        
- API 15以下的版本，通过以下方式访问debug应用的沙箱目录。
    1. 在工程主模块下的module.json5文件下增加网络权限。
        
        1. "requestPermissions": [
        2.   {"name":  "ohos.permission.INTERNET"}
        3. ]
        
    2. 在设备侧(hdc shell)启动应用的bftpd服务，并查询端口号是否启动成功。
        
        1. $ aa process -b {bundleName} -a {abilityName} -p "/system/bin/bftpd -D -p {port}"  -S
        2. start native process successfully.
        3. $ ps -ef | grep bftpd
        4. 20020143     12254   613 0 11:52:53 ?     00:00:00 bftpd -D -p 9021   // 对应端口号的bftpd服务启动成功
        5. shell        13035 11901 10 11:54:44 ?    00:00:00 grep bftpd
        
        - bundleName：调试应用包名。
        - abilityName：应用的ability名称。
        - port：可用端口号。
    3. 通过命令访问沙箱文件目录，创建目录文件，删除指定目录下的文件。
        
        1. $ ftpget -p {port} -P guest -u anonymous localhost -l /data/storage/el2/base           // 查看应用沙箱下/el2/base目录文件（返回文件全部信息）
        2. $ ftpget -p {port} -P guest -u anonymous localhost -L /data/storage/el2/base           // 查看应用沙箱下/el2/base目录文件（仅返回文件名）
        3. $ ftpget -p {port} -P guest -u anonymous localhost -M /data/storage/el2/base/test      // 在应用沙箱下/el2/base目录下创建test目录
        4. $ ftpget -p {port} -P guest -u anonymous localhost -d /data/storage/el2/base/test.txt  // 在应用沙箱下/el2/base目录下删除test.txt文件
        5. $ ftpget -p {port} -P guest -u anonymous localhost -D /data/storage/el2/base/test      // 在应用沙箱下/el2/base目录下删除test目录（仅支持删除空目录）
        
    4. 通过命令往应用沙箱目录中发送文件，从沙箱目录中下载文件到本地。(/data/local/tmp/作为中转目录)
        
        1. $ hdc file send test.txt /data/local/tmp/test.txt    // 先发送文件到设备data/local/tmp目录
        2. $ ftpget -p {port} -P guest -u anonymous localhost -s /data/local/tmp/test.txt /data/storage/el2/base/test.txt  // 再推送到应用沙箱目录
        3. $ ftpget -p {port} -P guest -u anonymous localhost -g /data/local/tmp/test.txt /data/storage/el2/base/test.txt  // 先下载到设备的data/local/tmp目录
        4. $ hdc file recv /data/local/tmp/test.txt test.txt  // 再从设备中获取
        

## 常见问题

沙箱视图下，打开沙箱文件夹时报错：[Fail][E003001] Invalid bundle name。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155833.48969601204354098909966701228843:50001231000000:2800:8F1830C260347109ED66C8FD3B241A726FF77699B65EF90A220ECDB1CD829F0B.png)

可能是以下原因：

1. 应用不是debug应用，无法查看沙箱文件。
2. 应用安装后，未运行过或重启了设备，导致应用沙箱暂未挂载。此场景下先手动运行一遍应用，然后在报错目录右键点击**Synchronize**即可打开目录。

[布局分析](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-arkui-inspector "布局分析")

[截屏](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-screenshot "截屏")
# 截屏

更新时间: 2025-12-16 15:58

在调试过程中，可以通过多种方式截取屏幕截图。

## 通过DevEco Studio截屏

1. 连接真机设备或模拟器，并在其中运行应用。
2. 在DevEco Studio底部切换到**Log**页签。
3. 点击左侧工具栏中![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155834.69687091258888757602006664080869:50001231000000:2800:8EA4025534C7615949426F003347CD6AC06A990F834DE2F59B58ABAE982944F5.png)，即可截取屏幕截图。
    
    截图的图片将直接显示在DevEco Studio中。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155834.36031977987249469716460807356625:50001231000000:2800:9BA7BBDBDF53682886C5CAE07EDADD6637F71A94DE6539549C46ABE3B57710C6.png)
    
4. （可选）在图片显示区域右击，选择**Copy Path/Reference...**可以查看截屏的本地存储路径或者在菜单栏下方查看本地存储路径。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155834.65293189892695582611848589766336:50001231000000:2800:4FE82599ADC92FECDD91371F57AFFBF58D633A1FBAD8B4BA8108641D69C29D98.png)
    

## 通过命令行方式截屏

hdc是可以用于调试的命令行工具，通过该工具可以实现截屏功能。更多关于命令行工具hdc的说明请参见[hdc工具使用指导](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hdc)。

### 方式一：hdc shell snapshot_display

1. hdc shell snapshot_display -f /data/local/tmp/0.jpeg  // -f参数指定图片在设备上的存储路径，如不指定，会在命令执行完成后显示图片默认存储路径。
2. hdc file recv /data/local/tmp/0.jpeg  // 将图片从设备发送到本地目录，本示例将图片发送到当前执行hdc命令的目录。

### 方式二：hdc shell wukong special -p

wukong是系统稳定性测试工具，通过指定参数-p可以实现截图功能。更多关于稳定性测试工具wukong的说明请参见[wukong工具使用指导](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/wukong-guidelines)。

1. hdc shell wukong special -p

命令执行效果如下图所示，其中Report currentTestDir为结果存储路径，包含截屏图片。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155834.64257225131958985462695488785400:50001231000000:2800:78AADB5A8DE357262246ECF9FEED2FF094F9CEDF4CF352EE62C20CB351891E69.png)

通过hdc命令可以将该路径文件发送到本地，例如发送到当前执行hdc命令的目录。

1. hdc file recv /data/local/tmp/wukong/report/20231010_141610/  

[访问设备文件](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-device-file-explorer "访问设备文件")

[录屏](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-screen-recording "录屏")
# 录屏

更新时间: 2025-12-16 15:58

在应用开发过程中，可以使用录屏功能录制应用的运行状态，并通过录屏文件向他人展示正在开发的应用的各种功能效果。

## 使用约束

- 如果设置了锁屏密码，录屏开始前请解锁设备屏幕，锁屏状态下录屏应用无法正常拉起。
- 如果设置了锁屏密码，录屏时请保持设备的屏幕解锁状态，若录屏过程中锁屏将导致录屏应用退出。
- 模拟器不支持录屏。

## 通过DevEco Studio录屏

1. 连接真机设备，并在其中运行应用。
2. 在DevEco Studio底部切换到**Log**页签。
3. 点击左侧工具栏中![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155835.15253446610870876554806715481884:50001231000000:2800:8048A4007DBC1A3E28169A5D670B84B0737861FA660BD2281B1CA9D9286C8A5B.png)，即可开始录屏。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155835.17711686056523326397999210348786:50001231000000:2800:527BA21505E568267270A5BD7CBC8D4F810E017A7300E73F1CBDDF3E29E7B2B9.png)
    
4. 录屏时，需要先选择录屏文件的保存路径，开发者可使用默认路径或[设置自定义路径](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-screen-recording#section89111791511)。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155835.09604807195730824691057560936887:50001231000000:2800:F07279080C379FE4128B0875A5C055A70DB4803D19E52BA486EFD7A11601662C.png)
    
5. 路径选择完毕后，点击**Start Recording**开始录屏。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155835.80775885933235364114245501774257:50001231000000:2800:A4FC06DA42E383C9280F569A3A72F864CFE89F3B7CDCF5938FC1C2B429C47CDD.png "点击放大")
    
6. 录制完操作流程之后，点击**Stop Recording**结束录屏。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155835.51344795032240748251432231241370:50001231000000:2800:73249A647ADF30FBE413AFB1D634A6C363F56E48CED70D9A8F9255A4DD17877C.png "点击放大")
    
7. 结束录屏后，录屏文件将会保存到之前选择的路径下，可以选择调用系统播放器播放视频文件或打开文件所在的文件夹。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155835.37518633995147849072729815049174:50001231000000:2800:1C9EB706B85FA0B10135AF8185258429BAD602DE6B3E64725C35AC33DCFF66F4.png "点击放大")
    

## 设置录屏自定义路径

1. 点击DevEco Studio底部**Log**页签，选择**HiLog >** **Settings** **>** **Record Screen**选项。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155835.92439636750837393871639095299195:50001231000000:2800:B92BD67947760F40C7FBC0CDB6E11F6E0DEF67B397371EE947830BABBB1E36DB.png)
    
2. 在弹出的界面选择自定义路径，当设置好路径并勾选“Use the selected path and auto-generated file name as defaults and don't ask again”选项后，录屏时将自动使用此时设置的路径以及以录屏时的时间戳构造的文件名作为录屏文件的保存地址及文件名。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155835.98195830475719637831862236686982:50001231000000:2800:7E543BF6E98CAEC9C89130CE0A2E6E1178E21C6AD326BA13E85706344FF223DE.png)
    

## 通过命令行方式录屏

hdc是可以用于调试的命令行工具，通过该工具可以实现录屏功能。更多关于命令行工具hdc的说明请参见[hdc工具使用指导](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hdc)。

1. 启动录屏。
    
    1. hdc shell aa start -b com.huawei.hmos.screenrecorder -a com.huawei.hmos.screenrecorder.ServiceExtAbility --ps "CustomizedFileName" "test.mp4"   // 指定录屏文件名称为test.mp4
    
2. 停止录屏。
    
    1. hdc shell aa start -b com.huawei.hmos.screenrecorder -a com.huawei.hmos.screenrecorder.ServiceExtAbility
    
3. 获取录屏文件位置，记录为{RecordFile}。
    
    1. hdc shell mediatool query test.mp4 -u
    
    - 如果查询的结果中包含uri字段，则返回值第三行对应的录屏文件路径不允许直接下载。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155835.74363063822582280327363045751388:50001231000000:2800:7D65278DBEEE1FCF494FF7A567476538CB863CD5F9FBFA42E6926995AD86673C.png)
        
        需要再执行如下命令，指定该uri，将录屏文件复制到有下载权限的路径中（如/data/local/tmp）。
        
        1. hdc shell mediatool recv "file://media/Photo/2/VID_1736853237_001/test.mp4" /data/local/tmp
        
        命令返回值第二行即为录屏文件路径{RecordFile}。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155836.33381382693733121288770518977600:50001231000000:2800:50E796E96C057D357410E8B1B046DB1D4C84A3BF6E0856498F351D239F974BF4.png)
        
    
    - 如果查询结果不包含uri字段，则返回值第二行即为录屏文件路径{RecordFile}。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155836.38442679035250001959427274812250:50001231000000:2800:AF9883A3C28B5E8FC1DF9B21574AD35A754738750AE2F9F665D8A7C18013D5F6.png)
        
    
4. 指定上一个步骤中获取到的录屏文件路径{RecordFile}，下载录屏文件到本地。
    
    1. hdc file recv {RecordFile} d:\test.mp4
    

[截屏](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-screenshot "截屏")

[日志与故障分析](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-log-and-fault-analysis "日志与故障分析")
# Instrument Test

更新时间: 2025-12-16 15:58

## 创建ArkTS测试用例

### 创建默认测试用例

1. 在工程目录下打开待测试模块（支持HAP、HAR、HSP模块）下的ets文件，将光标置于代码中任意位置，单击**右键 > Show Context Actions** **> Create Instrument Test**或快捷键**Alt+Enter** **（macOS为Option+Enter）> Create Instrument Test**创建测试类。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155853.71037953566613924824651532565168:50001231000000:2800:92D73528F2FEB8475D16C7C73C4C80915DFE83AA507BD6FFEB38E53E2D28337B.png)
    
2. 在弹出的Create Instrument Test窗口，输入或选择如下参数。
    
    - **Testing library**：测试类型，默认为DECC-ArkTSUnit，JS语言默认为DECC-JSUnit。
    - **ArkTS name**：创建的测试文件名称，测试文件中包含了测试用例。测试文件名称要求在工程目录范围内具有唯一性，仅支持字母、数字、下划线（_）和点（.）。
    - **Destination package**：测试文件存放的位置，建议存放在待测试模块的test目录下。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.79355550982314216654081761343234:50001231000000:2800:CC0997DE1C5E5387BE62861BAD8B2CC716E59738EB90D745CB764ECCC21B7761.png)
    
3. DevEco Studio在ohosTest/ets/test目录下自动生成对应的测试类。在测试类中，DevEco Studio会生成对应方法的用例模板，具体测试代码需要开发者根据业务逻辑进行开发，具体请参考[自动化测试框架使用指导](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkxtest-guidelines)。
    
    说明
    
    - 您也可以手动在ohosTest > ets > test文件夹下创建测试用例，手动创建后，需要在List.test.ets文件中添加创建的用例类。手动创建的工程或历史工程，ohosTest > ets > test文件夹下所有文件的文件名必须以.test.ets结尾，否则将在运行时弹窗提示“Error: Test files must end with '.test.ets'.”请点击**Fix**按钮，DevEco Studio将自动对ohosTest > ets > test目录下的文件名进行修改。
    - 首次在HarmonyOS设备上运行UI测试框架需要使用命令“hdc -n shell param set persist.ace.testmode.enabled 1”使能UiTest测试能力。
    

### 自定义Ability和Resources

从5.0.3.403版本开始，新创建的工程/模块的ohosTest目录下默认不创建testability、testrunner和resources目录，历史工程仍保留这些目录，如果新工程需要使用ability或resources能力，需要开发者自行创建。

说明

如果需要使用ability能力，需要同时创建testrunner目录及OpenHarmonyTestRunner.ets文件。

|   |   |
|---|---|
**表1** **新旧版本ohosTest目录对比**
|**新版本**|**历史版本**|
|![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.37731037377480914087837759828959:50001231000000:2800:33379396A999F936C64534E85001AF3D86A4F54EE664FCF65388D8AA9E19F1C2.png)|![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.09411606899591125575752332039025:50001231000000:2800:E7B575164DCAF7C31872EA02EF78B92FF8F05A2A4800B24DC9DBF68C3D2A244B.png)|

1. 创建以下目录或文件，文件内容示例可在[运行Instrument Test测试用例](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-instrument-test#section1574003717165)后，在对应模块的build/{productName}/intermediates/src/ohosTest下查看，其中productName是当前生效的product，可以通过点击DevEco Studio右上方![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.50222300998424873493013414063312:50001231000000:2800:5895E0F7ECF6A8149687B15B480F079F37BE19A20968F3ED7FCA71949F287D3D.png)图标进行查看。
    
    - testability目录 > TestAbility.ets文件
    - testability目录 > pages目录 > Index.ets文件
    - testrunner目录 > OpenHarmonyTestRunner.ets文件
    - resources目录 > base目录 > element目录 > color.json文件
    - resources目录 > base目录 > element目录 > string.json文件
    - resources目录 > base目录 > profile目录 > test_pages.json文件
    
2. 在module.json5文件中补充ability配置字段mainElement、pages、abilities，关于字段的具体说明请参考[module.json5配置文件](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file)。
    
    1. {
    2.   "module": {
    3.     "name": "entry_test",
    4.     "type": "feature",
    5.     "description": "$string:module_test_desc",
    6.     "mainElement": "TestAbility",                                   // 对应下方abilities中的ability name。
    7.     "deviceTypes": [
    8.       "phone",
    9.       "tablet",
    10.       "2in1"
    11.     ],
    12.     "deliveryWithInstall": true,
    13.     "installationFree": false,
    14.     "pages": "$profile:test_pages",                                 // 对应resources目录 > base目录 > profile目录 > test_pages.json文件。
    15.     "abilities": [                                                  // 添加的ability的配置信息。
    16.       {
    17.         "name": "TestAbility",
    18.         "srcEntry": "./ets/testability/TestAbility.ets",
    19.         "description": "$string:TestAbility_desc",
    20.         "icon": "$media:icon",    // 确保引用的资源都存在
    21.         "label": "$string:TestAbility_label",
    22.         "exported": true,
    23.         "startWindowIcon": "$media:icon",
    24.         "startWindowBackground": "$color:start_window_background"
    25.       }
    26.     ]
    27.   }
    28. }
    

## 运行测试用例

### 运行模式

使用DevEco Studio运行测试用例前，需要将设备与电脑进行连接，将工程编译成带签名信息的HAP，再安装到真机设备或模拟器上运行，具体请参考[使用本地真机运行应用](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-run-device)或[使用模拟器运行应用](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-run-emulator)。

可以采用运行工程目录（test）、测试文件（如Ability.test.ets）、测试套件（describe）、测试方法（it）的方式来运行测试用例：

- 在工程目录中，单击**右键 > Run'测试文件名称'**，执行测试。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.74435946629249987105593350149260:50001231000000:2800:8AC14CD9A33D72D1AF13735C039F139F05FE44C0F326F8C9411C4EE7B6942C6B.png)
    
- 打开测试文件，单击测试套件左侧按钮。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.27137107803582813149957145933769:50001231000000:2800:1B46FF41EEFE66F21BA1B9F43B64EED148CEE08CDFE7F450EA4C59B7BC8014B3.png)
    
- 如果要根据自定义的配置执行Instrument Test，在[创建测试用例运行任务](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-instrument-test#section65264166107)后，通过如下方式的其中之一，执行Instrument Test：
    - 在工具栏主菜单单击**Run > Run'测试名称'**。
    - 在DevEco Studio的右上角，选择测试任务，然后单击右侧的![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.36699669634744520636849437722976:50001231000000:2800:2FDE2C202E4167B8E9C2BAA22AAD057684982892CDD795FCED0444C5EE2434DC.png)按钮，执行Instrument Test。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.69123812649949994363843381872720:50001231000000:2800:4A2D7BB9C3EC8DCD3047E62BCE654E00A500B7F73DD6DE69DE8C4A35875C3416.png)
        

执行完测试任务后，查看测试结果。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.61987461213369039107593074997023:50001231000000:2800:0CEC204B51E11A9438D046A364CECA9796D4253D58223B82D7D5BC2404D0F717.png)

### 调试模式

调试模式相比运行模式增加了断点管理功能。在断点命中时，可以选择单步执行、步入步出、进入下个断点等方式进行调试，另外可以使用线程堆栈可视化、变量和表达式可视化功能，快速定位问题。

以文件级别为例，在添加断点之后，在工程目录中，选中文件，单击**右键 > Debug'测试文件名称'**，以调试模式执行测试任务。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.02265148799978505644305642503120:50001231000000:2800:1A4791965958231500E14DF229031479F0F0A7EC911C9F41A9D6DB47A20C9AED.png)

在断点命中时，下方将出现Debug窗口。开发者可在该窗口中进行断点管理与基础调试能力的可视化操作，在断点命中时可查看当前线程的变量和堆栈信息。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.44520157691078799807444229167053:50001231000000:2800:DCA765F1B301A2609A03A017284CD27CCF35B6AA89046218CA8DB5A85ADA342F.png)

断点命中时，在代码编辑器窗口单击右键，在弹出的菜单中将出现调试模式特有功能，如计算表达式、添加变量监视等。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.21345988622752254797824667884187:50001231000000:2800:890D521D50B26DB6B220C787648D4CD4C96EC683C0789F7F8EF3C61B7055E489.png)

在跳出所有断点后，测试结束，与运行模式相同，在测试窗口查看测试结果。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.72929347528607275394908566600387:50001231000000:2800:225648A208F6017BB0C3A01F009D0BB5275BC6385DF0F50168DE0946396F29CF.png)

说明

DevEco Studio支持设置调试代码类型，具体请参考[设置调试代码类型](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-instrument-test#section0164586312)。

### 覆盖率统计模式

在Instrument Test运行的基础上支持代码覆盖率统计。

开发者可以自定义需要参与覆盖率测试的文件，具体配置方法请参考[配置覆盖率过滤文件](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ui-test#section13756446154)。

可以采用运行工程目录（test）、测试文件（如Ability.test.ets）、测试套件（describe）、测试方法（it）的方式来启动代码覆盖率的统计。

以文件级别为例，有两种方式启动测试：

- 方式一：在工程目录中，选中文件，单击**右键 > Run '测试文件名称' with Coverage**，执行测试。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155854.63203634416311491838481071786597:50001231000000:2800:35B77B9C0B104AB626744368247BD560D2618648B6A3A58C06660794D8B1C762.png)
    
- 方式二：在DevEco Studio的右上角，选择测试任务，然后单击右侧的![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.40678143179064075670963362480856:50001231000000:2800:4BA0257EB4309E91320D5045692832089FB2DF99E2F21BCC90B1E5329CC86762.png)按钮，执行测试。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.28147573260846255359359131177096:50001231000000:2800:6C9039B63F2CFFC3531611A9F11AE204356D87A925ABB241CF60227444D85B82.png)
    

启动测试后，进行编译构建，底部将出现Cover窗口，构建结束后自动拉起Cover窗口，测试任务结束后，窗口中会打印测试报告的路径。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.12500086041998578775335662388582:50001231000000:2800:BE774BBEDB32210EAC0816992EA5B40FA52159CB208DB849D9F0625A3A18F7B7.png)

点击链接可打开报告，查看ArkTS代码覆盖率详情，关于覆盖率的计算方式请参考[查看覆盖率报告](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ui-test#section10394362109)。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.13902018564317977193246179767586:50001231000000:2800:59AD271C768C7C673DD29EB2D8D8BCCA423068172D69C9AA6822FC2D3D91718D.png)

在Cover窗口中，单击rerun按钮可以按照之前的设置，重新执行覆盖率用例。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.99238791221706008215512126508442:50001231000000:2800:28DF7FBD52FDF3FB2BD307109C2C16BA39D4EC139FB29E80B3A8DCE7A08CD4FE.png)

## （可选）自定义测试用例运行任务

默认情况下，测试用例可直接运行，如果需要自定义测试用例运行任务，可通过如下方法进行设置。

1. 在工具栏主菜单单击**Run** > **Edit Configurations**进入Run/Debug Configurations界面。
2. 在**Run/Debug Configurations**界面，单击+按钮，在弹出的下拉菜单中，单击Instrument Test。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.03010544534899686431307389488449:50001231000000:2800:7A278EF384012720C9DAB017262F1F852570112DC97BE44C02E29A63BF48F943.png)
    
3. 根据实际情况，配置Instrument Test的运行参数。然后单击**OK**，完成配置。
    
    - 如果模块依赖共享包，请提前设置HAP安装方式，勾选“**Keep Application Data**”，则表示采用覆盖安装方式，保留应用/元服务缓存数据。
    - 如果工程中HAP/HSP模块直接依赖其他HSP模块（如entry模块依赖HSP模块）或间接依赖其他模块（如entry模块依赖HAR模块，HAR又依赖HSP模块）时，在测试阶段需要同时安装模块包及其所有依赖模块的包到设备中。此时，可以勾选“**Auto Dependencies**”，测试时会自动将所有依赖的模块都安装到设备上。该选项默认勾选。
    - 如果不涉及UI测试，勾选“**Only OhosTest Package**”，则只会推送OhosTest测试包到设备上，不会推送HAP/HSP包，可以缩短推包时间。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.78628309645147300436810490792586:50001231000000:2800:0702E889D374C5ECAE7D1DB66AD4C1AA4100AE30DADA1596535112A173EC24D1.png)
    

### 使用过滤条件筛选待运行的测试用例

1. 在用例编写时，通过配置it的第二个入参，为每个用例添加过滤参数。此参数用于为测试用例添加标注，不添加则参数默认为0表示未被标注。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.53597462860372823326449750710483:50001231000000:2800:D9C260CDFB4E4146A1639AC1B10C40277E37C4097A745EF1AD67577A5A0DEF20.png)
    
2. 打开**Run/Debug Configurations**窗口，点击Test Args![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.56646904986636770152735652700519:50001231000000:2800:428A96ED4584E6B5CB9E86CED252815BFED27D91296C15A1B63CEED5CD474B72.png)，打开**Test Args**界面，添加命令行参数。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.70779207507416709421011279938325:50001231000000:2800:2A23DE4477A9CB619ECB73D2DF9F0D4B8ACA32F0DE1C2CA342544DE0096DE919.png)
    
    例如将测试参数配置为level=1, size=medium
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.44397280251374281532603658754310:50001231000000:2800:10DA7B0D37784851D400A168E36883D47460C1F86033635F28EDD4E190275DAA.png)
    
    **表2** 参数规则参考
    |Key|含义说明|Value取值范围|
    |:--|:--|:--|
    |level|用例级别|"0","1","2","3","4", 例如：-s level 1|
    |size|用例粒度|"small","medium","large", 例如：-s size small|
    |testType|用例测试类型|"function","performance","power","reliability","security","global","compatibility","user","standard","safety","resilience", 例如：-s testType function|
    
3. 完成以上配置后，在运行此项配置对应的测试任务时，只运行过滤后的测试用例。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.00627078419739861955785591604471:50001231000000:2800:4047281CB1425C37377F072377856FB819AF8AA2C6528E0DE511981806F05140.png)
    

### 设置调试代码类型

点击**Run > Edit Configurations**，打开**Run/Debug Configurations**窗口，选择Instrument Test，点击**Debugger**页签，设置Debug type。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.70044471029687074416358404992693:50001231000000:2800:5BA320D30C4C4BEE3837724454F8885F1F403BAFC56B1DC55A61BA82F98DC2F1.png)

调试类型Debug type默认为Detect Automatically，关于各调试类型的说明如下表所示：

|调试类型|调试代码|
|:--|:--|
|Detect Automatically|自动检测。根据工程模块及其依赖的模块涉及的编程语言，自动启动对应的调试器。<br><br>如果检测到是Native模块，出现两个调试窗口（PandaDebugger、Native）；如果不是Native模块，只出现PandaDebugger调试窗口。|
|ArkTS/JS|只调试ArkTS/JS，只出现PandaDebugger调试窗口。|
|Native|单独调试C++，只出现Native调试窗口。|
|Dual(ArkTS/JS + Native)|支持ArkTS/JS和C++混合调试，出现两个调试窗口（PandaDebugger、Native）。|

说明

调试C++代码时，当前模块及所有依赖的HSP模块的[Address Sanitizer配置](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-instrument-test#section8352185341915)要保持一致，若不一致，可能无法进入C++代码的断点处。

### ASan检测

Instrument Test针对C/C++方法提供ASan检测能力，关于ASan的介绍请参考[ASan检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-asan)，当前不支持JS语言。

1. 在运行/调试配置窗口，选择对应的Instrument Test，点击**Diagnostics**页签，勾选**Address Sanitizer**选项，勾选后，测试包和源码包均开启ASan能力。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.59396737197025542696582651954063:50001231000000:2800:483D2857620054490D4B5B2F622CBE433D541BE609C58FE339DE81B27496834A.png)
    
2. 如果有引用本地library，需在library模块的build-profile.json5文件中，配置arguments字段值为“-DOHOS_ENABLE_ASAN=ON”，表示以ASan模式编译so文件。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.79134633746325064831403942354394:50001231000000:2800:5265AF2B8CD3A2A37376001D49A32FB0F114315E11AB18ED40E705ACE487924C.png)
    
3. 运行测试用例。
4. 当程序出现内存错误时，弹出ASan log信息，点击信息中的链接即可跳转至引起内存错误的代码处。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155855.84976891896994158429759260359274:50001231000000:2800:5E7D2B3743F41ADF24C6E76259D4C1A7CB3A4FA47A11553B746E07304410EF89.png)
    

## 测试C++代码

从DevEco Studio 6.0.0 Beta5版本开始，支持对C++代码进行测试，包括运行/调试C++测试代码、对C++代码进行覆盖率统计。

由于C++的测试so无法直接在设备上运行，需要通过Node-API的方式拉起，即通过ArkTS/JS语言拉起C/C++测试用例。

### 运行C++测试代码

1. 创建cpp测试目录，鼠标右键单击ohosTest目录，选择**New > C/C++ File(Napi)**，在ohosTest下生成cpp测试目录，以entry模块为例，目录结构如下。
    
    - **src > ohosTest > cpp > types**：用于存放C++的API接口描述文件。
    - **src > ohosTest > cpp > types** **> libentry_test > index.d.ts**：描述C++ API接口行为，如接口名、入参、返回参数等。
    - **src > ohosTest > cpp > types** **> libentry_test > oh-package.json5**：配置.so三方包声明文件的入口及包名。
    - **src > ohosTest > cpp > CMakeLists.txt**：CMake配置文件，提供CMake构建脚本。
    - **src > ohosTest > cpp > napi_init.cpp：**定义C++ API接口的文件**。**
    
    说明
    
    DevEco Studio生成的cpp测试目录中不包含C++测试框架，需要开发者自行选择开源测试框架使用。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.79185100533044107230671008268550:50001231000000:2800:71F079F1500AD0BA2FC4454E26E76311513F14DD72519A2602264E13DBC0F532.png)
    
2. 通过ArkTS测试用例拉起C++测试，示例如下。
    
    1. // ArkTS测试文件Ability.test.ets
    2. import entryTest from 'libentry_test.so';
    3. export default function abilityTest() {
    4.   describe('ActsAbilityTest', () => {
    5.     ...
    6.     it('testNative', 0, () => {
    7.       hilog.info(0x0000, 'testTag', '%{public}s', 'testNative it begin');
    8.       let result = entryTest.runNativeTest();
    9.       hilog.info(0x0000, 'testTag', '%{public}s', result)
    10.       expect(result).assertContain("ended");
    11.     })
    12.   })
    13. }
    
3. 运行testNative测试用例，查看测试结果。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.22927012906835269546822760950642:50001231000000:2800:EB2217424DA654D99305A5FB5FE4349D81EA122AF58D9D0FB19E2C5780BF2D0F.png)
    

### 收集代码覆盖率

DevEco Studio默认不收集C++代码覆盖率，需要通过以下方式开启。

1. 在测试目录下的CMakeLists.txt中添加以下代码，开启覆盖率编译插桩能力。
    
    1. set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -fprofile-instr-generate -fcoverage-mapping")
    2. set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -fprofile-instr-generate -fcoverage-mapping")
    
2. 在napi_init.cpp文件的RunNativeTest方法中，调用__llvm_profile_write_file方法，将覆盖率数据保存到设备的/data/storage/el2/base路径下的c++_coverage.profraw文件中，该路径和文件名不可修改，示例代码如下。
    
    1. extern "C" {
    2.     void __llvm_profile_set_filename(char *);
    3.     int __llvm_profile_write_file(void);
    4. }
    
    5. static napi_value RunNativeTest(napi_env env, napi_callback_info info)
    6. {
    7.     char filename[256];
    8.     snprintf(filename, sizeof(filename), "/data/storage/el2/base/c++_coverage.profraw"); // 覆盖率报告文件路径和文件名，不可修改
    9.     __llvm_profile_set_filename(filename);
    10.     // 开启测试
    11.     ...
    12.     // 结束测试，保存数据
    13.      __llvm_profile_write_file();
    14.     ...
    15. }
    
3. 运行覆盖率测试，选中ArkTS测试文件，单击**右键 >** **Run '测试文件名称' with Coverage**，执行测试。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.13694241835484574500581829692996:50001231000000:2800:451925D4240D6DCEEAF846FBFDBF5CB07137E3650355904123A8E3881F940E56.png)
    
    启动测试后，进行编译构建，底部将出现Cover窗口，构建结束后自动拉起Cover窗口，测试任务结束后，窗口中会打印测试报告的路径。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.56083530655454155492760996806774:50001231000000:2800:2EC4E2C7845C3108711916953CA5E844DB85945E6A96CD92B9FFDF84B3ACDD5B.png)
    
    点击链接可打开报告，查看C++代码覆盖率详情。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155856.44858273803606940118462330082963:50001231000000:2800:1E246D44CBABD0B809097F8CF18DF04DB8F226F9E7619D88AD3273315100A1A9.png)
    

## 使用命令行执行测试Instrument Test

通过命令行方式执行Instrument Test，在工程根目录下执行命令：

1. hvigorw onDeviceTest -p module={moduleName} -p coverage={true|false} -p scope={suiteName}#{methodName} -p ohos-debug-asan={true|false}

- module：执行测试的模块，缺省默认是执行所有模块的用例。
- coverage：是否生成覆盖率报告，缺省默认是true。
    
    覆盖率测试报告路径：<module-path>/.test/default/outputs/ohosTest/reports/index.html
    
    如果开启了C++代码覆盖率测试，会生成C++代码的覆盖率报告，路径：<module-path>/.test/default/outputs/ohosTest/cpp_reports/index.html
    
- scope：格式为{suiteName}#{methodName}或{suiteName}，分别表示测试用例级别或测试套件级别的测试，缺省默认是执行当前模块的所有用例。
- ohos-debug-asan：是否启用ASan检测，缺省默认是false。从DevEco Studio 5.1.1 Beta1版本开始支持。
    
    ASan日志路径：<module-path>/.test/default/intermediates/ohosTest/coverage_data
    

说明

多个module和scope之间用逗号分隔。

测试结果文件：<module-path>/.test/default/intermediates/ohosTest/coverage_data/test_result.txt

[代码测试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-code-test "代码测试")

[Local Test](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-local-test "Local Test")
# Local Test

更新时间: 2025-12-16 15:58

说明

当前不支持测试C/C++方法及系统API。

## 创建Local Test测试用例

1. 在工程目录下打开待测试模块（支持HAP、HAR、HSP模块）下的ets文件，将光标置于代码中任意位置，单击**右键 > Show Context Actions** **> Create Local Test**或快捷键**Alt+Enter****（macOS为Option+Enter） > Create Local Test**创建测试类。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.62784353128866190625003259441862:50001231000000:2800:2DAE2CC8C13CABA345FAEA1E16AEFBA158893AD78DEF6696022B59A2F6ECCB1B.png)
    
2. 在弹出的Create Local Test窗口，输入或选择如下参数。
    
    - **Testing library**：测试类型，默认为DECC-ArkTSUnit。
    - **ArkTS name**：创建的测试文件名称，测试文件中包含了测试用例。测试文件名称要求在工程目录范围内具有唯一性，仅支持字母、数字、下划线（_）和点（.）。
    - **Destination package**：测试文件存放的位置，建议存放在待测试模块的test目录下。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.59812640588633498748145716046093:50001231000000:2800:AAED9EF0D0849D505D49422F4F323A373BE3FAA45ED9B4EBEB81720FC4F7D69C.png)
    
3. DevEco Studio在test目录下自动生成对应的测试类。在测试类中，DevEco Studio会生成对应方法的用例模板，具体测试代码需要开发者根据业务逻辑进行开发，具体请参考[单元测试框架](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/unittest-guidelines)。
    
    说明
    
    您也可以手动在test文件夹下创建测试用例，手动创建后，需要在List.test.ets文件中添加创建的用例类。
    

## 运行Local Test测试用例

### 运行模式

可以采用运行工程目录（test）、测试文件（如Index.test.ets）、测试套件（describe）、测试方法（it）的方式来执行Local Test，各级别测试执行入口如下。

|   |   |
|---|---|
|![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.55922596064694049544199605162133:50001231000000:2800:060159C070B376FE457AEB932695C20FEDF517001D2B031E32DB5B4DFFE19EB3.png)|![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.79018130742031979550132849669078:50001231000000:2800:DA94AC43D2808D8234BED5C293E0D74D4D57675F223E24192BCCA9F52BAE1C8E.png)|
|目录级|文件级|
|![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.34070336877819009715471454361949:50001231000000:2800:AA7FE37F7DF53053233A1858046405DB7B84AE16E4850E0C39C6A6A58FDCD21E.png)|![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.25617972684028414058463865781536:50001231000000:2800:A684255CC177A4B402FDC7AA2D4252428CDECF6E3B3E72D197263D6A8C65D3E9.png)|
|套件级|方法级|

以文件级别为例，在工程目录中，选中文件，单击**右键 > Run'测试文件名称'**，执行测试。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.25067201945429853802821462636333:50001231000000:2800:2A16B9687A5A939FD548B584640319BC3BD774F60CF521098AC79B2340367074.png)

也可以通过如下方式，执行Local Test：

- 在工具栏主菜单单击**Run > Run'测试名称'**。
- 在DevEco Studio的右上角，选择一项测试任务的配置，然后单击右侧的![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.61115715689717720198761487490237:50001231000000:2800:87E7335CA048501200DE6A79A9842966A6ADBB538B03DA53F258B123D6A4BA59.png)按钮，执行Local Test。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155857.91915553896881409827924057283527:50001231000000:2800:88C75087493CC1D4848A7644C80473F9F5D25DC880B817EF6236FF7A426B9976.png)
    

执行完测试任务后，查看测试结果。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.05997389337093943229210581629340:50001231000000:2800:B38FAB142B4ECEA25F02E7D79315F5C75BA394B413FDD1A8D15AC85E5DDD1832.png)

### 调试模式

调试模式相比运行模式增加了断点管理功能。在断点命中时，可以选择单步执行、步入步出、进入下个断点等方式进行调试，另外可以使用线程堆栈可视化、变量和表达式可视化功能，快速定位问题。

以文件级别为例，在添加断点之后，在工程目录中，选中文件，单击**右键 > Debug'测试文件名称'**，以调试模式执行测试任务。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.14751575915115948093931514476627:50001231000000:2800:FD2382757B3807CE7250DD275B62B4607EA74A51A1DCA59A7C183DBE5B8880B8.png)

在断点命中时，下方将出现Debug窗口。开发者可在该窗口中进行断点管理与基础调试能力的可视化操作，在断点命中时可查看当前线程的变量和堆栈信息。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.75032361237899778282391910154732:50001231000000:2800:BC84E94F69318A8F46F069A5F6A97131DC00EECCAD86540145782095825A42DD.png)

断点命中时，在代码编辑器窗口单击右键，在弹出的菜单中将出现调试模式特有功能，如计算表达式、添加变量监视等。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.47119569247939226276184078418128:50001231000000:2800:1714773FD069A59980C6C7A503290D94F13D6186E74941E330A69085A0B5A187.png)

在跳出所有断点后，测试结束，与运行模式相同，在测试窗口查看测试结果。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.10931234090784712205881407217347:50001231000000:2800:75274EE7A3C5E2775D0504B25E1D95CBCF87463E098FD4B01575723CC68EB33E.png)

### 覆盖率统计模式

在LocalTest运行的基础上支持代码覆盖率统计，当前仅支持ArkTS工程。

开发者可以自定义需要参与覆盖率测试的文件，具体配置方法请参考[配置覆盖率过滤文件](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ui-test#section13756446154)。

如前所述，覆盖率统计模式也有多级别入口，以文件级别为例，有两种方式启动测试：

- 方式一：在工程目录中，选中文件，单击**右键 > Run '测试文件名称' with Coverage**，以覆盖率统计模式执行测试任务。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.84595656685645085992375362054174:50001231000000:2800:41D64610198CD5AF6B18AD8BEE317D785ED4F96CC93AB4823AEB202BFEEA6187.png)
    

- 方式二：在DevEco Studio的右上角，选择测试任务，然后单击右侧的![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.00043420444010915815376930379731:50001231000000:2800:505FC3A6F5381E09CFAA3022A1CEFF33D66D8B61C9A5356EB5C9685F150E9C3B.png)按钮，执行测试。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.67610587198446885212880012980907:50001231000000:2800:9BC074BD8D630EEE0A249E5958B72192DD39AA9329D557341C209CFC4B4B295B.png)
    

启动测试后，进行编译构建，底部将出现Cover窗口，构建结束后自动拉起Cover窗口，测试任务结束后，窗口中会打印测试报告的路径。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.08183144723797050702209600375661:50001231000000:2800:12D970DFF16948CB51B3D04529D71AC46FA24FC14792E51B395D41B3B2FE1FC9.png)

点击链接可打开报告，查看代码覆盖率详情，关于覆盖率的计算方式请参考[查看覆盖率报告](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ui-test#section10394362109)。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.32044739269171432580483418390434:50001231000000:2800:D2AE539C8733FD87D00D79612A0611E396B5CD0170347346607EF2E16CCA87AA.png)

在Cover窗口中，单击rerun按钮可以按照之前的设置，重新执行覆盖率用例。

![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.31215179019082885045049657511360:50001231000000:2800:F8B2ED5664DA21642317ED4B28D5AD97A4724A5D3A6B228EF860200957052D37.png)

## （可选）自定义测试用例运行任务

默认情况下，测试用例可直接运行。如果需要自定义测试用例运行任务，可通过如下方法进行设置。

1. 在工具栏主菜单单击**Run**>**Edit Configurations**，进入Run/Debug Configurations界面。
2. 在**Run/Debug Configurations**界面，单击**+**按钮，在弹出的下拉菜单中，单击**Local Test**。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.54755863331996183655233911416710:50001231000000:2800:68768A8A5FFD7062730176B9F935764E5ACF874362EEF42070E92F0A18AD8C04.png)
    
3. 根据实际情况，配置Local Test的运行参数。 然后单击**OK**，完成配置。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155858.98887370859358576701354096604982:50001231000000:2800:48FD61B387D5292745618969DBCDB4A6EA3708467F8FB4271C370A0C634935FC.png)
    

## 使用命令行执行Local Test

通过命令行方式执行Local Test，在工程根目录下执行命令：

1. hvigorw test -p module={moduleName} -p coverage={true | false} -p scope={suiteName}#{methodName}

- module：执行测试的模块。缺省默认是执行所有模块的用例。
- coverage：是否生成覆盖率报告，缺省默认是true。
    
    覆盖率测试报告路径：<module-path>/.test/default/outputs/test/reports/index.html
    
- scope：格式为{suiteName}#{methodName}或{suiteName}，分别表示测试用例级别或测试套件级别的测试，缺省默认是执行当前模块的所有用例。

说明

- 多个module和scope之间用英文逗号分隔。
- 暂不支持在Linux上执行该命令。

测试结果文件：<module-path>/.test/default/intermediates/test/coverage_data/test_result.txt

[Instrument Test](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-instrument-test "Instrument Test")

[Mock能力](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-test-mock "Mock能力")
# Mock能力

更新时间: 2025-12-16 15:58

在实际开发中，一些接口或者对象依赖于外部资源或复杂的逻辑，这些依赖在测试环境中难以复现，导致这些接口或者对象难以测试，此时，可以使用Mock能力，对这些接口或对象进行模拟。当前Instrument Test和Local Test均支持对模块进行Mock，对于调用系统模块API或外部依赖模块，使用import mock，对于本地模块，使用hamock/hypium插件包的mock接口或者import mock。

说明

仅API 11及以上版本的Stage工程支持。

## 系统模块/依赖模块Mock

通过import mock对系统模块API或依赖模块的方法进行Mock，在mock-config.json5配置文件中定义目标模块和Mock实现代码文件的映射关系，运行时import目标模块都将指向Mock实现代码。以系统API bluetoothManager为例，具体实现如下。

1. 在src/mock目录下新建一个ArkTS文件，例如bluetooth_manager.mock.ets，在这个文件内定义目标模块的Mock实现。
    
    1. // src/mock/bluetooth_manager.mock.ets
    2. enum BluetoothState {
    3.   /** Indicates the local Bluetooth is off */
    4.   STATE_OFF = 0,
    5.   /** Indicates the local Bluetooth is turning on */
    6.   STATE_TURNING_ON = 1,
    7.   /** Indicates the local Bluetooth is on, and ready for use */
    8.   STATE_ON = 2,
    9.   /** Indicates the local Bluetooth is turning off */
    10.   STATE_TURNING_OFF = 3,
    11.   /** Indicates the local Bluetooth is turning LE mode on */
    12.   STATE_BLE_TURNING_ON = 4,
    13.   /** Indicates the local Bluetooth is in LE only mode */
    14.   STATE_BLE_ON = 5,
    15.   /** Indicates the local Bluetooth is turning off LE only mode */
    16.   STATE_BLE_TURNING_OFF = 6
    17. }
    18. interface BluetoothInfo {
    19.   state: number
    20. }
    21. const MockBluetoothManager: Record<string, Object> = {
    22.   'getBluetoothInfo': () => {
    23.     return { state : BluetoothState.STATE_BLE_TURNING_ON } as BluetoothInfo;
    24.   },
    25. };
    26. export default MockBluetoothManager;
    
2. 在Mock配置文件src/mock/mock-config.json5中定义目标模块与Mock实现的映射关系。
    
    1. "@ohos.enterprise.bluetoothManager": {  // 待替换的模块名
    2.   "source": "src/mock/bluetooth_manager.mock.ets"  // Mock代码的路径，相对于模块根目录
    3. }
    
3. 在测试文件中编写如下代码。
    
    1. // bluetoothManager.test.ets
    2. import { describe, it, expect } from '@ohos/hypium';
    3. import { bluetoothManager } from '@kit.MDMKit';
    
    4. export default function mock_system_api() {   
    5.   describe('mock_system_api', () => {
    6.     /* mock系统API */
    7.     it('mock_system_api', 0, () => {
    8.       let bluetoothInfo = bluetoothManager.getBluetoothInfo({
    9.         bundleName: "com.example.myapplication"
    10.       })
    11.       expect(bluetoothInfo.state).assertEqual(4)
    12.     });
    13.   });
    14. }
    
4. 如果测试文件是手动创建的，需要将用例类mock_system_api添加到List.test.ets文件中。
    
    1. import mock_system_api from './bluetoothManager.test';
    
    2. export default function testsuite() {
    3.   mock_system_api();
    4. }
    
5. 执行测试，用例通过。

## 本地模块Mock

有两种方式可以对本地模块进行Mock，一是使用hamock/hypium插件包的mock接口，二是使用import mock。

### 使用hamock/hypium插件包的mock接口

以下例子通过mock接口模拟本地模块的某个方法，关于Mock的更多说明可以参考[mock能力](https://gitee.com/openharmony/testfwk_arkxtest#mock%E8%83%BD%E5%8A%9B)。

1. 在src/main/ets目录下新建一个ArkTS文件，例如ClassForMock.ets，并在其中导出一个类。
    
    1. export class ClassForMock {
    2.   constructor() {
    3.   }
    4.   method_1(arg: string) {
    5.     return '888888';
    6.   }
    7.   method_2(arg: string) {
    8.     return '999999';
    9.   }
    10. }
    
2. 在测试文件中编写如下代码。
    
    1. // afterReturnTest.test.ets
    2. import { describe, expect, it, MockKit, when } from '@ohos/hypium';
    3. import { ClassForMock } from '../../../main/ets/ClassForMock';
    
    4. export default function afterReturnTest() {
    5.   describe('afterReturnTest', () => {
    6.     it('afterReturnTest', 0, () => {
    7.       console.info("it begin");
    8.       // 1.创建一个mock能力的对象MockKit
    9.       let mocker: MockKit = new MockKit();
    10.       // 2.定义类ClassForMock，里面两个函数，然后创建一个对象classForMock
    11.       let classForMock: ClassForMock = new ClassForMock();
    12.       // 3.进行mock操作,比如需要对ClassForMock类的method_1函数进行mock
    13.       let mockFunc: Function = mocker.mockFunc(classForMock, classForMock.method_1);
    14.       // 4.期望classForMock.method_1函数被mock后, 以'test'为入参时调用函数返回结果'1'
    15.       when(mockFunc)('test').afterReturn('1');
    16.       // 5.对mock后的函数进行断言，看是否符合预期
    17.       // 执行成功案例，参数为'test'
    18.       expect(classForMock.method_1('test')).assertEqual('1'); // 执行通过
    19.     })
    20.   })
    21. }
    
3. 如果测试文件是手动创建的，需要将用例类afterReturnTest添加到List.test.ets文件中。
    
    1. import afterReturnTest from './afterReturnTest.test';
    
    2. export default function testsuite() {
    3.   afterReturnTest();
    4. }
    
4. 执行测试，用例通过。

### 使用import mock

使用import mock对本地模块进行Mock，操作步骤和系统模块/依赖模块的Mock类似，在mock-config.json5配置文件中定义目标模块和Mock实现代码文件的映射关系，运行时import目标模块都将指向Mock实现代码。以下例子对本地模块entry/src/main/ets/common/calc.ets中的sum函数进行Mock。

1. 在src/mock目录下新建一个common目录并创建一个ArkTS文件，例如calc.mock.ets，在这个文件内定义目标模块的Mock实现。
    
    1. // src/mock/common/calc.mock.ets
    2. export function sum() {
    3.   return "this is mock sum";
    4. }
    
    calc.ets的原始实现如下：
    
    1. // src/main/ets/common/calc.ets
    2. export function sum() {
    3.   return 1;
    4. }
    
2. 在Mock配置文件src/mock/mock-config.json5中定义目标模块与Mock实现的映射关系。
    
    1. {
    2.   "common/calc.ets": { // 本地模块只支持ets/xxx的相对路径，并需明确文件后缀
    3.     "source": "src/mock/common/calc.mock.ets"  // Mock代码的路径，相对于模块根目录
    4.   },
    5. }
    
3. 在测试文件中编写如下代码。
    
    1. // test_mock_local_method.test.ets
    2. import { describe, it, expect } from '@ohos/hypium'
    3. import { sum } from '../../../main/ets/common/calc';
    
    4. export default function test_mock_local_method() {
    5.   describe('test_mock_local_method', () => {
    6.     it("test_mock_local_method", 0, () => {
    7.       expect(sum()).assertEqual("this is mock sum")
    8.     })
    9.   })
    10. }
    
4. 如果测试文件是手动创建的，需要将用例类test_mock_local_method添加到List.test.ets文件中。
    
    1. import test_mock_local_method from './test_mock_local_method.test';
    
    2. export default function testsuite() {
    3.   test_mock_local_method();
    4. }
    
5. 执行测试，用例通过。

[Local Test](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-local-test "Local Test")

[黑盒覆盖率测试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ui-test "黑盒覆盖率测试")
# 应用与元服务体检

更新时间: 2025-12-16 15:58

## 功能介绍

DevEco Studio提供了应用与元服务体检工具AppAnalyzer，用于对应用和元服务进行本地测试体检，并给出体检报告、分析指导以及修改建议，帮助开发者提升应用与元服务质量。在体检过程中，工具会收集应用或元服务的trace信息、代码栈、内存快照以及应用或元服务页面的截屏，并保存在本地工程目录.appanalyzer下，帮助开发者快速进行问题分析定位。

开发者可以通过DevEco Studio连接本地设备，自主遍历HarmonyOS应用或元服务的功能，快速进行自测试，查看测试结果及评分。当前支持以下几种体检模式。

- **规则体检**：支持兼容性、性能、功耗等多种测试类型，开发者可自主选择不同的规则进行测试，具体请参考[规则体检](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#section16341371309)。
- **场景化体检**：开发者无需了解具体的规则，可以基于实际的应用场景、对特定的页面进行测试，测试结果可以更清晰地指导开发者对某个页面某个场景的某个指标进行优化，具体请参考[场景化体检](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#section115121358308)。
- **上架前体检**：针对上架阻塞问题进行快速检测，提前发现可能影响上架的问题，检测完成之后可以选择上传检测结果，用于应用市场上架参考，提升上架效率，具体请参考[上架前体检](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#section39507231624)。该功能从DevEco Studio 6.0.0 Beta1版本开始支持。

以上体检模式都是在AppAnalyzer中进行测试并生成体检报告，从DevEco Studio 6.0.0 Beta3版本开始，支持在[DevEco Testing](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/deveco-testing)中测试生成检测报告后，导入到AppAnalyzer进行诊断和分析，获得可能的故障原因并生成体检报告，具体请参考[导入DevEco Testing的检测报告进行诊断](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#section19550112715455)。

从DevEco Studio 6.0.1 Beta1版本开始，针对高频的体检场景，AppAnalyzer提供预置的体检卡片，开发者可选择预置卡片快速进行体检，或者根据需要自定义卡片。

## 使用约束

当前仅phone类型的设备支持使用应用与元服务体检能力。

## 前置操作

1. 在进行规则体检、场景化体检或上架前体检之前，先要确保[DevEco Studio与真机设备已连接](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-run-device)，并根据[应用/元服务签名](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-signing)章节进行签名。
2. 如果使用DevEco Studio 6.0.0 Beta2之前的版本，需要先编译生成HAP或HSP。使用Beta2及以上的版本，无需提前编译。
3. 通过以下任意一种方式，打开AppAnalyzer。
    - 单击菜单栏**Tools >** **AppAnalyzer**，打开AppAnalyzer页面。
    - 在编辑窗口右侧的工具栏，点击**AppAnalyzer**或![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.88778240055221665504000576889120:50001231000000:2800:F62E5FAF35BE9A31963BF71FC37E7535179D76902610E7B3614257D4CE70EAEE.png)，打开AppAnalyzer页面。
4. 如果未配置Python环境，请根据界面提示，下载Python及三方库。或者点击AppAnalyzer底部**Python 配置**按钮进行配置。

## 规则体检

### 操作步骤（DevEco Studio 6.0.1 Beta1及以上版本）

1. 点击右上角![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.54456142603752420761515203073019:50001231000000:2800:027EBD196221C7F2866DC768770E75912B86036B1E25B22FDDF4F34DF341CEBD.png)图标选择Product、Target和构建模式，点击**Apply**后，在AppAnalyzer的首页中可查看对应的编译产物和构建模式。关于Product、Target、构建模式的介绍请参考[配置多目标产物](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-customized-multi-targets-and-products-guides)和[指定构建模式](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-compilation-options-customizing-guide#section192461528194916)。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.33097934532295072034152976516668:50001231000000:2800:8E48A83981BB895AEF73EB97398563CB5DF87EE8F07EFA7339C8883A2F894B6F.png)
    
2. 在**AppAnalyzer**页面，选择**规则体检**，选择预置的体检卡片，或根据需要自定义卡片。
    
    - 点击预置的体检卡片开始体检，如需查看卡片包含的体检规则，请点击卡片右上角的![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.55658808974148834620757221650638:50001231000000:2800:719F443575842DE1B213636C51A48E5F9F0D43DD47E7AAB39FA04CD1DD50C2E1.png)按钮，规则详情请参考[规则总览](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer-all-rules)。
    - 如果需要自定义体检规则，点击**+**，选择自动/手动测试和体检规则，部分规则可修改单次录制时长，请根据界面提示进行修改。
    
    说明
    
    以下体检规则不支持在编译模式为release下运行，请把编译模式切换到debug再重新检测：组件树节点数目过大、执行函数耗时过长、渲染界面耗时过长、ForEach中item数量过大。
    
3. 开始体检后，请等待AppAnalyzer完成构建、签名、安装等操作。
    - 如果是自动测试，根据界面提示，登录应用账号后点击继续按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.16230443902213754826657684710201:50001231000000:2800:73C08C0A0BD3769EF6864018F78B06DC0B7012787A9C3CE49B791975DF3013A1.png)，继续测试；或者无需登录账号，直接点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.23958198239215943116517753681200:50001231000000:2800:8A47378D65A6BD3A978464A48D9D07438C50225C07830463EDDC4EC15E4D2D31.png)按钮继续测试。
    - 如果是手动测试，根据界面提示，点击开始按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.87602858679335116308028472265502:50001231000000:2800:9C5336886BA2F31E6ADBA086C4E9F6DC1ADAE79077ADCD58965D241033ADF827.png)开始录制，并手动遍历应用/元服务的功能。如果在录制时间范围内未遍历完成，可继续点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.37103791082329451863503186628148:50001231000000:2800:0092F581DDE0649E4C8DE0B0619C85F8488B546B0B1A564EB71C27FE5C15B863.png)按钮，进行多次遍历，遍历完成后点击结束按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.84932922963712893723857421306755:50001231000000:2800:A6C07385FC9FE3CCCE80E8373548263590F2CE34B914012504E45AF42350CF63.png)。
4. 查看测试报告，包含以下内容。
    
    - **源文件、调优文件（包含trace文件和调用栈文件）或snapshot文件、时间戳等**：点击源文件可跳转到问题源码，点击调优文件或snapshot文件支持直接拉起性能分析工具Profiler并导入性能检测的问题数据进行调优分析，点击时间戳可以打开Profiler并定位到问题发生的时间范围。
    - **分析文档**：点击链接可跳转至官网文档，参考文档对检测出来的问题进行分析。
    - **优化建议**：针对检测出来的问题，给出对应的最佳实践，点击链接可跳转至官网文档。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.16660621543940693917634084426521:50001231000000:2800:E5BC7EED75D0BEA95A3DD637B5888EC6CD96D097280007B9CEF244F15245974D.png)
    

### 操作步骤（DevEco Studio 6.0.1 Beta1以下版本）

1. 如果使用DevEco Studio 6.0.0 Beta2及以上的版本，支持在体检过程中自动编译构建打包。点击右上角![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155822.34048015175478917421617230556374:50001231000000:2800:6AE9DF58037BA7037D98D4D91614DD1F47864938CA2E61801A2EC076D0AAB89D.png)图标选择Product、Target和构建模式，关于Product、Target、构建模式的介绍请参考[配置多目标产物](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-customized-multi-targets-and-products-guides)和[指定构建模式](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-compilation-options-customizing-guide#section192461528194916)。
2. 在**AppAnalyzer**页面，选择**规则体检**，选择自动或手动方式，**模块**选择框选择HarmonyOS应用/元服务工程模块。
    
    - 自动方式：体检时无需手动遍历，AppAnalyzer会自动检测。
    - 手动方式：体检时需要根据提示手动遍历HarmonyOS应用/元服务的功能。
    
    说明
    
    - 如果使用DevEco Studio 6.0.0 Beta2之前的版本，只有已经完成签名编译打包的模块才能被选中。
    - 支持同时添加多个模块，要求所有模块的“bundleName”相同，且多个模块中只能包含一个entry。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.11266640035007940920836240108274:50001231000000:2800:58FD7E826518896B71FE183EE4EBADFC57AAF1CF3361AD309C776859CB20539A.png)
    
3. 选择待测试的规则，规则详情请参考[规则总览](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer-all-rules)，然后在**AppAnalyzer**页面底部单击**开始**按钮，开始测试。部分测试规则依赖Python，请根据AppAnalyzer的指引，下载Python及三方库。在测试过程中，请保持连接的设备为解锁亮屏状态。
    
    说明
    
    - 请勿在测试完成前点击结束，如果提前结束测试会导致测试结果不准确。
    - 支持Python3.9~3.12版本，推荐使用Python 3.11.7版本。
    - 部分规则体检会进行投屏，如果测试过程中同时使用其他投屏工具，如DevEco Testing，可能会对UX测试的投屏造成干扰。如果投屏中断或不同步，可点击左上角刷新按钮重新投屏。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.19395944813300396216671131994604:50001231000000:2800:85B2042A67CB88FFCA5EB7F8CC52BA9E9D1EFB79BA1E106EFF272A662F67AE58.png)
    
4. 如果是手动方式，在安装应用/元服务完成后，需要根据提示手动遍历HarmonyOS应用/元服务的功能。手动遍历完成后点击**结束**按钮停止测试任务，等待数据解析完成后，查看测试结果如下。
    
    - 测试报告：检测结果的汇总信息，点击**详情链接**可跳转到对应的详情报告
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.11327676233278567020238621822248:50001231000000:2800:F69496B72CC3249098CD719D569C5F096B3982451CD2152B36D13B6F213534CF.png)
        
    - 详情报告：只包含检测失败的规则，给出详细的测试结果、相关的定位文件和对应的优化建议。
        
        - **源文件、调优文件（包含trace文件和调用栈文件）或snapshot文件、时间戳等**：点击源文件可跳转到问题源码，点击调优文件或snapshot文件支持直接拉起性能分析工具Profiler并导入性能检测的问题数据进行调优分析，点击时间戳可以打开Profiler并定位到问题发生的时间范围。
        - **分析文档**：点击链接可跳转至官网文档，参考文档对检测出来的问题进行分析。
        - **优化建议**：点击链接可跳转至官网文档，参考文档对检测出来的问题进行优化。
        - **Code Linter**：在“最佳实践测试”项目中，可直接在拉起Code Linter的同时，传递有问题的代码文件名，自动执行代码检查。在“快速性能测试”和“性能测试”项目中，因无代码文件名等信息，部分检测规则不支持自动执行代码检查，仅支持拉起Code Linter。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.16596605028187798869534865587458:50001231000000:2800:FE6EAA4F536F776A7ACC61A3BC8E3CBB9D3C685615C7DC869A1162BC00537C7F.png)
        
    

### 评分方法和规则

AppAnalyzer会根据体检结果计算出最后评分，满分为100分。

- **DevEco Studio 6.0.1 Beta1及以上版本，评分规则如下，具体体检规则请参考****[规则总览](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer-all-rules)****。**
    
    规则基础得分：如果有成功的则基础分数为60分，否则基础分数为0
    
    规则系数得分：(成功次数 / 总次数) * 40 + (告警次数 / 总次数) * 0.6 * 40
    
    规则得分：规则基础得分 + 规则系数得分
    
    分类得分 = sum(分类下的规则得分) / 分类下的规则个数
    
    总分 = sum(分类得分) / 分类个数
    
    说明
    
    如果规则未执行，该规则得分是100分。
    
- **DevEco Studio 6.0.1 Beta1以下版本，评分规则如下：**
    
    评分 = sum(检测通过的体检项权重）/ sum(体检项权重）* 100
    
    各体检项检测规则及权重请参考[规则总览](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer-all-rules#section878882265416)。
    

## 场景化体检

### 操作步骤（DevEco Studio 6.0.1 Beta1及以上版本）

1. 点击右上角![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.90399051112025936166685315570596:50001231000000:2800:C19E50B65C5580E7D90247D15CF4E68D1B7C15C230CA8547AF0A3088B4FEBD8C.png)图标选择Product、Target和构建模式，点击**Apply**后，在AppAnalyzer的首页中可查看对应的编译产物和构建模式。关于Product、Target、构建模式的介绍请参考[配置多目标产物](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-customized-multi-targets-and-products-guides)和[指定构建模式](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-compilation-options-customizing-guide#section192461528194916)。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.54426660924058338972841840060398:50001231000000:2800:7C63676AADCC78825E7A05A41B0D315A589B2A8B0D67D0F3DE186452E5A7861B.png)
    
2. 在**AppAnalyzer**页面，选择**场景化体检**，选择预置的体检卡片，或根据需要自定义卡片。
    - 点击预置的体检卡片开始体检，如需查看卡片包含的体检场景，请点击卡片右上角的![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.67577133528490186154593249688449:50001231000000:2800:1B137E91FB729753481B2D8E0C59D482FFA2FE64F97D9CFD51473D0C3964FD59.png)按钮，不同场景对应的检测指标请参考[评分方法和指标](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#section179917512311)。
    - 如果需要自定义体检场景，点击**+**，选择自动/手动测试和体检场景，部分场景可修改单次录制时长/测试总时长，请根据界面提示进行修改。
3. 开始体检后，请等待AppAnalyzer完成构建、签名、安装等操作。
    - 如果是自动测试，根据界面提示，登录应用账号后点击继续按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.14654216739736421355197520468980:50001231000000:2800:49BD18D3FB9E709BA8100CFD6AABEA6DE45FD65D2FC1320CBE6FC9BF50BB1FDE.png)，继续测试；或者无需登录账号，直接点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.70252305706302326305471543594694:50001231000000:2800:171ABDE94B019068C5B0B4346F86208E0B9175D668D2C059C4D03FDCF2D25FAE.png)按钮继续测试。
    - 如果是手动测试，根据界面提示，点击开始按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.48059379055100845517803358308505:50001231000000:2800:7E6BD2548971624EF24C7C77D626E543848344ED61A8CA1DA52455DEB3E6BEC9.png)开始录制，并手动遍历应用/元服务的功能。如果在录制时间范围内未遍历完成，可继续点击![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.89540321403378584307257056096281:50001231000000:2800:868052EDF58F3B77998E81CCBE99749D05BE3948861A89ACDA6080ED443648C1.png)按钮，进行多次遍历，遍历完成后点击结束按钮![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.45369736083345534930727152620624:50001231000000:2800:FE409836D7A2FBB3DFA1012C4C79B7524D8275E5BB0F715961D5EE6F1ADBABC6.png)。
4. 查看测试报告，包含以下内容。
    
    - **源文件、调优文件（包含trace文件和调用栈文件）或snapshot文件、时间戳等**：点击源文件可跳转到问题源码，点击调优文件或snapshot文件支持直接拉起性能分析工具Profiler并导入性能检测的问题数据进行调优分析，点击时间戳可以打开Profiler并定位到问题发生的时间范围。
    - **分析文档**：点击链接可跳转至官网文档，参考文档对检测出来的问题进行分析。
    - **优化建议**：点针对可能的故障原因，给出对应的最佳实践，点击链接可跳转至官网文档。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.29358052328371913033924859339966:50001231000000:2800:93DC5803D621EEB779034BA4E0B155BD5BAEF5D1C63D0F83421DA49E55226559.png)
    

### 操作步骤（DevEco Studio 6.0.1 Beta1以下版本）

1. 如果使用DevEco Studio 6.0.0 Beta2及以上的版本，支持在体检过程中自动编译构建打包。点击右上角![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155823.36666358957766341014601105511939:50001231000000:2800:464ACDC6BEC4B15E3E93B6E1D9DB17C5548DD1FF2B03FD029D666214AE3519AB.png)图标选择Product、Target和构建模式，关于Product、Target、构建模式的介绍请参考[配置多目标产物](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-customized-multi-targets-and-products-guides)和[指定构建模式](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-compilation-options-customizing-guide#section192461528194916)。
2. 在**AppAnalyzer**页面，选择**场景化体检**，选择**自动**或**手动**方式，**模块**选择框选择HarmonyOS应用/元服务工程模块。
    
    - 自动方式：体检时无需手动遍历，AppAnalyzer会自动检测。自动方式下还需要选择具体的运行时长。
    - 手动方式：体检时需要根据提示手动遍历HarmonyOS应用/元服务的功能。
    
    说明
    
    - 如果使用DevEco Studio 6.0.0 Beta2之前的版本，只有已经完成签名编译打包的模块才能被选中。
    - 支持同时添加多个模块，要求所有模块的“bundleName”相同，且多个模块中只能包含一个entry。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.99129164432109913297870581219627:50001231000000:2800:DFC15C05D8055FFE0520E5B8CA050D68D5A5E44E830AFC32322448342E42D502.png)
    
3. 勾选体检场景，不同场景对应的检测指标请参考[评分方法和指标](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#section179917512311)，然后在**AppAnalyzer**页面底部单击**开始**按钮，开始测试。首次测试时，请根据AppAnalyzer的指引，下载Python及三方库，或者登录开发者账号并自动签名音频辅助检测APP。在测试过程中，请保持连接的设备为解锁亮屏状态。
    
    说明
    
    - 请勿在测试完成前点击结束，如果提前结束测试会导致测试结果不准确。
    - 支持Python3.9~3.12版本，推荐使用Python 3.11.7版本。
    
4. 如果是手动方式，在安装应用/元服务完成后，需要根据提示手动遍历HarmonyOS应用/元服务的功能。手动遍历完成后点击**结束**按钮停止测试任务，等待数据解析完成后，查看测试结果如下。
    
    - 测试报告：检测结果的汇总信息，默认展示告警和失败的检测结果，检测标准请参考[评分方法和指标](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#section179917512311)，点击**详情链接**可跳转到对应场景的详情报告。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.55010987355780821516144429389617:50001231000000:2800:C8D622F5432380A5A3C10686F730E0EF7CEDBD5D0245727CF2E0E6D19BDAF2DA.png)
        
    - 详情报告：给出详细的测试结果、相关的定位文件和对应的优化建议。
        
        - **开始/结束页面、时间戳、调优文件（包含trace文件和调用栈文件）或snapshot文件等**：点击开始/结束页面可跳转到问题源码，点击时间戳可以打开性能分析工具Profiler并定位到问题发生的时间范围，点击调优文件或snapshot文件支持直接拉起Profiler并导入性能检测的问题数据进行调优分析。
        - **分析文档**：点击链接可跳转至官网文档，参考文档对检测出来的问题进行分析。
        - **优化建议**：针对可能的故障原因，给出对应的最佳实践，点击链接可跳转至官网文档。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.12074174138344501734759219246230:50001231000000:2800:604F71E5AC21B642FA77CA0ADC2FF70E98080B40586524A195B6562D842B47D7.png)
        

### 评分方法和指标

AppAnalyzer会根据体检结果计算出总分，满分为100分，具体指标请参考[表2](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#table16267340145013)。

- **DevEco Studio 6.0.1 Beta1及以上版本，评分规则如下：**
    
    指标基础得分：如果有成功的则基础分数为60分，否则基础分数为0
    
    指标系数得分：(成功次数 / 总次数) * 40 + (告警次数 / 总次数) * 0.6 * 40
    
    指标得分：指标基础得分 + 指标系数得分
    
    分类得分 = sum(分类下的指标得分) / 分类下的指标个数
    
    总分 = sum(分类得分) / 分类个数
    

- **DevEco Studio 6.0.0 Beta3/Beta5/Release版本，评分规则如下**：
    
    指标基础得分：如果有成功则基础得分为60分，否则基础得分为0
    
    指标系数得分：(成功次数 / 总次数) * 40 + (告警次数 / 总次数）* 0.6 * 40
    
    指标得分：指标基础得分 + 指标系数得分
    
    总分 = sum(指标得分) / 指标个数
    
- **DevEco Studio 6.0.0 Beta3以下版本，评分规则如下：**
    
    根据检测结果，某个场景的某个指标的评分规则：
    
    - 成功：得1分，达到人因体验最佳标准，详情请参考[应用体验建议](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/experience-suggestions-overview)。
    - 告警：得0.6分，体验未达到人因最佳，建议继续优化。
    - 失败：得0分，体验非常差，请继续优化，否则可能影响上架。
    
    总分是多个场景多个指标多个页面的平均值，示例如下：
    
    **表1** 评分方法示例
    |场景|子场景|指标/检测项|页面|测试次数|达标情况|得分|总分|
    |:--|:--|:--|:--|:--|:--|:--|:--|
    |页面间转场|router或者navigation页面跳转|响应时延|A->B|第一次|成功|1|(1+0.6+0.6+0+0.6+1+0+0.6)/8*100=55|
    |第二次|告警|0.6|
    |B->C|第一次|告警|0.6|
    |第二次|失败|0|
    |完成时延|A->B|第一次|告警|0.6|
    |第二次|成功|1|
    |B->C|第一次|失败|0|
    |第二次|告警|0.6|
    

各体检场景对应的检测指标如下表所示：

**表2** 场景化体检指标
|体检类别|场景|子场景|检测指标/检测项|应用或元服务场景|自动或手动方式|
|:--|:--|:--|:--|:--|:--|
|性能|页面间转场|router或者navigation页面跳转|[点击响应时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section118706211961)|应用，元服务|自动，手动|
|[点击完成时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section2406192820717)|
|[转场卡顿率](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-frame-rate#section1591383182619)|
|页面滑动|页面滑动（仅支持List、Grid、WaterFlow这三个组件实现的页面滑动）|[滑动响应时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section1767913186810)|应用，元服务|自动，手动|
|[滑动卡顿率](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-frame-rate#section159268494256)|
|冷启动|冷启动|[完成时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section58771582411)|应用，元服务|自动，手动|
|页面内转场|swiper滑动转场|[滑动响应时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section1767913186810)|应用，元服务|自动，手动|
|[滑动卡顿率](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-frame-rate#section159268494256)|
|[起播时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section1140562816186)|
|tabs点击转场|[点击响应时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section118706211961)|
|[点击完成时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section2406192820717)|
|tabs滑动转场|[滑动响应时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section1767913186810)|
|[滑动卡顿率](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-frame-rate#section159268494256)|
|web场景<br><br>（从DevEco Studio 6.0.0 Beta2版本开始支持）|web页面跳转|[点击响应时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section118706211961)|应用，元服务|自动，手动|
|[点击完成时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section2406192820717)|
|web页面滑动|[滑动响应时延](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-delay#section1767913186810)|
|[滑动卡顿率](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/performance-frame-rate#section159268494256)|
|兼容性|音频播控服务<br><br>（从DevEco Studio 5.1.0 Release版本开始支持）|播控中心音频控制场景|[播控中心控制音频播放检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section12303131815311)|应用|手动|
|[播控中心控制音频暂停检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section12303131815311)|
|[播控中心控制歌曲切换上一首检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section12303131815311)|
|[播控中心控制歌曲切换下一首检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section12303131815311)|
|[播控中心控制歌曲播放进度条拖动检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section12303131815311)|
|[播控中心控制歌曲循环播放检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section12303131815311)|
|[播控中心控制歌曲收藏检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section12303131815311)|
|音频焦点切换<br><br>（从DevEco Studio 5.1.0 Release版本开始支持）|来电接听场景|[音频焦点变化事件响应检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section256142914530)|应用|手动|
|VoIP通话场景|
|闹钟场景|
|导航场景|
|语音助手播报场景|
|静音播放场景|
|非静音播放场景|
|普通录音场景|
|音频设备控制<br><br>（从DevEco Studio 5.1.0 Release版本开始支持）|耳机控制音频场景|[耳机控制音频播放检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section12303131815311)|应用|手动|
|[耳机控制音频暂停检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section12303131815311)|
|[耳机控制歌曲切换上一首检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section12303131815311)|
|[耳机控制歌曲切换下一首检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section12303131815311)|
|耳机断开场景|[耳机断开事件响应检测](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-specification#section256142914530)|

## 上架前体检

### DevEco Studio 6.0.1 Beta1及以上版本

1. 在**AppAnalyzer**页面，选择**上架前体检**，点击预置的体检卡片，在弹框中选择待上架的产物和调试签名。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.93800342672691919176574949750040:50001231000000:2800:3FBB062A87128FEC4DC1121C4230A107C6E2AA1F295ED3F92816CEF731AE36F0.png)
    
2. 该体检模式无法自定义测试方式和体检规则，默认勾选所有规则，这些规则是[规则体检](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer-all-rules)的子集。单击底部的**开始体检**按钮，等待AppAnalyzer完成构建、签名、安装等操作。
3. 安装完成后，根据提示登录账号，开始进行测试。在测试过程中，请保持连接的设备为解锁亮屏状态。
4. 测试完成后，查看测试报告如下。
    - 如果测试分数是100分，可点击右上角**报告同步AG**按钮，弹出弹框，确认后点击**OK**，上传本次的检测报告，用于应用市场上架参考。上传报告后，无法再次上传报告。
        
        说明
        
        如需上传报告，请在体检结束后上传，[历史报告](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#section52734271806)中无法上传报告。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.11963213939295672840468356155649:50001231000000:2800:3361F3F69613606D5EA9E3E885D36080148A62E03EA684B1F1C05169E426781D.png)
        
    - 如果测试分数不是100分，无法上传报告，可根据详情报告中的信息，对问题进行分析优化，详情报告的具体内容可参考[规则体检](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#li75699128469)。

### DevEco Studio 6.0.1 Beta1以下版本

1. 在**AppAnalyzer**页面，选择**上架前体检**，弹出上架前检测配置的弹框，选择待上架的产物和调试签名。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.99249917846937790522437472821115:50001231000000:2800:C42EE4188501CD981D30CFAF8EB5EDBEACD4247F085B5DF54E0464683DFCEA28.png)
    
2. 该体检模式无法自定义测试方式、模块和体检规则，默认勾选所有规则，这些规则是[规则体检](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer-all-rules)的子集。单击底部的**开始**按钮，等待AppAnalyzer完成构建、签名、安装等操作。
3. 安装完成后，根据提示登录账号，开始进行测试。在测试过程中，请保持连接的设备为解锁亮屏状态。
4. 测试完成后点击**结束**按钮停止测试任务，等待数据解析完成后，查看测试结果如下。
    - 如果测试分数是100分，可点击右上角**报告同步**按钮，弹出弹框，确认后点击**OK**，上传本次的检测报告，用于应用市场上架参考。上传报告后，无法再次上传报告。
        
        说明
        
        如需上传报告，请在体检结束后上传，[历史报告](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#section52734271806)中无法上传报告。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.16192937037509095130777814896971:50001231000000:2800:C12400B46612F7A738C67567FE277D29A2478ACEE509BCBE4D7FCF44AFEE564B.png)
        
    - 如果测试分数不是100分，无法上传报告，可根据详情报告中的信息，对问题进行分析优化，详情报告的具体内容可参考[规则体检](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#li131614342254)。

## 导入DevEco Testing的检测报告进行诊断

### 操作步骤（DevEco Studio 6.0.1 Beta1及以上版本）

1. 点击AppAnalyzer页面底部**体检历史**按钮，点击右上角的**导入报告**按钮，根据界面提示，确保即将导入的检测报告满足相关要求。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.93119314688362588447467881977245:50001231000000:2800:1D0CDB65F08259F711C2C45C832C294ECCE8BE42B010E84B2B9F1F3D25DC4CA9.png)
    
2. 从本地选择一个zip文件，该文件是在DevEco Testing中测试并生成的，具体操作方式请参考[性能基础质量测试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/specialized-testing#section12324184817324)或[场景化性能测试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/specialized-testing#section8642101711299)。点击**确认**后，请等待AppAnalyzer导入数据并对问题进行诊断分析。AppAnalyzer仅支持对DevEco Testing中的部分指标进行诊断，具体请参考[检测指标](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#section1274133632120)。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.34008651518144863182784011532143:50001231000000:2800:E96B407031CB446A51F63CDFED8AF690F3CA655E2420009779E2A90B3E91EA38.png)
    
3. 诊断完成后，查看测试报告如下。
    
    - **源文件、调优文件（包含trace文件和调用栈文件）或snapshot文件、时间戳等**：点击源文件可跳转到问题源码，点击调优文件或snapshot文件支持直接拉起性能分析工具Profiler并导入性能检测的问题数据进行调优分析，点击时间戳可以打开Profiler并定位到问题发生的时间范围。
    - **分析文档**：点击链接可跳转至官网文档，参考文档对检测出来的问题进行分析。
    - **优化建议**：点针对可能的故障原因，给出对应的最佳实践，点击链接可跳转至官网文档。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.19772264117396864669919164263170:50001231000000:2800:088310D175024C4D9E14D249A128C1A39384090E40818F67D1F910E5E9D92234.png)
    
    说明
    
    由于DevEco Testing和AppAnalyzer在检测能力、检测方法以及场景识别上存在差异，所以通过DevEco Testing检测并导入AppAnalyzer诊断和直接通过AppAnalyzer检测并诊断，检测和诊断结果会出现不一致的情况。
    

### 操作步骤（DevEco Studio 6.0.1 Beta1以下版本）

1. 点击菜单栏**Tools >** **AppAnalyzer**，打开AppAnalyzer页面，点击底部**历史记录**按钮，进入历史记录页面。
2. 点击右上角的**检测报告导入**按钮，首次测试时，请根据AppAnalyzer的指引，下载Python及三方库，并根据界面提示，确保即将导入的检测报告满足相关要求。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.07872161746684331611237890110276:50001231000000:2800:2F080041DE4525997F3E44BB2E2A0609F4050CE321159F0DE2343BBD44F9D2A2.png)
    
3. 从本地选择一个zip文件，该文件是在DevEco Testing中测试并生成的，具体操作方式请参考[性能基础质量测试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/specialized-testing#section12324184817324)或[场景化性能测试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/specialized-testing#section8642101711299)。点击**确认**后，请等待AppAnalyzer导入数据并对问题进行诊断分析。AppAnalyzer仅支持对DevEco Testing中的部分指标进行诊断，具体请参考[检测指标](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer#section1274133632120)。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155824.61298021104333145593276463634069:50001231000000:2800:697EFC5DACB4BFB5B4B1D018DCC114D11E1B647A99D07CD9BB53A4BC3D35D7EF.png)
    
4. 诊断完成后，查看测试结果如下。
    
    - 测试报告：测试结果的汇总信息，点击**详情链接**可跳转到对应场景的详情报告。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155825.00327405491263743538594927876781:50001231000000:2800:6359FA2610F9FB8370A6200A20A0E45C4D7F074C86AD3D6EC8BA721F563F05B9.png)
        
    - 详情报告：给出详细的测试结果、可能的故障原因和对应的优化建议。
        
        - **开始/结束页面、时间戳、调优文件（包含trace文件和调用栈文件）或snapshot文件等**：点击开始/结束页面可跳转到问题源码，点击时间戳可以打开性能分析工具Profiler并定位到问题发生的时间范围，点击调优文件或snapshot文件支持直接拉起Profiler并导入性能检测的问题数据进行调优分析。
        - **分析文档**：点击链接可跳转至官网文档，参考文档对检测出来的问题进行分析。
        - **优化建议**：针对可能的故障原因，给出对应的最佳实践，点击链接可跳转至官网文档。
        
        ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155825.20021687281547991068005054751023:50001231000000:2800:294933337A40CFB4C582691D64D0D0634D7099268690E3442DA6F296A1C193A7.png)
        
    
    说明
    
    由于DevEco Testing和AppAnalyzer在检测能力、检测方法以及场景识别上存在差异，所以通过DevEco Testing检测并导入AppAnalyzer诊断和直接通过AppAnalyzer检测并诊断，检测和诊断结果会出现不一致的情况。
    

### 检测指标

AppAnalyzer会将DevEco Testing测试用例的操作归类为以下场景，仅支持对部分指标进行诊断，具体如下。

|场景|检测指标|
|:--|:--|
|页面间转场|点击响应时延|
|点击完成时延|
|转场卡顿率|
|页面滑动|滑动响应时延|
|滑动卡顿率|
|冷启动|完成时延|
|页面内转场|滑动响应时延|
|点击响应时延|
|点击完成时延|
|滑动卡顿率|
|起播时延|

## 查看历史报告

### DevEco Studio 6.0.1 Beta1及以上版本

1. 在DevEco Studio中，点击菜单栏**Tools >** **AppAnalyzer**，弹出AppAnalyzer页面。
2. 点击底部**体检历史**按钮，可查看最近15次的体检报告卡片，点击卡片可跳转至详细的体检报告。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155825.40853323515691375765254667463498:50001231000000:2800:9D6A090BB3F6B5BBF805AEF259B4C7E1BC21F83DA09E56DCEA0C88A439F0CD84.png)
    

### DevEco Studio 6.0.1 Beta1以下版本

1. 在DevEco Studio中，点击菜单栏**Tools >** **AppAnalyzer**，弹出AppAnalyzer页面。
2. 点击底部**历史记录**按钮，可查看最近15次的体检报告记录，点击时间戳可跳转至详细的体检报告。
    
    ![](https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251216155825.35221659010173341716562950790331:50001231000000:2800:4F6E00BEB47C2D09045152E4F2A96C51B11A9BB8528ACEC661FBDDEF95B467BA.png)
    

[黑盒覆盖率测试](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ui-test "黑盒覆盖率测试")

[应用/元服务体检规则](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer-rules "应用/元服务体检规则")
# 规则总览

更新时间: 2025-12-16 15:58

以下是AppAnalyzer规则体检的所有规则，对应用/元服务进行体检的指导请参考[应用与元服务体检](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer)。

## DevEco Studio 6.0.1 Beta1及以上版本

### 功能兼容性

**表1**
|体检规则|规则详情|应用或元服务规则|
|:--|:--|:--|
|安装无兼容性问题|应用/元服务在其配置支持运行的对应软件版本/设备类型上成功安装。|应用，元服务|
|启动无兼容性问题|应用/元服务正常启动，进入首页界面。|应用，元服务|
|卸载无残留|应用/元服务在其配置支持运行的对应软件版本/设备类型上成功卸载，卸载无残留(包括文件、数据和进程)。|应用，元服务|
|运行无兼容性问题|应用/元服务要求在其支持的OS版本/设备类型上运行不会出现崩溃、冻屏无响应、无法返回等问题。|应用，元服务|
|元服务静默登录华为账号|元服务涉及账号体系和登录能力时，需规范使用华为账号能力进行静默登录，用户界面不能出现“登录”、“注册”、“退出登录”、“注销账号”描述。|元服务|
|元服务场景化Button组件使用规范|禁止底部页签自定义封装场景化button组件，即用户点击tab页签时，不能直接拉起button功能页面：快速验证手机号Button、选择头像Button、打开授权设置页Button、打开APP Button、选择收货地址Button、选择发票抬头Button、地图选点Button。|元服务|
|合理设计申请手机号授权功能|业务场景涉及华为账号快速验证手机号button使用时，需规范使用开放能力，不能用户一进入元服务就引导用户关联账号（必须）；不允许在页面只放置一个关联按钮/授权手机号按钮而没有其他功能（推荐）|元服务|
|元服务包结构应符合规范|元服务App Pack包中，同一个设备上必须有且仅有一个Entry Hap；不允许包含任何Feature类型的Hap包，可以包含一个或者多个Shared类型的Hsp包，也可以不包含。|元服务|
|应用要支持64位so文件|如果APP集成native so，则要求提供64位so。|应用|
|元服务内所有包总和大小不超过10MB|单个元服务内所有包文件的大小总和不能超过10MB|元服务|
|应用/元服务的显示名称有意义|应用和元服务安装之后的显示名称，在系统语言是中英文和默认语言名字都需要有意义，不可以是默认值或者通用无意义的值。|应用，元服务|
|卡片isDefault字段不可缺省|卡片isDefault不可缺省，每个应用或元服务有且只有一个默认卡片。|应用，元服务|
|卡片描述以索引展现|卡片description字段需要用索引方式填写。|应用，元服务|
|卡片描述有意义|卡片的描述不能是通用值，应该为displayName的详解。|应用，元服务|
|卡片的显示名称有意义|卡片的显示名称取值可以是名称内容，也可以是对名称内容的资源索引，不可以是通用无意义的值，E.g.widget\card\小组件。|应用，元服务|
|使用App Linking实现支持通过链接拉起应用的功能|如果涉及通过链接拉起应用的功能，建议使用App Linking的方式支持该功能。|应用|

### 性能

**表2**
|体检规则|规则详情|应用或元服务规则|
|:--|:--|:--|
|[动态内存峰值占用](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-peak-dynamic-memory-usage-0417)|应用/元服务完成操作后，各类应用在后台的内存占用峰值应≤ 1300MB；应用完成操作后切换到后台，静置3min以后采集内存占用。|应用，元服务|
|[前台场景内存峰值占用](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-peak-foreground-memory-usage-0418)|应用/元服务前台场景峰值内存占用：应用在前台且亮屏使用规程的内存占用应≤ 1500MB。|应用，元服务|
|[后台CPU占用峰值](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-peak-background-cpu-usage-0420)|应用/元服务后台CPU占用峰值：应用/元服务切换到后台等待3min后，开始采集3min内CPU Load < 5%。|应用，元服务|
|[点击操作完成快](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-quick-completion-for-click-0404)|应用内点击操作完成时延应≤ 900毫秒；时间起点：点击离手；时间终点：转场页面所有占位符加载完成。|应用，元服务|
|[滑动过程流畅](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-smooth-for-swipe-0413)|应用的滑动过程卡顿率≤ 5ms/s；满帧30FPS的游戏类、地图类和视频类的应用帧率应≥ 29FPS。|应用，元服务|
|[转场操作流畅](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-smooth-for-transition-0414)|应用的应用内转场过程卡顿率≤ 0ms/s；滑动过程卡顿率：动效时间内累计丢帧时间/动效时长。|应用，元服务|
|[节点数超过500过多](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-render-node-limit-0430)|后端Render Server在每帧数据里处理的节点数不应该超过500，否则会造成CPU使用过高，引发帧时延过高，从而导致丢帧。|应用，元服务|
|[点击操作响应快](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-quick-response-for-click-0403)|应用内点击操作响应时延应≤ 100毫秒；时间起点：点击离手；时间终点：界面发生变化。|应用，元服务|
|[滑动操作响应快](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-quick-response-for-swipe-0405)|应用内滑动操作响应时延应≤ 80毫秒；时间起点：手指滑动；时间终点：界面发生变化。|应用，元服务|
|序列化反序列化耗时长|使用TaskPool/Worker并发能力时候，会检测对象和方法在跨线程传递时序列化和反序列化的耗时；序列化和反序列化耗时应 ≤ 8ms。|应用，元服务|
|启动加载完成快|各类应用的冷启动首帧完成时延应 ≤ 1100毫秒；时间起点：桌面图标点击离手；时间终点：应用首页铺满全屏并且所有占位符加载完成。|应用，元服务|
|组件树节点数目过大|避免过大组件树节点数目。建议一个页面使用少于1000个组件树节点，节点树深度少于30层，子节点数不大于60个。|应用，元服务|
|执行函数耗时过长|避免执行函数耗时过长。函数执行时间是指函数在一次同步执行中消耗的时间，比如生命周期回调、事件处理函数的同步执行时间。建议单个函数执行周期内运行时间不超过15毫秒。|应用，元服务|
|渲染界面耗时过长|避免渲染界面耗时过长。建议单次渲染时间不超过500ms。渲染界面的耗时过长会让用户觉得卡顿，体验较差，出现这一情况时，需要校验下是否同时渲染的区域太大；页面中单个组件的渲染时间不超过15ms。|应用，元服务|
|ForEach中item数量过大|ForEach性能。ForEach中item数量要小于50。|应用，元服务|
|单帧属性数量更新内容限制|在高帧率场景单帧更新属性数量建议滑动场景不超过300个，非滑动场景不超过1500个。|应用，元服务|
|单帧脏组件数量限制|高帧率场景更新组件数量（含布局更新）建议滑动场景不超过30个，非滑动场景单帧更新组件数不超过500个。|应用，元服务|
|web组件初始化耗时长|避免web组件初始化耗时过长。在web页面加载场景下，web组件初始化时间不超过60ms。|应用，元服务|
|web执行js耗时|避免web页面js执行耗时过长。在web页面加载场景下，web页面单个js编译和执行时间不超过30ms，单个js函数调用时间不超过30ms，总体js编译和执行时间不超过300ms，总体js函数调用时间不超过130ms。|应用，元服务|
|UI线程IO执行耗时长未并行化|避免UI线程中执行文件IO耗时过长。UI主线程中，不应出现执行IO函数超过8.3毫秒，如果出现需要进行IO并行化改造。|应用，元服务|
|UI线程应用自身方法耗时长|UI线程应用自身方法耗时长检测。应用自身方法耗时长会导致丢帧。|应用，元服务|
|web主资源下载耗时长|避免web主资源下载耗时过长。在web页面加载场景下，web主资源下载时间不超过300ms。|应用，元服务|
|web子资源下载耗时长|避免web子资源下载耗时过长。在web页面加载场景下，web单个子资源下载时间不超过200ms。|应用，元服务|
|在线短视频类应用快速切换播放起播快|短视频起播时延，从用户滑动屏幕抬手后，到短视频第二帧画面(非封面帧)显示时间不应该超过700ms。|应用|
|相机拍照完成快|相机从拍照开始到生成可预览照片的完成时延不应超过1000ms。如果超过，建议使用分段式拍照。|应用|

### UX

**表3**
|体检规则|规则详情|应用或元服务规则|
|:--|:--|:--|
|布局基础要求(大屏)|设备在折叠/展开或横竖屏切换时，应用中的图片、视频等界面元素应避免出现错位/截断/变形等问题。|应用，元服务|
|图标文字大小适中|文字/图标物理大小建议：<br><br>展开态文字/图标大小为折叠态的1~1.2倍 (推荐)<br><br>不建议大于1.2/1.5倍 (必须)<br><br>不建议一排图标数量过多导致信息过密，折叠屏上建议一排不超过8个图标|应用，元服务|
|弹出框大小适中|展开态弹出框高度为折叠态的1~1.2倍 (推荐)，不建议高度大于1.2倍 (必须)。|应用，元服务|
|宫格图片信息量适中|宫格图片控件占比要求（控件高度/屏幕高度）：<br><br>1）单行图片高度不要太矮，不要低于屏幕高度的1/10，不要超过屏幕高度的2/5；<br><br>2）若宫格聚合图片整体作为信息流内容的配图，则建议整体高度不要低于屏幕高度的1/2，不要超过屏幕高度的2/3。|应用，元服务|
|广告图信息量适中|广告图控件占比要求（控件高度/屏幕高度）：<br><br>1）折叠屏展开态横竖屏时，广告图的图片高度不要超过一屏幕的1/2。|应用，元服务|
|上下图文信息量适中|1）上下图文结构中，建议信息流场景的图片左对齐，阅读场景的图片居中对齐。<br><br>2）图片的物理尺寸：折叠屏上展开态图片的放大倍数建议不超过1.2倍。<br><br>图片放大不超过1.2/1.5倍且满足控件高度占比要求 (推荐)；<br><br>图片放大倍数不超过1.2/1.5倍或满足控件高度占比要求 (必须)。<br><br>3）在折叠屏展开态等宽屏设备上最好通过延伸布局、挪移布局等方式让图文进行合理布局，避免图片过高。上下图文控件高度占比要求如下：<br><br>首页入口型的上下图文，不建议使用长图，宽图或方图的最大高度不要超过屏幕高度的1/3;<br><br>首页信息流结构的上下图文，图片最大高度不超过屏幕高度的2/5;<br><br>详情页内容型的上下图文，最大高度不要超过屏幕高度的3/5。|应用，元服务|
|边距适中|一般不建议用边距的方式来控制信息量，左右边距的留白不要太大。<br><br>同一个应用内不同的页面建议保持相同的边距。<br><br>同一个应用在不同端上，可以根据设备屏幕的宽度进行适量的边距调整。|应用，元服务|

### 功耗

**表4**
|体检规则|规则详情|应用或元服务规则|
|:--|:--|:--|
|后台进程CPU负载约束（长时任务）|应用或元服务后台CPU运行：后台进程持续10分钟CPU负载不得高于10%；(8核负载，即总负载为80%)|应用，元服务|
|后台进程CPU负载约束（短时任务）|应用后台CPU运行：后台进程任务期间CPU负载不得高于8%；(8核负载，即总负载为64%)|应用|
|无长时任务的应用退到后台不允许有BT扫描|无长时任务的应用或元服务退到后台不允许有蓝牙扫描|应用，元服务|
|无长时任务的应用退后台禁止使用麦克风或扬声器|无长时任务的应用或元服务退后台禁止使用麦克风或扬声器|应用，元服务|
|无长时任务的应用退后台禁止使用定位服务|无长时任务的应用或元服务退后台禁止使用定位服务|应用，元服务|
|应用退后台禁止使用传感器|应用或元服务退后台禁止使用传感器，前台使用时根据业务尽量使用once()接口监听结果|应用，元服务|
|后台合理使用音频播放|后台合理使用音频播放|应用，元服务|
|无长时任务的应用退后台对应资源释放，不能有持锁|无长时任务的应用退后台对应资源释放，不要直接或者间接持running lock锁|应用|
|音乐类应用设置正确的音乐类型|音乐类应用设置正确的音乐类型（如果应用或元服务为非音乐类，请忽略本次报错）|应用，元服务|
|应用处于前台不可见动效不使用资源，及时停止|应用处于前台不可见动效不使用资源，及时停止|应用，元服务|

### 安全

**表5**
|体检规则|规则详情|应用或元服务规则|
|:--|:--|:--|
|不对外交互的Ability的exported属性需要显式设置为false|不对外交互的Ability其exported或visible属性禁止设置为true|应用，元服务|
|对外交互的Ability应设置合理的访问权限|对外交互的Ability应设置合理的访问权限|应用，元服务|
|DataShareExtensionAbility权限检查|DataShareExtensionAbility内接口设置合理的读写访问权限|应用，元服务|
|应用权限申请遵循最小化原则|权限申请满足最小化原则，禁止申请不必要的、新版本废弃的权限|应用，元服务|
|动态公共事件接收器进行访问权限控制|对涉及敏感功能的公共事件进行访问权限控制|应用，元服务|
|应用软件应包含的签名信息需要真实有效|应用/元服务证书所有者的CN、OU、O、C字段不能为空|应用，元服务|
|三方SDK使用安全合规的版本|应用/元服务引入的三方SDK的版本号，在GIIC/信通院上属于安全合规的范围内|应用，元服务|
|非预期文件打包检测|检测应用/元服务包体文件目录是否存在.c/.h/.cpp/.cs/.java/.rs/.py/.go/.ets/.js/.ts非预期格式的文件|应用，元服务|

### 稳定性

**表6**
|体检规则|规则详情|应用或元服务规则|
|:--|:--|:--|
|应用/元服务崩溃|应用/元服务运行过程中无崩溃故障。|应用，元服务|
|应用/元服务卡死|应用/元服务运行过程中无冻屏卡死故障。|应用，元服务|
|内存泄露|检测出引起内存泄露的代码，提供代码堆栈日志下载。|应用，元服务|

## DevEco Studio 6.0.1 Beta1以下版本

### UX测试

仅API 20及以上版本的折叠屏手机可以进行UX测试。

**表7**
|体检规则|规则详情|应用或元服务规则|权重|
|:--|:--|:--|:--|
|布局基础要求(大屏)|设备在折叠/展开或横竖屏切换时，应用中的图片、视频等界面元素应避免出现错位/截断/变形等问题。|应用，元服务|5|
|图标文字大小适中|文字/图标物理大小建议：<br><br>展开态文字/图标大小为折叠态的1~1.2倍 (推荐)<br><br>不建议大于1.2/1.5倍 (必须)<br><br>不建议一排图标数量过多导致信息过密，折叠屏上建议一排不超过8个图标|应用，元服务|5|
|弹出框大小适中|展开态弹出框高度为折叠态的1~1.2倍 (推荐)，不建议高度大于1.2倍 (必须)。|应用，元服务|4|
|宫格图片信息量适中|宫格图片控件占比要求（控件高度/屏幕高度）：<br><br>1）单行图片高度不要太矮，不要低于屏幕高度的1/10，不要超过屏幕高度的2/5；<br><br>2）若宫格聚合图片整体作为信息流内容的配图，则建议整体高度不要低于屏幕高度的1/2，不要超过屏幕高度的2/3。|应用，元服务|4|
|广告图信息量适中|广告图控件占比要求（控件高度/屏幕高度）：<br><br>1）折叠屏展开态横竖屏时，广告图的图片高度不要超过一屏幕的1/2。|应用，元服务|4|
|上下图文信息量适中|1）上下图文结构中，建议信息流场景的图片左对齐，阅读场景的图片居中对齐。<br><br>2）图片的物理尺寸：折叠屏上展开态图片的放大倍数建议不超过1.2倍。<br><br>图片放大不超过1.2/1.5倍且满足控件高度占比要求 (推荐)；<br><br>图片放大倍数不超过1.2/1.5倍或满足控件高度占比要求 (必须)。<br><br>3）在折叠屏展开态等宽屏设备上最好通过延伸布局、挪移布局等方式让图文进行合理布局，避免图片过高。上下图文控件高度占比要求如下：<br><br>首页入口型的上下图文，不建议使用长图，宽图或方图的最大高度不要超过屏幕高度的1/3;<br><br>首页信息流结构的上下图文，图片最大高度不超过屏幕高度的2/5;<br><br>详情页内容型的上下图文，最大高度不要超过屏幕高度的3/5。|应用，元服务|4|
|边距适中|一般不建议用边距的方式来控制信息量，左右边距的留白不要太大。<br><br>同一个应用内不同的页面建议保持相同的边距。<br><br>同一个应用在不同端上，可以根据设备屏幕的宽度进行适量的边距调整。|应用，元服务|5|

### 功能和兼容性

**表8**
|体检规则|规则详情|应用或元服务规则|权重|
|:--|:--|:--|:--|
|应用/元服务支持在当前OS版本/设备类型安装|应用/元服务在其配置支持运行的对应软件版本/设备类型上成功安装。|应用，元服务|5|
|应用/元服务支持在当前OS版本/设备类型启动|应用/元服务正常启动，进入首页界面。|应用，元服务|5|
|应用/元服务支持在当前OS版本/设备类型卸载|应用/元服务在其配置支持运行的对应软件版本/设备类型上成功卸载，卸载无残留(包括文件、数据和进程)。|应用，元服务|4|
|应用/元服务在当前OS版本/设备类型运行稳定|应用/元服务要求在其支持的OS版本/设备类型上运行不会出现崩溃、冻屏无响应、无法返回等问题。|应用，元服务|3|
|元服务静默登录华为账号|元服务涉及账号体系和登录能力时，需规范使用华为账号能力进行静默登录，用户界面不能出现“登录”、“注册”、“退出登录”、“注销账号”描述。|元服务|4|

### 规格约束

**表9**
|体检规则|规则详情|应用或元服务规则|权重|
|:--|:--|:--|:--|
|元服务包结构应符合规范|元服务App Pack包中，同一个设备上必须有且仅有一个Entry Hap；不允许包含任何Feature类型的Hap包，可以包含一个或者多个Shared类型的Hsp包，也可以不包含。|元服务|5|
|设备类型检测<br><br>（从DevEco Studio 6.0.0 Beta2版本开始下线）|在一个应用/元服务包中，每个hap包必须明确支持的设备类型，不能为空。|应用，元服务|5|
|应用要支持64位so文件|如果APP集成native so，则要求提供64位so。|应用|4|
|元服务内所有包总和大小不超过10MB|单个元服务内所有包文件的大小总和不能超过10MB。|元服务|2|
|卡片isDefault字段检测|卡片isDefault不可缺省，每个应用或元服务有且只有一个默认卡片。|应用，元服务|3|
|卡片description字段检测|卡片description字段需要用索引方式填写。|应用，元服务|4|
|应用链接跳转检测|如果涉及通过链接拉起应用的功能，建议使用App Linking的方式支持该功能。|应用|3|
|元服务禁止使用so文件<br><br>（从DevEco Studio 6.0.0 Beta2版本开始下线）|元服务禁止集成native so，禁止使用so文件。|元服务|4|

### 性能

**表10**
|体检规则|规则详情|应用或元服务规则|权重|
|:--|:--|:--|:--|
|[应用/元服务内点击操作响应快](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-quick-response-for-click-0403)|起点：点击离手；<br><br>终点：界面发生变化；<br><br>应用/元服务内点击操作响应时延应≤ 100毫秒。|应用，元服务|3|
|[应用/元服务内点击操作完成快](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-quick-completion-for-click-0404)|时间起点：点击离手；<br><br>时间终点：转场页面所有占位符加载完成；<br><br>应用/元服务内点击操作完成时延应≤ 1600毫秒。|应用，元服务|3|
|[应用/元服务内滑动操作响应快](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-quick-response-for-swipe-0405)|时间起点：手指滑动；<br><br>时间终点：界面发生变化；<br><br>应用/元服务内滑动操作响应时延应≤ 80毫秒。|应用，元服务|3|
|[应用/元服务内滑动过程流畅](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-smooth-for-swipe-0413)|应用/元服务的滑动过程卡顿率≤ 5ms/s；<br><br>满帧30FPS的游戏类、地图类和视频类的应用帧率应≥ 29FPS。|应用，元服务|3|
|[应用/元服务内转场操作流畅](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-smooth-for-transition-0414)|应用/元服务内转场过程卡顿率≤ 0ms/s；<br><br>滑动过程卡顿率：动效时间内累计丢帧时间/动效时长。|应用，元服务|3|
|[应用/元服务动态内存峰值占用](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-peak-dynamic-memory-usage-0417)|应用/元服务完成操作后，各类应用在后台的内存占用峰值应≤ 1300MB；<br><br>应用完成操作后切换到后台，静置3min以后采集内存占用。|应用，元服务|3|
|[应用/元服务前台场景内存峰值占用](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-peak-foreground-memory-usage-0418)|应用/元服务前台场景峰值内存占用：应用在前台且亮屏使用过程的内存占用应≤ 1500MB。|应用，元服务|3|
|[应用/元服务后台CPU占用峰值](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-peak-background-cpu-usage-0420)|应用/元服务后台CPU占用峰值：应用切换到后台等待3min后，开始采集3min内CPU Load < 5%。|应用，元服务|3|
|[图形渲染服务处理节点数小于500](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-render-node-limit-0430)|后端Render Server在每帧数据里处理的节点数不应该超过500，否则会造成CPU使用过高，引发帧时延过高，从而导致丢帧。|应用，元服务|1|

### 最佳实践

说明

以下体检规则不支持在编译模式为release下运行，请把编译模式切换到debug再重新检测：避免过大组件树节点数目、避免执行函数耗时过长、避免渲染界面耗时过长、ForEach性能检测。

**表11**
|体检规则|规则详情|应用或元服务规则|权重|
|:--|:--|:--|:--|
|避免过大组件树节点数目|避免过大组件树节点数目。<br><br>建议一个页面使用少于1000个组件树节点，节点树深度少于30层，子节点数不大于60个。|应用，元服务|2|
|避免执行函数耗时过长|避免执行函数耗时过长。<br><br>函数执行时间是指函数在一次同步执行中消耗的时间，比如生命周期回调、事件处理函数的同步执行时间。建议单个函数执行周期内运行时间不超过15毫秒。|应用，元服务|2|
|避免渲染界面耗时过长|避免渲染界面耗时过长。<br><br>建议单次渲染时间不超过500ms。渲染界面的耗时过长会让用户觉得卡顿，体验较差，出现这一情况时，需要校验下是否同时渲染的区域太大；页面中单个组件的渲染时间不超过15ms。|应用，元服务|2|
|ForEach性能检测|ForEach性能。<br><br>ForEach中item数量要小于50。|应用，元服务|2|
|单帧属性数量更新内容限制|在高帧率场景单帧更新属性数量建议滑动场景不超过300个，非滑动场景不超过1500个。|应用，元服务|2|
|单帧脏组件数量限制|高帧率场景更新组件数量（含布局更新）建议滑动场景不超过30个，非滑动场景单帧更新组件数不超过500个。|应用，元服务|2|
|web组件初始化耗时检测|避免web组件初始化耗时过长。<br><br>在web页面加载场景下，web组件初始化时间不超过60ms。|应用，元服务|2|
|web执行js耗时检测|避免web页面js执行耗时过长。<br><br>在web页面加载场景下，web页面单个js编译和执行时间不超过30ms，单个js函数调用时间不超过30ms，总体js编译和执行时间不超过300ms，总体js函数调用时间不超过130ms。|应用，元服务|2|
|UI线程IO执行耗时长未并行化检测|避免UI线程中执行文件IO耗时过长。<br><br>UI主线程中，不应出现执行IO函数超过8.3毫秒，如果出现需要进行IO并行化改造。|应用，元服务|2|
|UI线程应用自身方法耗时长检测|避免UI线程中的函数耗时过长。<br><br>UI主线程中，不应出现函数超过8.3毫秒。|应用，元服务|2|
|web主资源下载耗时检测|避免web主资源下载耗时过长。<br><br>在web页面加载场景下，web主资源下载时间不超过300ms。|应用，元服务|2|
|web子资源下载耗时检测|避免web子资源下载耗时过长。<br><br>在web页面加载场景下，web单个子资源下载时间不超过200ms。|应用，元服务|2|
|短视频起播时延检测|时间起点：从用户滑动屏幕抬手后；<br><br>时间终点：到短视频第二帧画面(非封面帧)；<br><br>显示时间≤ 700毫秒|应用|2|
|相机拍照完成时延检测|相机从拍照开始到生成可预览照片的完成时延不应超过1000ms。<br><br>如果超过，建议使用分段式拍照。<br><br>注意：请授予相机的权限|应用|2|
|应用/元服务非预期文件打包检测<br><br>（从DevEco Studio 6.0.0 Beta3版本开始支持）|检测应用/元服务包体文件目录是否存在.c/.h/.cpp/.cs/.java/.rs/.py/.go/.ets/.js/.ts非预期格式的文件。|应用，元服务|2|

### 功耗

**表12**
|体检规则|规则详情|应用或元服务规则|权重|
|:--|:--|:--|:--|
|后台进程CPU负载约束（长时任务）|应用或元服务后台CPU运行：后台进程持续10分钟CPU负载不得高于10%；(8核负载，即总负载为80%)。|应用，元服务|1|
|后台进程CPU负载约束（短时任务）|应用后台CPU运行：后台进程任务期间CPU负载不得高于8%；(8核负载，即总负载为64%)。|应用|1|
|合理使用蓝牙资源|无长时任务的应用或元服务退到后台不允许有蓝牙扫描。|应用，元服务|1|
|合理使用麦克风或者扬声器|禁止后台无长时任务的应用或元服务使用麦克风或扬声器。|应用，元服务|1|
|合理使用GPS资源|无长时任务的应用或元服务退后台禁止使用定位服务。|应用，元服务|1|
|合理使用sensor资源|应用或元服务退后台禁止使用传感器，前台使用时根据业务尽量使用once()接口监听结果。|应用，元服务|1|
|后台合理使用音频播放<br><br>（从DevEco Studio 6.0.0 Beta3版本开始支持）|应用或元服务在后台开启音频播放，禁止不写入数据或者写入静音数据等类似恶意行为|应用，元服务|2|
|后台合理使用系统资源|无长时任务的应用退后台对应资源释放，不要直接或者间接持running lock锁。|应用|1|
|音乐类应用或元服务设置正确的音乐类型<br><br>（从DevEco Studio 6.0.0 Beta3版本开始支持）|音乐类应用或元服务设置正确的音乐类型，走对应的系统低功耗方案|应用，元服务|2|
|应用或元服务处于前台不可见动效不使用资源，及时停止<br><br>（从DevEco Studio 6.0.0 Beta3版本开始支持）|应用或元服务在前台，不允许有RS绘制空跑|应用，元服务|4|

### 快速性能

**表13**
|体检规则|规则详情|应用或元服务规则|权重|
|:--|:--|:--|:--|
|页面内点击操作完成时延快速检测|时间起点：点击离手；<br><br>时间终点：转场页面所有占位符加载完成；<br><br>应用内点击操作完成时延应≤ 1600毫秒。|应用|3|
|页面内滑动过程流畅性快速检测|应用的滑动过程卡顿率≤ 5ms/s；<br><br>满帧30FPS的游戏类、地图类和视频类的应用帧率应≥ 29FPS。|应用|3|
|页面转场操作流畅性快速检测|应用的应用内转场过程卡顿率≤ 0ms/s；<br><br>滑动过程卡顿率：动效时间内累计丢帧时间/动效时长。|应用|3|
|页面内节点数超过500过多快速检测|后端Render Server在每帧数据里处理的节点数不应该超过500，否则会造成CPU使用过高，引发帧时延过高，从而导致丢帧。|应用|1|
|页面内白块检测|应用内页面检测到白块，需要避免快速滑动场景下因数据来不及加载而出现白块。|应用|1|
|页面内点击操作响应时延快速检测|起点：点击离手；<br><br>终点：界面发生变化；<br><br>应用内点击操作响应时延应≤ 100毫秒。|应用|3|
|页面内滑动响应时延快速检测|时间起点：手指滑动；<br><br>时间终点：界面发生变化；<br><br>应用内滑动操作响应时延应≤ 80毫秒。|应用|3|
|避免页面内UI容器组件超出屏幕过多|避免滑动类容器组件区域超出屏幕显示范围10%。<br><br>滑动类容器组件的渲染范围与容器大小相同，超出屏幕的不可见部分为冗余渲染。<br><br>在页面切换的场景，过多的冗余渲染，可能会让用户觉得页面切换慢，响应不及时。<br><br>建议将滑动类容器组件的大小和位置限定在屏幕显示范围内。<br><br>如果因为嵌套滚动等效果，必须超出屏幕的，可以考虑使用分帧多次加载数据的方式，优先渲染可见部分，提升页面切换性能。|应用|1|
|应用冷启动完成时延检测|应用首页铺满全屏并且所有占位符加载完成。|应用|3|
|避免序列化反序列化耗时长|使用TaskPool/Worker并发能力时候，会检测对象和方法在跨线程传递时序列化和反序列化的耗时；<br><br>序列化和反序列化耗时应 ≤ 8ms。|应用|3|

### 安全

**表14**
|体检规则|规则详情|应用或元服务规则|权重|
|:--|:--|:--|:--|
|Ability可见性设置检测|不对外交互的Ability其exported或visible属性禁止设置为true。|应用，元服务|2|
|Ability权限设置检测|对外交互的Ability应设置合理的访问权限。|应用，元服务|2|
|DataShareExtensionAbility组件权限检测|必须对DataShareExtensionAbility内接口设置合理的读写访问权限。|应用，元服务|2|
|权限申请最小化原则检测|权限申请满足最小化原则，禁止申请不必要的、新版本废弃的权限。|应用，元服务|2|
|公共事件接收器权限访问控制检测|对涉及敏感功能的公共事件进行访问权限控制。|应用，元服务|2|
|应用/元服务签名完整性检测<br><br>（从DevEco Studio 6.0.0 Beta2版本开始下线）|应用/元服务需保证签名完整性。|应用，元服务|2|
|应用/元服务签名信息检测<br><br>（从DevEco Studio 6.0.0 Beta5版本开始下线）|应用/元服务证书所有者的CN、OU、O、C字段不能为空。|应用，元服务|2|
|三方SDK使用经GIIC联盟认证过的安全合规的版本|应用/元服务引入的三方SDK的版本号，在GIIC/信通院上属于安全合规的范围内。|应用，元服务|5|

### 稳定性

**表15**
|体检规则|规则详情|应用或元服务规则|权重|
|:--|:--|:--|:--|
|应用/元服务崩溃检测|应用或元服务运行过程中无崩溃故障。|应用，元服务|2|
|应用/元服务卡死检测|应用或元服务运行过程中无冻屏卡死故障。|应用，元服务|4|
|应用/元服务内存泄漏检测|检测出引起内存泄漏的代码，提供代码堆栈日志下载。|应用，元服务|4|

[应用/元服务体检规则](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-app-analyzer-rules "应用/元服务体检规则")

[点击操作响应快](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-quick-response-for-click-0403 "点击操作响应快")
