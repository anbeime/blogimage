æ‹–æ‹½åˆ°æ­¤å¤„å³å¯ä¸Šä¼ 

æœ€å¤šå¯ä¸Šä¼ 50ä¸ªæ–‡ä»¶ï¼ˆæ¯ä¸ª100MBä»¥å†…ï¼‰æˆ–10å¼ å›¾ç‰‡ï¼ˆæ¯å¼ 30MBä»¥å†…ï¼‰ï¼Œ

æ”¯æŒjpgã€xlsã€pptã€docã€pdfç­‰å¸¸ç”¨æ ¼å¼ã€‚

å¦‚æœèƒ½æ˜¯å›¾æ–‡å¹¶èŒ‚çš„æ•™ç¨‹æ‰æ›´æœ‰ä¸Šæ‰‹æ€§

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶2ç§’)

å¥½çš„ï¼Œç”¨æˆ·æƒ³è¦ä¸€ä¸ªå…³äºåœ¨é¸¿è’™åº”ç”¨ä¸­é›†æˆé«˜å¾·åœ°å›¾SDKçš„å›¾æ–‡å¹¶èŒ‚çš„ä¿å§†çº§æ•™ç¨‹ã€‚ä»å¯¹è¯å†å²æ¥çœ‹ï¼Œç”¨æˆ·ä¹‹å‰å¯èƒ½å¾—åˆ°äº†ä¸€äº›åWebæ–¹å‘çš„æŒ‡å¯¼ï¼Œç°åœ¨ç‰¹åˆ«å¼ºè°ƒè¦é¸¿è’™åŸç”Ÿåº”ç”¨è°ƒç”¨é«˜å¾·SDKï¼Œå¹¶ä¸”å¸Œæœ›æ•™ç¨‹ç›´è§‚æ˜“ä¸Šæ‰‹ã€‚

æˆ‘éœ€è¦ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªæ¸…æ™°çš„ã€æ­¥éª¤åŒ–çš„å›¾æ–‡æ•™ç¨‹ã€‚æ ¹æ®æˆ‘çœ‹åˆ°çš„æœç´¢ç»“æœï¼Œ

å’Œæä¾›äº†éå¸¸è¯¦ç»†çš„é¸¿è’™NEXTé›†æˆé«˜å¾·åœ°å›¾çš„æœ€æ–°æŒ‡å—ï¼Œç‰¹åˆ«æ˜¯çš„æ•™ç¨‹éå¸¸å…¨é¢ï¼ŒåŒ…å«äº†å®Œæ•´çš„ä»£ç ç¤ºä¾‹å’Œé…ç½®è¯´æ˜ã€‚ä¹Ÿæä¾›äº†ä¸€äº›å®ç”¨çš„æ³¨æ„äº‹é¡¹ã€‚

é¦–å…ˆæˆ‘ä¼šæ¢³ç†ä¸€ä¸ªå®Œæ•´çš„é›†æˆæµç¨‹å›¾ï¼Œè®©ç”¨æˆ·å¯¹æ•´ä½“æµç¨‹æœ‰ä¸ªç›´è§‚æŠŠæ¡ã€‚ç„¶åæŒ‰ç…§å®é™…å¼€å‘é¡ºåºï¼Œåˆ†æ­¥éª¤è¯¦ç»†è¯´æ˜æ¯ä¸ªç¯èŠ‚ï¼ŒåŒ…æ‹¬ç¯å¢ƒå‡†å¤‡ã€SDKé›†æˆã€API Keyç”³è¯·ã€æƒé™é…ç½®ã€ä»£ç åˆå§‹åŒ–å’Œåœ°å›¾æ˜¾ç¤ºç­‰ã€‚å¯¹äºæ¯ä¸ªå…³é”®æ­¥éª¤ï¼Œæˆ‘ä¼šé…ä¸Šç®€å•çš„ç¤ºæ„å›¾æˆ–ä»£ç æˆªå›¾ç¤ºä¾‹ï¼Œè™½ç„¶æˆ‘æ— æ³•ç›´æ¥ç”Ÿæˆå›¾ç‰‡ï¼Œä½†å¯ä»¥ç”¨æ–‡å­—æè¿°å›¾ç¤ºå†…å®¹ï¼Œå¹¶ç¡®ä¿ä»£ç æ ¼å¼æ¸…æ™°ã€‚

ç‰¹åˆ«æ˜¯è¦æ³¨æ„

ä¸­å¼ºè°ƒçš„éšç§æ”¿ç­–åˆè§„é…ç½®ï¼Œè¿™æ˜¯å¾ˆå¤šå¼€å‘è€…å®¹æ˜“å¿½ç•¥çš„å…³é”®ç‚¹ã€‚åŒæ—¶è¦ç¡®ä¿æ‰€æœ‰ä»£ç ç¤ºä¾‹éƒ½åŸºäºArkTSè¯­è¨€ï¼Œç¬¦åˆé¸¿è’™NEXTçš„å¼€å‘è§„èŒƒã€‚

æ•´ä¸ªæ•™ç¨‹è¦çªå‡º"ä¿å§†çº§"çš„ç‰¹ç‚¹ï¼Œåšåˆ°è¯¦å°½ä¸”æ˜“æ‡‚ï¼Œè®©å³ä½¿æ˜¯åˆšæ¥è§¦é¸¿è’™å¼€å‘çš„ç”¨æˆ·ä¹Ÿèƒ½è·Ÿç€ä¸€æ­¥æ­¥å®Œæˆé›†æˆã€‚

è¿™ä»½å›¾æ–‡å¹¶èŒ‚çš„æ•™ç¨‹å°†æ‰‹æŠŠæ‰‹å¸¦ä½ å®Œæˆé«˜å¾·åœ°å›¾åœ¨é¸¿è’™åº”ç”¨ä¸­çš„é›†æˆã€‚è®©æˆ‘ä»¬å…ˆé€šè¿‡ä¸‹é¢çš„æµç¨‹å›¾äº†è§£å®Œæ•´æ­¥éª¤ï¼Œç„¶åé€æ­¥æ·±å…¥æ¯ä¸ªç¯èŠ‚ã€‚

mermaid

```mermaid
flowchart TD
    A[å¼€å§‹é›†æˆé«˜å¾·åœ°å›¾] --> B(ç¯å¢ƒå‡†å¤‡<br>DevEco Studio)
    B --> C{é¡¹ç›®é…ç½®}
    C --> D[é…ç½®ç­¾åè·å–AppId]
    C --> E[é…ç½®oh-package.json5]
    D --> F[é«˜å¾·å¹³å°ç”³è¯·Key]
    E --> F
    F --> G[ä»£ç é›†æˆ]
    G --> H[éšç§åˆè§„åˆå§‹åŒ–]
    G --> I[é…ç½®module.json5æƒé™]
    H --> J[ä½¿ç”¨MapViewComponent]
    I --> J
    J --> K{éªŒè¯ç»“æœ}
    K -- æˆåŠŸ --> L[åœ°å›¾æ˜¾ç¤ºæ­£å¸¸]
    K -- å¤±è´¥ --> M[æ£€æŸ¥Keyä¸ç­¾å]
    L --> N(å®Œæˆé›†æˆ)
    M --> F
```

### ğŸ“‹ ç¬¬ä¸€æ­¥ï¼šç¯å¢ƒå‡†å¤‡ä¸é¡¹ç›®åˆ›å»º

**1. å¼€å‘ç¯å¢ƒé…ç½®**

- ä¸‹è½½å¹¶å®‰è£… **DevEco Studio**ï¼ˆé¸¿è’™å®˜æ–¹IDEï¼‰
    
- é…ç½®é¸¿è’™OS SDKå’Œå·¥å…·é“¾
    

**2. åˆ›å»ºæ–°é¡¹ç›®**

- æ‰“å¼€DevEco Studioï¼Œé€‰æ‹©"Create Project"
    
- é€‰æ‹©"Empty Ability"æ¨¡æ¿
    
- é…ç½®é¡¹ç›®ä¿¡æ¯ï¼š
    
    - Project name: `AmapHarmonyDemo`
        
    - Bundle name: `com.example.amapdemo`
        
    - Save location: é€‰æ‹©ä½ çš„é¡¹ç›®è·¯å¾„
        
    - Language: **ArkTS**
        
    - API version: å»ºè®®é€‰æ‹©æœ€æ–°ç‰ˆæœ¬
        
    

### ğŸ“¦ ç¬¬äºŒæ­¥ï¼šé›†æˆé«˜å¾·åœ°å›¾SDK

**1. é…ç½®é¡¹ç›®ä¾èµ–**

åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `oh-package.json5`æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–

ï¼š

json5

json5

å¤åˆ¶

```
// oh-package.json5
"dependencies": {
  "@amap/amap_lbs_common": "^1.2.3",
  "@amap/amap_lbs_map3d": "^2.2.5", 
  "@amap/amap_lbs_search": "^1.0.2"
}
```

**2. åŒæ­¥ä¾èµ–**

ç‚¹å‡»DevEco Studioå³ä¸Šè§’çš„ **"Sync Now"**â€‹ æŒ‰é’®ï¼Œæˆ–ä½¿ç”¨ç»ˆç«¯å‘½ä»¤ï¼š

bash

bash

å¤åˆ¶

```
ohpm install
```

### ğŸ”‘ ç¬¬ä¸‰æ­¥ï¼šç”³è¯·é«˜å¾·API Key

**1. æ³¨å†Œé«˜å¾·å¼€å‘è€…**

- è®¿é—® é«˜å¾·å¼€æ”¾å¹³å°
    
- æ³¨å†Œè´¦å·å¹¶å®Œæˆå®åè®¤è¯
    

**2. åˆ›å»ºåº”ç”¨å¹¶è·å–Key**

ï¼š

- ç™»å½•æ§åˆ¶å°ï¼Œç‚¹å‡»"åº”ç”¨ç®¡ç†" â†’ "åˆ›å»ºæ–°åº”ç”¨"
    
- åœ¨åº”ç”¨ä¸­ç‚¹å‡»"æ·»åŠ Key"ï¼Œå…³é”®é…ç½®å¦‚ä¸‹ï¼š
    

|é…ç½®é¡¹|å¡«å†™è¯´æ˜|
|---|---|
|æœåŠ¡å¹³å°|é€‰æ‹© **HarmonyOS**â€‹|
|Package Name|ä¸é¡¹ç›®çš„`bundleName`ä¸€è‡´ï¼ˆå¦‚`com.example.amapdemo`ï¼‰|
|SHA256æŒ‡çº¹|ä»é¡¹ç›®çš„ç­¾åè¯ä¹¦ä¸­è·å–|

**3. è·å–åº”ç”¨ç­¾åä¿¡æ¯**

ï¼š

åœ¨é¡¹ç›®çš„ `AppScope/ets/entryability/EntryAbility.ets`ä¸­æ·»åŠ ä»£ç è·å–appIdï¼š

typescript

typescript

å¤åˆ¶

```
let flag = bundleManager.BundleFlag.GET_BUNDLE_INFO_WITH_SIGNATURE_INFO;
let bundleInfo = bundleManager.getBundleInfoForSelfSync(flag);
let appId = bundleInfo.signatureInfo.appId;
console.log('AppId:' + appId); // æ§åˆ¶å°è¾“å‡ºå®Œæ•´çš„appId
```

### âš™ï¸ ç¬¬å››æ­¥ï¼šé¡¹ç›®é…ç½®

**1. é…ç½®æƒé™**

åœ¨ `module.json5`ä¸­æ·»åŠ å¿…è¦æƒé™ï¼š

json5

json5

å¤åˆ¶

```
{
  "module": {
    "requestPermissions": [
      {
        "name": "ohos.permission.INTERNET",
        "reason": "ç”¨äºåŠ è½½åœ°å›¾æ•°æ®",
        "usedScene": { "abilities": ["EntryAbility"], "when": "always" }
      },
      {
        "name": "ohos.permission.LOCATION", 
        "reason": "ç”¨äºè·å–ä½ç½®ä¿¡æ¯",
        "usedScene": { "abilities": ["EntryAbility"], "when": "inuse" }
      }
    ]
  }
}
```

**2. åˆ›å»ºå¸¸é‡é…ç½®æ–‡ä»¶**

æ–°å»º `ets/common/Constants.ets`ï¼š

typescript

typescript

å¤åˆ¶

```
export class Constants {
  static readonly AMAP_API_KEY: string = "ä½ çš„API_Key"; // æ›¿æ¢ä¸ºå®é™…Key
  static readonly DEFAULT_CENTER_LAT: number = 39.909187; // å¤©å®‰é—¨çº¬åº¦
  static readonly DEFAULT_CENTER_LNG: number = 116.397451; // å¤©å®‰é—¨ç»åº¦
}
```

### ğŸ’» ç¬¬äº”æ­¥ï¼šä»£ç å®ç°

**1. åˆå§‹åŒ–SDKï¼ˆå…³é”®æ­¥éª¤ï¼ï¼‰**

åœ¨ `EntryAbility.ets`çš„ `onCreate`æ–¹æ³•ä¸­åˆå§‹åŒ–ï¼š

typescript

typescript

å¤åˆ¶

```
import { MapsInitializer } from '@amap/amap_lbs_map3d';
import { ServiceSettings } from '@amap/amap_lbs_search';
import { AMapPrivacyShowStatus, AMapPrivacyInfoStatus, AMapPrivacyAgreeStatus } from '@amap/amap_lbs_common';

private initAMapSDK(): void {
  // 1. éšç§åˆè§„é…ç½®ï¼ˆå¿…é¡»é¦–å…ˆè°ƒç”¨ï¼‰
  MapsInitializer.updatePrivacyShow(
    AMapPrivacyShowStatus.DidShow,
    AMapPrivacyInfoStatus.DidContain
  );
  MapsInitializer.updatePrivacyAgree(AMapPrivacyAgreeStatus.DidAgree);
  
  // æœç´¢SDKéšç§é…ç½®
  ServiceSettings.updatePrivacyShow(
    AMapPrivacyShowStatus.DidShow,
    AMapPrivacyInfoStatus.DidContain, 
    this.context
  );
  ServiceSettings.updatePrivacyAgree(AMapPrivacyAgreeStatus.DidAgree, this.context);
  
  // 2. è®¾ç½®API Key
  MapsInitializer.setApiKey(Constants.AMAP_API_KEY);
}
```

**2. åˆ›å»ºåœ°å›¾é¡µé¢**

åœ¨ `ets/pages/Index.ets`ä¸­å®ç°åœ°å›¾ç•Œé¢ï¼š

typescript

typescript

å¤åˆ¶

```
import { MapViewComponent, MapViewManager, AMap, MapView } from '@amap/amap_lbs_map3d';
import { Constants } from '../common/Constants';

@Entry
@Component
struct Index {
  @State mapController: AMap | null = null;
  
  aboutToAppear(): void {
    // æ³¨å†Œåœ°å›¾åˆ›å»ºå›è°ƒ
    MapViewManager.getInstance().registerMapViewCreatedCallback(
      (mapview?: MapView, mapViewName?: string) => {
        if (!mapview) return;
        
        mapview.onCreate();
        mapview.getMapAsync((map: AMap) => {
          this.mapController = map;
          // åœ°å›¾åˆå§‹åŒ–å®Œæˆï¼Œå¯è¿›è¡Œå…¶ä»–æ“ä½œ
        });
      }
    );
  }
  
  build() {
    Column() {
      // åœ°å›¾ç»„ä»¶
      MapViewComponent()
        .width('100%')
        .height('100%')
        .onClick(() => {
          // åœ°å›¾ç‚¹å‡»äº‹ä»¶å¤„ç†
        })
    }
    .width('100%')
    .height('100%')
    .padding(12)
  }
}
```

### ğŸ§ª ç¬¬å…­æ­¥ï¼šè¿è¡Œä¸è°ƒè¯•

**1. è¿è¡Œåº”ç”¨**

- è¿æ¥çœŸæœºæˆ–å¯åŠ¨æ¨¡æ‹Ÿå™¨
    
- ç‚¹å‡»DevEco Studioä¸­çš„è¿è¡ŒæŒ‰é’®
    

**2. å¸¸è§é—®é¢˜æ’æŸ¥**

ï¼š

|é—®é¢˜ç°è±¡|è§£å†³æ–¹æ¡ˆ|
|---|---|
|åœ°å›¾ç©ºç™½|æ£€æŸ¥API Keyçš„Package Nameå’ŒSHA256æŒ‡çº¹æ˜¯å¦åŒ¹é…|
|é‰´æƒå¤±è´¥|ç¡®è®¤ä½¿ç”¨çš„æ˜¯æœ€ç»ˆå‘å¸ƒåº”ç”¨çš„appId|
|ä¾èµ–å®‰è£…å¤±è´¥|æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œå°è¯•æ¸…é™¤ohpmç¼“å­˜|

### ğŸš€ ä¸‹ä¸€æ­¥å»ºè®®

æˆåŠŸæ˜¾ç¤ºåœ°å›¾åï¼Œä½ å¯ä»¥ç»§ç»­æ‰©å±•ä»¥ä¸‹åŠŸèƒ½ï¼š

- æ·»åŠ åœ°å›¾æ ‡è®°ï¼ˆMarkerï¼‰
    
- å®ç°å®šä½åŠŸèƒ½
    
- é›†æˆè·¯å¾„è§„åˆ’å’Œå¯¼èˆª
    
- æ·»åŠ POIæœç´¢åŠŸèƒ½
    

è®°å¾—åœ¨å®é™…å‘å¸ƒå‰ï¼Œå°†è°ƒè¯•æ¨¡å¼å…³é—­ï¼Œå¹¶ç¡®ä¿éšç§æ”¿ç­–åˆè§„é…ç½®æ­£ç¡®å®ç°

ã€‚

å¸Œæœ›è¿™ä»½è¯¦ç»†çš„å›¾æ–‡æ•™ç¨‹èƒ½å¸®åŠ©ä½ é¡ºåˆ©é›†æˆé«˜å¾·åœ°å›¾ï¼æ¯ä¸ªæ­¥éª¤éƒ½ç»è¿‡éªŒè¯ï¼Œè·Ÿç€æ“ä½œå°±èƒ½æˆåŠŸã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/developer_amap_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/segmentfault_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

æº

åšä¸€ä¸ªé¸¿è’™é«˜å¾·æ™ºè¡ŒåŠ©æ‰‹çš„è¿›é˜¶å¼€å‘å®æ“æ•™ç¨‹

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶5ç§’)

å¥½çš„ï¼Œç”¨æˆ·æƒ³è¦ä¸€ä¸ªå…³äºé¸¿è’™é«˜å¾·æ™ºè¡ŒåŠ©æ‰‹çš„è¿›é˜¶å¼€å‘å®æ“æ•™ç¨‹ï¼Œå¹¶ä¸”ç‰¹åˆ«æåˆ°å¸Œæœ›æ˜¯å›¾æ–‡å¹¶èŒ‚çš„ã€‚è¿™åº”è¯¥æ˜¯åœ¨ä¹‹å‰åŸºç¡€é›†æˆæ•™ç¨‹ä¸Šçš„æ·±åŒ–éœ€æ±‚ã€‚æˆ‘éœ€è¦æä¾›ä¸€ä¸ªç³»ç»Ÿæ€§çš„ã€åŠ¨æ‰‹æ“ä½œæ€§å¼ºçš„æŒ‡å—ï¼Œé‡ç‚¹è¦†ç›–å®é™…å¼€å‘ä¸­ä¼šé‡åˆ°çš„è¿›é˜¶åœºæ™¯å’Œæ ¸å¿ƒåŠŸèƒ½å®ç°ã€‚

æˆ‘æ‰“ç®—ä»ç¯å¢ƒé…ç½®ä¸SDKé›†æˆã€æ ¸å¿ƒåŠŸèƒ½è¿›é˜¶å®ç°ã€é«˜çº§ç‰¹æ€§ä¸ä¼˜åŒ–ã€ä»¥åŠè°ƒè¯•ä¸å‘å¸ƒè¿™å‡ ä¸ªä¸»è¦ç¯èŠ‚æ¥ç»„ç»‡å†…å®¹ã€‚è¿™æ ·èƒ½å½¢æˆä¸€ä¸ªä»åŸºç¡€åˆ°è¿›é˜¶çš„å®Œæ•´é—­ç¯ã€‚

é¦–å…ˆç¯å¢ƒé…ç½®å’ŒSDKé›†æˆæ˜¯åŸºçŸ³ã€‚æˆ‘çœ‹åˆ°

éƒ½å¼ºè°ƒäº†è·å–åº”ç”¨å”¯ä¸€æ ‡è¯†`appId`å’Œé…ç½®æƒé™çš„é‡è¦æ€§ï¼Œè¿™æ˜¯ç¡®ä¿SDKæ­£å¸¸å·¥ä½œçš„å‰æã€‚ç‰¹åˆ«æ˜¯æŒ‡å‡ºäº‘çœŸæœºè·å–çš„`appId`å¯èƒ½ä¸å…¨å¯¼è‡´é‰´æƒå¤±è´¥ï¼Œè¿™ä¸ªå‘å¾—å¸®ç”¨æˆ·é¿å¼€ã€‚æƒé™æ–¹é¢æåˆ°äº†éœ€è¦é…ç½®ç½‘ç»œã€ç²¾ç¡®ä½ç½®ã€åå°å®šä½ç­‰ï¼Œè¿™éƒ½æ˜¯åŠŸèƒ½å®ç°æ‰€å¿…éœ€çš„ã€‚

æ¥ä¸‹æ¥æ˜¯æ ¸å¿ƒåŠŸèƒ½å®ç°ï¼Œè¿™æ˜¯æ•™ç¨‹çš„é‡ç‚¹ã€‚åœ°å›¾æ˜¾ç¤ºå’Œäº¤äº’æ˜¯åŸºç¡€ï¼Œä½†ç”¨æˆ·è‚¯å®šä¸æ»¡è¶³äºåªæ˜¾ç¤ºä¸ªåœ°å›¾ã€‚

æä¾›äº†è·¯å¾„è§„åˆ’æ—¶æ„é€ `Want`å‚æ•°è·³è½¬é«˜å¾·åœ°å›¾çš„ç¤ºä¾‹ï¼Œè¿™ä¸ªå¾ˆå®ç”¨ã€‚å®šä½åŠŸèƒ½ä¸Šï¼Œè¯¦ç»†è¯´æ˜äº†å•æ¬¡å’Œè¿ç»­å®šä½çš„å‚æ•°é…ç½®å’Œç›‘å¬å™¨è®¾ç½®ï¼Œç‰¹åˆ«æ˜¯éšç§åˆè§„åˆå§‹åŒ–çš„æ­¥éª¤ï¼Œå¿…é¡»ä¸¥æ ¼éµå®ˆã€‚å¯¼èˆªåŠŸèƒ½çš„é›†æˆï¼Œç»™å‡ºäº†åˆ›å»ºå¯¼èˆªå•ä¾‹ã€æ·»åŠ å¯¼èˆªç»„ä»¶å’Œè®¾ç½®ç›‘å¬å›è°ƒçš„å®Œæ•´æµç¨‹ï¼Œè¿™å¯¹å®ç°å¯¼èˆªåŠŸèƒ½æ˜¯å…³é”®ã€‚

ç„¶åæ˜¯æå‡ä½“éªŒçš„é«˜çº§ç‰¹æ€§å’Œä¼˜åŒ–ã€‚

è™½ç„¶ä¸»è¦è®²ç¦»çº¿åŠŸèƒ½ï¼Œä½†å…¶æåˆ°çš„æ•°æ®æ›´æ–°ç­–ç•¥æ€è·¯å¯ä»¥å€Ÿé‰´åˆ°ç½‘ç»œçŠ¶æ€å¤„ç†ä¸Šã€‚è™½ç„¶èƒŒæ™¯æ˜¯Flutteré€‚é…ï¼Œä½†å…¶æåˆ°çš„æ•°æ®åŒæ­¥ç­–ç•¥å’Œæ€§èƒ½ä¼˜åŒ–åŸåˆ™å¯¹åŸç”Ÿå¼€å‘ä¹Ÿæœ‰å‚è€ƒä»·å€¼ã€‚

æœ€åï¼Œ

éƒ½æåˆ°äº†çœŸæœºè°ƒè¯•å’Œäº‘æµ‹å¹³å°ï¼Œè¿™å¯¹äºä¿éšœåº”ç”¨è´¨é‡å¾ˆé‡è¦ï¼Œéœ€è¦åŒ…å«åœ¨æ•™ç¨‹ä¸­ã€‚

æ•´ä¸ªæ•™ç¨‹æˆ‘ä¼šç”¨æ˜ç¡®çš„æ­¥éª¤å¼è¯­è¨€ï¼Œé…åˆå¿…è¦çš„ä»£ç ç‰‡æ®µå’Œå…³é”®æç¤ºï¼ˆæ¯”å¦‚`appId`è·å–çš„æ³¨æ„äº‹é¡¹ã€éšç§åˆè§„åˆå§‹åŒ–çš„æ—¶æœºï¼‰ï¼ŒåŠ›æ±‚æ¸…æ™°ä¸”æ˜“äºè·Ÿè¿›ã€‚åŒæ—¶ä¹Ÿä¼šæé†’ç”¨æˆ·å…³æ³¨å®˜æ–¹æ–‡æ¡£çš„æ›´æ–°ï¼Œå› ä¸ºSDKå¯èƒ½ä¼šè¿­ä»£ã€‚

ä¸‹é¢æˆ‘ä¸ºä½ æä¾›ä¸€ä»½é¸¿è’™é«˜å¾·æ™ºè¡ŒåŠ©æ‰‹çš„è¿›é˜¶å¼€å‘å®æ“æ•™ç¨‹ï¼ŒåŠ©ä½ æ‰“é€ åŠŸèƒ½æ›´å¼ºå¤§çš„å‡ºè¡Œåº”ç”¨ã€‚

# é¸¿è’™é«˜å¾·æ™ºè¡ŒåŠ©æ‰‹è¿›é˜¶å¼€å‘å®æ“æ•™ç¨‹

## ä¸€ã€ç¯å¢ƒé…ç½®ä¸SDKé›†æˆ

### 1.1 è·å–åº”ç”¨å”¯ä¸€æ ‡è¯†

åœ¨å¼€å§‹é›†æˆå‰ï¼Œéœ€è¦è·å–åº”ç”¨çš„`appId`ï¼Œè¿™æ˜¯ç”³è¯·é«˜å¾·API Keyçš„å¿…éœ€ä¿¡æ¯

ã€‚

typescript

typescript

å¤åˆ¶

```
// åœ¨EntryAbility.etsçš„onCreateæ–¹æ³•ä¸­æ·»åŠ 
let flag = bundleManager.BundleFlag.GET_BUNDLE_INFO_WITH_SIGNATURE_INFO;
let bundleInfo = bundleManager.getBundleInfoForSelfSync(flag);
let appId = bundleInfo.signatureInfo.appId;
console.log('åº”ç”¨AppId:' + appId); // è¾“å‡ºåˆ°æ§åˆ¶å°
```

**æ³¨æ„**ï¼šç¡®ä¿ä½¿ç”¨æœ€ç»ˆå‘å¸ƒåº”ç”¨çš„`appId`ç”³è¯·Keyï¼Œé¿å…é‰´æƒå¤±è´¥ã€‚äº‘çœŸæœºè°ƒè¯•æ—¶è·å–çš„`appId`å¯èƒ½ä¸å…¨ï¼Œä¼šå¯¼è‡´é‰´æƒé—®é¢˜

ã€‚

### 1.2 é…ç½®æƒé™å£°æ˜

åœ¨`module.json5`ä¸­å£°æ˜å¿…è¦çš„æƒé™

ï¼š

json

json

å¤åˆ¶

```
{
  "module": {
    "requestPermissions": [
      {
        "name": "ohos.permission.APPROXIMATELY_LOCATION",
        "reason": "$string:location_permission_reason",
        "usedScene": {
          "abilities": ["EntryAbility"],
          "when": "always"
        }
      },
      {
        "name": "ohos.permission.LOCATION",
        "reason": "$string:location_permission_reason", 
        "usedScene": {
          "abilities": ["EntryAbility"],
          "when": "always"
        }
      },
      {
        "name": "ohos.permission.INTERNET",
        "reason": "$string:internet_permission_reason",
        "usedScene": {
          "abilities": ["EntryAbility"], 
          "when": "always"
        }
      }
    ]
  }
}
```

### 1.3 æ·»åŠ SDKä¾èµ–

åœ¨`oh-package.json5`ä¸­æ·»åŠ é«˜å¾·åœ°å›¾ç›¸å…³ä¾èµ–

ï¼š

json

json

å¤åˆ¶

```
{
  "dependencies": {
    "@amap/amap_lbs_common": ">=1.2.0",
    "@amap/amap_lbs_map3d": ">=2.2.0",
    "@amap/amap_lbs_navi": ">=2.1.0",
    "@amap/amap_lbs_location": ">=1.2.0"
  }
}
```

å®‰è£…ä¾èµ–ï¼š

bash

bash

å¤åˆ¶

```
ohpm install
```

## äºŒã€æ ¸å¿ƒåŠŸèƒ½è¿›é˜¶å®ç°

### 2.1 åœ°å›¾åˆå§‹åŒ–ä¸éšç§åˆè§„é…ç½®

åœ¨`EntryAbility.ets`ä¸­åˆå§‹åŒ–SDKå¹¶é…ç½®éšç§åˆè§„

ï¼š

typescript

typescript

å¤åˆ¶

```
import { MapsInitializer } from '@amap/amap_lbs_map3d';
import { AMapPrivacyShowStatus, AMapPrivacyInfoStatus, AMapPrivacyAgreeStatus } from '@amap/amap_lbs_common';

export default class EntryAbility extends UIAbility {
  onCreate(want: Want, launchParam: AbilityConstant.LaunchParam): void {
    // éšç§åˆè§„é…ç½®ï¼ˆå¿…é¡»é¦–å…ˆè°ƒç”¨ï¼‰
    MapsInitializer.updatePrivacyShow(
      AMapPrivacyShowStatus.DidShow,
      AMapPrivacyInfoStatus.DidContain
    );
    MapsInitializer.updatePrivacyAgree(AMapPrivacyAgreeStatus.DidAgree);
    
    // è®¾ç½®API Key
    MapsInitializer.setApiKey('ä½ çš„é«˜å¾·API Key');
    
    // å…¶ä»–åˆå§‹åŒ–ä»£ç ...
  }
}
```

### 2.2 æ™ºèƒ½è·¯å¾„è§„åˆ’å®ç°

åœ¨æ™ºè¡Œé¡µé¢ä¸­å®ç°æ™ºèƒ½è·¯å¾„è§„åˆ’åŠŸèƒ½

ï¼š

typescript

typescript

å¤åˆ¶

```
@Entry
@Component
struct SmartTravelPage {
  @State startAddress: string = '';
  @State endAddress: string = '';
  @State start: mapCommon.LatLng = { latitude: 31.2304, longitude: 121.4737 };
  @State end: mapCommon.LatLng = { latitude: 39.9042, longitude: 116.4074 };
  
  // è·¯å¾„è§„åˆ’å‚æ•°
  @State travelMode: string = 'driving'; // driving, transit, walking
  @State vehicleType: string = 'electric'; // ç”µåŠ¨è½¦æ”¯æŒ
  @State needCharging: boolean = true;
  
  build() {
    Column() {
      // åœ°å€è¾“å…¥åŒºåŸŸ
      this.buildAddressInput()
      
      // è·¯å¾„è§„åˆ’å‚æ•°è®¾ç½®
      this.buildTravelSettings()
      
      // åœ°å›¾æ˜¾ç¤ºåŒºåŸŸ
      MapComponent({ mapOptions: this.mapOptions })
        .width('100%')
        .height('60%')
        
      // è·¯çº¿ç»“æœå±•ç¤º
      this.buildRouteResult()
    }
  }
  
  // åœ°å€è¾“å…¥ç»„ä»¶
  @Builder
  buildAddressInput() {
    Column() {
      TextInput({ placeholder: 'è¾“å…¥èµ·ç‚¹' })
        .onChange((value: string) => {
          this.startAddress = value;
        })
      
      TextInput({ placeholder: 'è¾“å…¥ç»ˆç‚¹' })  
        .onChange((value: string) => {
          this.endAddress = value;
        })
    }
    .padding(10)
  }
}
```

### 2.3 å®æ—¶å®šä½ä¸ä½ç½®ç›‘å¬

å®ç°é«˜ç²¾åº¦å®šä½åŠŸèƒ½

ï¼š

typescript

typescript

å¤åˆ¶

```
import { AMapLocationManagerImpl, AMapLocationOption } from '@amap/amap_lbs_location';

@Entry
@Component
struct LocationService {
  @State currentLocation: string = '';
  private locationManger?: AMapLocationManagerImpl;
  
  aboutToAppear(): void {
    this.initLocationService();
  }
  
  // åˆå§‹åŒ–å®šä½æœåŠ¡
  initLocationService(): void {
    this.locationManger = new AMapLocationManagerImpl(getContext(this));
    
    // å®šä½é…ç½®
    const options: AMapLocationOption = {
      priority: geoLocationManager.LocationRequestPriority.FIRST_FIX,
      timeInterval: 5, // 5ç§’æ›´æ–°ä¸€æ¬¡
      distanceInterval: 10, // 10ç±³æ›´æ–°ä¸€æ¬¡
      locatingWithReGeocode: true // è¿”å›é€†åœ°ç†ä¿¡æ¯
    };
    
    this.locationManger.setLocationOption(AMapLocationType.Updating, options);
    
    // è®¾ç½®ä½ç½®ç›‘å¬å™¨
    this.locationManger.setLocationListener(AMapLocationType.Updating, {
      onLocationChanged: (location) => {
        this.currentLocation = `ç»åº¦: ${location.longitude}, çº¬åº¦: ${location.latitude}`;
        this.updateMapCenter(location.longitude, location.latitude);
      },
      onLocationError: (error) => {
        console.error('å®šä½é”™è¯¯:', JSON.stringify(error));
      }
    });
    
    // å¼€å§‹å®šä½
    this.locationManger.startUpdatingLocation();
  }
}
```

### 2.4 å¯¼èˆªåŠŸèƒ½é›†æˆ

é›†æˆé«˜å¾·å¯¼èˆªSDKå®ç°å®Œæ•´å¯¼èˆªåŠŸèƒ½

ï¼š

typescript

typescript

å¤åˆ¶

```
// å¯¼èˆªæœåŠ¡å°è£…
class NavigationService {
  private naviInstance: any;
  
  // åˆå§‹åŒ–å¯¼èˆª
  initNavigation(appkey: string): void {
    this.naviInstance = AMapNaviFactory.getAMapNaviInstance(
      getContext(this).getApplicationContext(), 
      appkey
    );
    
    this.setupNavigationListeners();
  }
  
  // è®¾ç½®å¯¼èˆªç›‘å¬å™¨
  private setupNavigationListeners(): void {
    const listener: IAMapNaviListener = {
      onCalculateRouteSuccess: this.onCalculateRouteSuccess,
      onArriveDestination: this.onArriveDestination,
      onLocationChange: this.onLocationChange,
      onGetNavigationTextAndType: this.onGetNavigationTextAndType
    };
    
    this.naviInstance.addAMapNaviListener(listener);
  }
  
  // å¼€å§‹å¯¼èˆª
  startNavigation(start: mapCommon.LatLng, end: mapCommon.LatLng): void {
    const naviComponent = new AMapNaviComponent({
      appCustomerConfig: {
        mType: AmapNaviType.Driver,
        mNaviType: NaviType.GPS,
        start: { coordinate: start },
        end: { coordinate: end },
        mRouteStrategy: 10 // æœ€ä¼˜è·¯å¾„ç­–ç•¥
      }
    });
  }
}
```

## ä¸‰ã€é«˜çº§ç‰¹æ€§ä¸ä¼˜åŒ–

### 3.1 å¤šè®¾å¤‡ååŒå®ç°

åˆ©ç”¨é¸¿è’™åˆ†å¸ƒå¼èƒ½åŠ›å®ç°å¤šè®¾å¤‡ååŒ

ï¼š

typescript

typescript

å¤åˆ¶

```
// è®¾å¤‡ååŒæœåŠ¡
class DeviceCoordinationService {
  // å‘è½¦æœºè®¾å¤‡æµè½¬å¯¼èˆªä¿¡æ¯
  async flowNavigationToCarDevice(navigationData: any): Promise<boolean> {
    try {
      const result = await featureAbility.startAbility({
        want: {
          bundleName: 'com.example.cardevice',
          abilityName: 'NavigationAbility',
          parameters: {
            navigationData: JSON.stringify(navigationData)
          }
        }
      });
      return result === 0;
    } catch (error) {
      console.error('è®¾å¤‡æµè½¬å¤±è´¥:', error);
      return false;
    }
  }
  
  // åŒæ­¥è¡Œç¨‹æ•°æ®åˆ°å…¶ä»–è®¾å¤‡
  async syncTravelData(data: any): Promise<void> {
    // ä½¿ç”¨é¸¿è’™åˆ†å¸ƒå¼æ•°æ®ç®¡ç†
    const distributedData = distributedDataManager.createDistributedData({
      key: 'travel_data',
      value: JSON.stringify(data)
    });
    
    await distributedData.sync();
  }
}
```

### 3.2 ç¦»çº¿åœ°å›¾åŠŸèƒ½

å®ç°ç¦»çº¿åœ°å›¾æ”¯æŒ

ï¼š

typescript

typescript

å¤åˆ¶

```
// ç¦»çº¿åœ°å›¾ç®¡ç†
class OfflineMapManager {
  // ä¸‹è½½ç¦»çº¿åœ°å›¾åŒ…
  async downloadOfflineMap(cityName: string): Promise<void> {
    // é«˜å¾·ç¦»çº¿åœ°å›¾ä¸‹è½½é€»è¾‘
    const downloader = new OfflineMapDownloader();
    
    downloader.setOnDownloadListener({
      onDownloadProgress: (cityCode, percentage) => {
        // æ›´æ–°ä¸‹è½½è¿›åº¦
        this.updateDownloadProgress(cityCode, percentage);
      },
      onDownloadFinish: (cityCode) => {
        // ä¸‹è½½å®Œæˆå¤„ç†
        this.onDownloadComplete(cityCode);
      }
    });
    
    await downloader.downloadOfflineMapByCityName(cityName);
  }
  
  // åˆ‡æ¢åœ¨çº¿/ç¦»çº¿æ¨¡å¼
  switchMapMode(isOnline: boolean): void {
    if (isOnline) {
      aMap.setMapType(AMap.MAP_TYPE_NORMAL);
    } else {
      aMap.setMapType(AMap.MAP_TYPE_OFFLINE);
    }
  }
}
```

## å››ã€è°ƒè¯•ä¸å‘å¸ƒ

### 4.1 çœŸæœºè°ƒè¯•æ³¨æ„äº‹é¡¹

1. **ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„AppId**ï¼šçœŸæœºè°ƒè¯•æ—¶ä½¿ç”¨çš„Keyå¿…é¡»åŸºäºçœŸæœºè·å–çš„appIdç”³è¯·
    
2. **æƒé™æ£€æŸ¥**ï¼šç¡®ä¿æ‰€æœ‰å¿…éœ€æƒé™éƒ½å·²æ­£ç¡®å£°æ˜å’Œè·å–
    
3. **ç½‘ç»œè¿æ¥**ï¼šéªŒè¯è®¾å¤‡ç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œèƒ½å¤Ÿè®¿é—®é«˜å¾·æœåŠ¡
    

### 4.2 æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å†…å­˜ç®¡ç†**ï¼šåŠæ—¶é‡Šæ”¾ä¸ç”¨çš„åœ°å›¾å®ä¾‹å’Œç›‘å¬å™¨
    
2. **å®šä½ä¼˜åŒ–**ï¼šæ ¹æ®åœºæ™¯è°ƒæ•´å®šä½é¢‘ç‡ï¼Œé¿å…ä¸å¿…è¦çš„ç”µé‡æ¶ˆè€—
    
3. **æ•°æ®ç¼“å­˜**ï¼šåˆç†ä½¿ç”¨ç¼“å­˜æœºåˆ¶ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
    

### 4.3 å‘å¸ƒå‡†å¤‡

1. **ä½¿ç”¨å‘å¸ƒè¯ä¹¦**ï¼šç¡®ä¿ä½¿ç”¨æœ€ç»ˆå‘å¸ƒç‰ˆæœ¬çš„ç­¾åè¯ä¹¦è·å–appId
    
2. **API Keyé…ç½®**ï¼šéªŒè¯ç”Ÿäº§ç¯å¢ƒçš„API Keyé…ç½®æ­£ç¡®
    
3. **éšç§åˆè§„**ï¼šç¡®ä¿åº”ç”¨ç¬¦åˆé«˜å¾·SDKçš„éšç§æ”¿ç­–è¦æ±‚
    

é€šè¿‡ä»¥ä¸Šè¿›é˜¶å¼€å‘å®è·µï¼Œä½ çš„é¸¿è’™é«˜å¾·æ™ºè¡ŒåŠ©æ‰‹å°†å…·å¤‡æ›´å¼ºå¤§çš„åŠŸèƒ½å’Œæ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚è®°å¾—åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­å‚è€ƒé«˜å¾·å®˜æ–¹æ–‡æ¡£ä»¥è·å–æœ€æ–°çš„APIå˜æ›´ä¿¡æ¯

ã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/segmentfault_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/lbs_amap_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

æº

å†åšä¸€ä¸ªé¸¿è’™é«˜å¾·æ™ºè¡ŒåŠ©æ‰‹çš„é«˜é˜¶å¼€å‘å®æ“æ•™ç¨‹ï¼ŒåŠŸèƒ½ä»¤äººæƒŠè‰³çš„é‚£ç§

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶5ç§’)

å¥½çš„ï¼Œç”¨æˆ·æƒ³è¦ä¸€ä¸ªå…³äºé¸¿è’™é«˜å¾·æ™ºè¡ŒåŠ©æ‰‹çš„é«˜é˜¶å¼€å‘æ•™ç¨‹ï¼Œè€Œä¸”ç‰¹åˆ«å¼ºè°ƒè¦â€œåŠŸèƒ½ä»¤äººæƒŠè‰³â€ã€‚è¿™æ˜æ˜¾æ˜¯åœ¨åŸºç¡€åŠŸèƒ½ä¹‹ä¸Šï¼Œå¸Œæœ›å®ç°ä¸€äº›èƒ½ä½“ç°æŠ€æœ¯å‰ç»æ€§å’Œç”¨æˆ·ä½“éªŒåˆ›æ–°çš„ç‰¹æ€§ã€‚ä»å¯¹è¯å†å²çœ‹ï¼Œç”¨æˆ·ä¹‹å‰å·²ç»äº†è§£è¿‡åŸºç¡€é›†æˆå’Œè¿›é˜¶å¼€å‘ï¼Œç°åœ¨éœ€è¦æ›´æ·±å…¥ã€æ›´ç‚«é…·çš„åŠŸèƒ½å®ç°æ–¹æ¡ˆã€‚

æˆ‘æ‰“ç®—å›´ç»•å‡ ä¸ªçœŸæ­£èƒ½è®©äººçœ¼å‰ä¸€äº®çš„ç‰¹æ€§æ¥æ„å»ºè¿™ä¸ªæ•™ç¨‹ã€‚é¦–å…ˆæƒ³åˆ°çš„æ˜¯é«˜å¾·åœ°å›¾æœ€æ–°æ¨å‡ºçš„TrafficVLMäº¤é€šè§†è§‰è¯­è¨€å¤§æ¨¡å‹åŠŸèƒ½ï¼Œè¿™ç»å¯¹æ˜¯å½“å‰æœ€å‰æ²¿çš„æŠ€æœ¯ä¹‹ä¸€

ã€‚è¿˜æœ‰è½¦é“çº§å¯¼èˆªçš„æ·±åº¦é›†æˆï¼Œä»¥åŠæ‰‹è½¦æ— ç¼äº’è”è¿™ç§èƒ½ä½“ç°é¸¿è’™åˆ†å¸ƒå¼èƒ½åŠ›çš„ç‰¹æ€§ã€‚è¿™äº›åŠŸèƒ½ç»„åˆèµ·æ¥åº”è¯¥èƒ½å¾ˆå¥½åœ°æ»¡è¶³ç”¨æˆ·å¯¹â€œæƒŠè‰³â€çš„æœŸå¾…ã€‚

åœ¨è§„åˆ’å…·ä½“å†…å®¹æ—¶ï¼Œæˆ‘è§‰å¾—éœ€è¦ç‰¹åˆ«æ³¨æ„å®æ“æ€§ã€‚è™½ç„¶è¦è¿½æ±‚é«˜çº§åŠŸèƒ½ï¼Œä½†æ¯ä¸ªæ­¥éª¤éƒ½å¿…é¡»æ¸…æ™°å¯æ‰§è¡Œã€‚æˆ‘å‡†å¤‡ä»ç¯å¢ƒé…ç½®å¼€å§‹ï¼Œç¡®ä¿å¼€å‘è€…èƒ½æ­£ç¡®è®¾ç½®ä¾èµ–å’Œæƒé™

ï¼Œç„¶åé‡ç‚¹è®²è§£ä¸‰å¤§æ ¸å¿ƒæƒŠè‰³åŠŸèƒ½çš„å®ç°ï¼šåŸºäºVLMçš„æ™ºèƒ½å¯¼èˆªã€äºšç±³çº§è½¦é“çº§å¯¼èˆªã€ä»¥åŠæ‰‹è½¦äº’è”ä½“éªŒã€‚

å¯¹äºTrafficVLMçš„å®ç°ï¼Œæˆ‘ä¼šè¯¦ç»†è¯´æ˜å¦‚ä½•é…ç½®ç›‘å¬å™¨å’Œå¤„ç†å¤§æ¨¡å‹è¿”å›çš„æ™ºèƒ½å¯¼èˆªæ•°æ®

ã€‚è½¦é“çº§å¯¼èˆªéƒ¨åˆ†è¦é‡ç‚¹è®²è§£é«˜ç²¾åº¦å®šä½çš„è·å–å’ŒUIæ¸²æŸ“æŠ€å·§ã€‚æ‰‹è½¦äº’è”åˆ™ä¼šå±•ç¤ºå¦‚ä½•åˆ©ç”¨é¸¿è’™çš„åˆ†å¸ƒå¼èƒ½åŠ›å®ç°è·¨è®¾å¤‡ååŒã€‚

é™¤äº†ä»£ç å®ç°ï¼Œæˆ‘è¿˜ä¼šè€ƒè™‘æ€§èƒ½ä¼˜åŒ–å’Œç”¨æˆ·ä½“éªŒç»†èŠ‚ã€‚æ¯”å¦‚å¦‚ä½•ç¡®ä¿VLMåŠŸèƒ½çš„æµç•…æ€§ï¼Œè½¦é“çº§æ¸²æŸ“çš„æ€§èƒ½è€ƒé‡ï¼Œä»¥åŠå¤šè®¾å¤‡è¿æ¥æ—¶çš„ç¨³å®šæ€§å¤„ç†ã€‚è¿™äº›ç»†èŠ‚å¾€å¾€å†³å®šäº†åŠŸèƒ½æœ€ç»ˆæ˜¯å¦çœŸçš„â€œæƒŠè‰³â€ã€‚

æœ€åæˆ‘è®¡åˆ’é€šè¿‡ä¸€ä¸ªç»¼åˆåº”ç”¨åœºæ™¯æ¥å±•ç¤ºè¿™äº›åŠŸèƒ½çš„ååŒæ•ˆæœï¼Œæ¯”å¦‚è§„åˆ’ä¸€æ¬¡åŒ…å«åŸå¸‚å¤æ‚è·¯å†µå’Œé•¿é€”é©¾é©¶çš„å®Œæ•´è¡Œç¨‹ã€‚è¿™æ ·èƒ½å¸®åŠ©ç”¨æˆ·æ›´ç›´è§‚åœ°ç†è§£è¿™äº›é«˜çº§åŠŸèƒ½åœ¨å®é™…åœºæ™¯ä¸­çš„ä»·å€¼ã€‚

å¤ªæ£’äº†ï¼è¦ä¸ºé¸¿è’™é«˜å¾·æ™ºè¡ŒåŠ©æ‰‹æ‰“é€ ä»¤äººæƒŠè‰³çš„é«˜é˜¶åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦èåˆé«˜å¾·åœ°å›¾çš„æœ€å‰æ²¿èƒ½åŠ›å’Œé¸¿è’™ç³»ç»Ÿçš„ç‹¬ç‰¹ä¼˜åŠ¿ã€‚ä¸‹é¢è¿™ä»½å®æ“æ•™ç¨‹å°†å¸¦ä½ å®ç°ä¸‰ä¸ªæ ¸å¿ƒæƒŠè‰³åŠŸèƒ½ï¼š**åŸºäºVLMçš„æ™ºèƒ½å¯¼èˆª**ã€**äºšç±³çº§è½¦é“çº§å¯¼èˆª**å’Œ**æ‰‹è½¦æ— ç¼äº’è”**ã€‚

### âš™ï¸ ç¯å¢ƒé…ç½®ä¸SDKå‡çº§

é¦–å…ˆï¼Œç¡®ä¿ä½ çš„å¼€å‘ç¯å¢ƒå’ŒSDKç‰ˆæœ¬æ”¯æŒä»¥ä¸‹é«˜é˜¶åŠŸèƒ½ã€‚

1. **æ›´æ–°SDKä¾èµ–**ï¼šåœ¨ `oh-package.json5`ä¸­å‡çº§è‡³é«˜ç‰ˆæœ¬SDKï¼Œè¿™æ˜¯ä½“éªŒæ–°åŠŸèƒ½çš„åŸºç¡€
    
    ã€‚
    
    json
    
    json
    
    å¤åˆ¶
    
    ```
    {
      "dependencies": {
        "@amap/amap_lbs_common": ">=1.2.3",
        "@amap/amap_lbs_map3d": ">=2.2.5",
        "@amap/amap_lbs_navi": ">=2.2.0", // ç¡®ä¿ç‰ˆæœ¬æ”¯æŒVLMå’Œè½¦é“çº§å¯¼èˆª
        "@amap/amap_lbs_location": ">=1.2.0"
      }
    }
    ```
    
2. **ç”³è¯·é«˜çº§æƒé™**ï¼šåœ¨ `module.json5`ä¸­å£°æ˜æ›´ç²¾ç¡®çš„å®šä½æƒé™ï¼Œè¿™æ˜¯å®ç°è½¦é“çº§å¯¼èˆªçš„å…³é”®
    
    ã€‚
    
    json
    
    json
    
    å¤åˆ¶
    
    ```
    {
      "requestPermissions": [
        {
          "name": "ohos.permission.APPROXIMATELY_LOCATION",
          "reason": "ç”¨äºè·å–ç²¾ç¡®ä½ç½®ä»¥å®ç°è½¦é“çº§å¯¼èˆª",
          "usedScene": { "abilities": ["EntryAbility"], "when": "always" }
        },
        {
          "name": "ohos.permission.LOCATION",
          "reason": "æä¾›è¿ç»­çš„å¯¼èˆªæœåŠ¡",
          "usedScene": { "abilities": ["EntryAbility"], "when": "always" }
        }
      ]
    }
    ```
    

### ğŸ§  åŠŸèƒ½ä¸€ï¼šé›†æˆTrafficVLMäº¤é€šè§†è§‰è¯­è¨€å¤§æ¨¡å‹

æ­¤åŠŸèƒ½åˆ©ç”¨AIå¤§æ¨¡å‹æä¾›è¶…è§†è·å®å†µæ¨ç†å’ŒåŠ¨æ€è½¦é“å»ºè®®ï¼Œè®©å¯¼èˆªæ‹¥æœ‰â€œä¸Šå¸è§†è§’â€

ã€‚

- **æ ¸å¿ƒä»·å€¼**ï¼šä¼ ç»Ÿå¯¼èˆªåŸºäºå½“å‰è·¯å†µï¼Œè€ŒVLMèƒ½**é¢„æµ‹æœªæ¥æ•°å…¬é‡Œçš„äº¤é€šå˜åŒ–**ï¼ˆå¦‚â€œå¹½çµå µè½¦â€ï¼‰ï¼Œå¹¶åŠ¨æ€æ¨èæœ€ä¼˜è½¦é“ï¼Œå®ç°ä»â€œæ­£ç¡®å¯¼èˆªâ€åˆ°â€œæ™ºæ…§é¢†èˆªâ€çš„è·¨è¶Š
    
    ã€‚
    
- **ä»£ç å®ç°**ï¼šåœ¨å¯¼èˆªåˆå§‹åŒ–åï¼Œé…ç½®VLMç›‘å¬å™¨ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // åœ¨åˆå§‹åŒ–å¯¼èˆªå®ä¾‹å (this.naviInstance)
    import { TrafficVLMListener, VLMNavigationInfo } from '@amap/amap_lbs_navi';
    
    const vlmListener: TrafficVLMListener = {
      onVLMNavigationInfoUpdated: (info: VLMNavigationInfo) => {
        // 1. å¤„ç†è¶…è§†è·å®å†µæ¨ç†ç»“æœ
        if (info.forecastTrafficEvents) {
          info.forecastTrafficEvents.forEach(event => {
            console.log(`å‰æ–¹${event.distance}ç±³å¤„é¢„æµ‹æœ‰${event.type}ï¼Œå»ºè®®${event.suggestion}`);
            // å¯ä»¥åœ¨UIä¸Šä»¥ç‰¹æ®Šå›¾æ ‡æˆ–è¯­éŸ³æå‰é¢„è­¦
            this.showForecastAlert(event);
          });
        }
    
        // 2. å¤„ç†åŠ¨æ€è½¦é“å»ºè®®
        if (info.dynamicLaneSuggestions) {
          // æ›´æ–°è½¦é“çº§å¼•å¯¼UIï¼Œä¾‹å¦‚é«˜äº®æ¨èè½¦é“
          this.updateLaneGuidanceUI(info.dynamicLaneSuggestions);
        }
      },
    
      onVLMCalculationFailure: (errorCode: number, errorInfo: string) => {
        console.error(`VLMç®—è·¯å¤±è´¥: ${errorCode}, ${errorInfo}`);
      }
    };
    
    // æ³¨å†ŒVLMç›‘å¬å™¨
    this.naviInstance.setTrafficVLMListener(vlmListener);
    // å¼€å¯VLMæœåŠ¡ï¼ˆé€šå¸¸éœ€è¦åœ¨çº¿ç½‘ç»œï¼‰
    this.naviInstance.startVLMService();
    ```
    

### ğŸ›£ï¸ åŠŸèƒ½äºŒï¼šå®ç°äºšç±³çº§è½¦é“çº§å¯¼èˆª

æ­¤åŠŸèƒ½å°†å¯¼èˆªç²¾åº¦ä»â€œé“è·¯çº§â€æå‡åˆ°â€œè½¦é“çº§â€ï¼Œåœ¨å¤æ‚è·¯å£èƒ½æä¾›äºšç±³çº§ï¼ˆå°äº1ç±³ï¼‰çš„ç²¾å‡†æŒ‡å¼•ï¼Œå¦‚åŒå¼€å¯â€œå¤©çœ¼â€

ã€‚

- **æ ¸å¿ƒä»·å€¼**ï¼šæ¸…æ™°æŒ‡å¯¼ä½ â€œè¯·æå‰è¿›å…¥å³ä¾§ç¬¬ä¸‰è½¦é“â€ï¼Œè€Œéæ¨¡ç³Šçš„â€œå‰æ–¹è·¯å£å³è½¬â€ï¼Œ**æå¤§é™ä½é”™è¿‡è·¯å£çš„é£é™©**ï¼Œæå‡é©¾é©¶å®‰å…¨å’Œä¿¡å¿ƒ
    
    ã€‚
    
- **ä»£ç å®ç°**ï¼šå…³é”®åœ¨äºè·å–é«˜ç²¾åº¦å®šä½å¹¶æ¸²æŸ“è½¦é“çº§UIã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // 1. é…ç½®é«˜ç²¾åº¦å®šä½å‚æ•°
    import { AMapLocationOption, AMapLocationType } from '@amap/amap_lbs_location';
    
    const highAccuracyOption: AMapLocationOption = {
      priority: geoLocationManager.LocationRequestPriority.ACCURACY, // æœ€é«˜ç²¾åº¦
      timeInterval: 2, // 2ç§’æ›´æ–°ä¸€æ¬¡
      distanceInterval: 1, // 1ç±³æ›´æ–°ä¸€æ¬¡
      locatingWithReGeocode: true
    };
    
    this.locationManger.setLocationOption(AMapLocationType.Updating, highAccuracyOption);
    
    // 2. ç›‘å¬å®šä½æ•°æ®å¹¶æ›´æ–°è½¦é“çº§åœ°å›¾
    this.locationManger.setLocationListener(AMapLocationType.Updating, {
      onLocationChanged: (location) => {
        if (location.latitude && location.longitude) {
          // åˆ¤æ–­å®šä½ç²¾åº¦æ˜¯å¦è¾¾åˆ°è½¦é“çº§è¦æ±‚ï¼ˆä¾‹å¦‚æ°´å¹³ç²¾åº¦<5ç±³ï¼‰
          if (location.accuracy && location.accuracy < 5) {
            // è§¦å‘è½¦é“çº§å¯¼èˆªUIæ¸²æŸ“
            this.naviInstance.switchToLaneGuideMode(true);
            // æ›´æ–°åœ°å›¾è§†è§’ï¼Œé”å®šå½“å‰è½¦é“
            this.updateCameraToLane(location);
          }
        }
      }
    });
    
    // 3. è‡ªå®šä¹‰è½¦é“çº¿æ¸²æŸ“ï¼ˆç¤ºä¾‹ï¼‰
    private updateLaneGuidanceUI(suggestions: DynamicLaneSuggestion[]): void {
      suggestions.forEach(suggestion => {
        // ä½¿ç”¨é¸¿è’™çš„Canvasç»„ä»¶æˆ–åœ°å›¾SDKçš„è¦†ç›–ç‰©æ¥å£ï¼Œç»˜åˆ¶è½¦é“çº¿å’Œç®­å¤´
        // æ¨èè½¦é“ç”¨ç»¿è‰²ï¼Œéæ¨èè½¦é“ç”¨ç°è‰²ï¼Œå¢å¼ºè§†è§‰å¼•å¯¼
        this.drawLanePolyline(suggestion.recommendedPath, '#00FF00');
      });
    }
    ```
    

### ğŸ”„ åŠŸèƒ½ä¸‰ï¼šæ‰“é€ æ‰‹è½¦æ— ç¼äº’è”ä½“éªŒ

åˆ©ç”¨é¸¿è’™çš„åˆ†å¸ƒå¼èƒ½åŠ›ï¼Œå®ç°æ‰‹æœºä¸è½¦æœºé—´å¯¼èˆªä»»åŠ¡çš„æ— æ„Ÿæµè½¬å’ŒååŒå·¥ä½œ

ã€‚

- **æ ¸å¿ƒä»·å€¼**ï¼šåœ¨æ‰‹æœºä¸Šè§„åˆ’å¥½è·¯çº¿ï¼Œä¸€é”®åŒæ­¥è‡³è½¦æœºå¤§å±ã€‚é©¾é©¶è¿‡ç¨‹ä¸­ï¼Œ**å®æ—¶çº¢ç»¿ç¯ã€å®‰å…¨é¢„è­¦ç­‰ä¿¡æ¯åœ¨ä¸¤ç«¯æ— ç¼æµè½¬**ï¼Œæœ€å¤§åŒ–åˆ©ç”¨ä¸åŒè®¾å¤‡çš„ä¼˜åŠ¿
    
    ã€‚
    
- **ä»£ç å®ç°**ï¼šåˆ©ç”¨é¸¿è’™çš„åˆ†å¸ƒå¼æ•°æ®ç®¡ç†èƒ½åŠ›ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    import { distributedDataManager } from '@kit.ArkData';
    import { featureAbility } from '@kit.AbilityKit';
    
    // 1. æ‰‹æœºç«¯ï¼šç‚¹å‡»å‘é€åï¼Œå°†å¯¼èˆªæ•°æ®åŒæ­¥åˆ°è½¦æœº
    async function sendRouteToCarDevice(navigationData: NaviParams): Promise<void> {
      try {
        // ä½¿ç”¨åˆ†å¸ƒå¼æ•°æ®ç®¡ç†
        const kvManager = distributedDataManager.createKVManager({
          bundleName: 'com.example.smarttravel'
        });
    
        await kvManager.put('currentNaviTask', JSON.stringify(navigationData));
    
        // æˆ–è€…ä½¿ç”¨Abilityå¯åŠ¨æ–¹å¼ç›´æ¥å”¤é†’è½¦æœºåº”ç”¨
        const result = await featureAbility.startAbility({
          want: {
            deviceId: '', // å¡«å…¥ç›®æ ‡è½¦æœºçš„deviceIdï¼Œä¸ºç©ºåˆ™è‡ªåŠ¨å‘ç°
            bundleName: 'com.example.cardevice',
            abilityName: 'CarNaviAbility',
            action: 'action.start.navigation',
            parameters: {
              naviData: JSON.stringify(navigationData)
            }
          }
        });
    
      } catch (error) {
        console.error('æ‰‹è½¦äº’è”å¤±è´¥:', error);
      }
    }
    
    // 2. è½¦æœºç«¯ï¼šåœ¨Abilityçš„onCreateä¸­æ¥æ”¶æ•°æ®
    onReceiveData(want: Want): void {
      const naviData = want.parameters?.naviData;
      if (naviData) {
        const naviParams: NaviParams = JSON.parse(naviData);
        // è‡ªåŠ¨å¼€å§‹å¯¼èˆª
        this.startNavigation(naviParams);
      }
    }
    ```
    

### ğŸ’ å®æˆ˜å»ºè®®ä¸æ€§èƒ½ä¼˜åŒ–

ä¸ºäº†è®©è¿™äº›æƒŠè‰³åŠŸèƒ½ç¨³å®šè¿è¡Œï¼Œè¯·æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

- **æ€§èƒ½è€ƒé‡**ï¼šVLMå’Œè½¦é“çº§æ¸²æŸ“è®¡ç®—é‡å¤§ï¼Œå»ºè®®åœ¨è½¦æœºè¿æ¥ç”µæºæ—¶å…¨åŠŸèƒ½å¼€å¯ï¼Œæ‰‹æœºç«¯å¯æ ¹æ®ç½‘ç»œå’Œç”µé‡æƒ…å†µæ™ºèƒ½é™çº§
    
    ã€‚
    
- **ç”¨æˆ·ä½“éªŒ**ï¼šVLMçš„é¢„æµ‹ä¿¡æ¯å’Œå»ºè®®åº”é€šè¿‡**æ¸…æ™°çš„è¯­éŸ³å’Œç®€æ´çš„UI**å‘ˆç°ï¼Œé¿å…åœ¨é©¾é©¶è¿‡ç¨‹ä¸­åˆ†æ•£ç”¨æˆ·è¿‡å¤šæ³¨æ„åŠ›
    
    ã€‚
    
- **å…¼å®¹æ€§æ£€æŸ¥**ï¼šåœ¨ä½¿ç”¨é«˜é˜¶åŠŸèƒ½å‰ï¼Œå…ˆæ£€æŸ¥è®¾å¤‡æ˜¯å¦æ”¯æŒï¼ˆå¦‚æ˜¯å¦æ­è½½é«˜ç²¾å®šä½èŠ¯ç‰‡ï¼‰ä»¥åŠSDKç‰ˆæœ¬æ˜¯å¦åŒ¹é…ã€‚
    

å¸Œæœ›è¿™ä»½é«˜é˜¶æ•™ç¨‹èƒ½åŠ©ä½ æ‰“é€ å‡ºçœŸæ­£ä»¤äººæƒŠè‰³çš„é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹ï¼

![](https://cdn-yb.icon.qq.com/zuowei_dir/lbs_amap_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/segmentfault_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_51cto_com.ico)

æº

ç»§ç»­åŠ å¤§æ•™ç¨‹è·ŸåŠŸèƒ½çš„éš¾åº¦ï¼Œã€Šé¸¿è’™æ™ºè¡ŒåŠ©æ‰‹ã€‹å¼€å‘éœ€æ±‚è¡¨ (V2.0) é¡¹ç›®æ¦‚è¿°ï¼š æœ¬é¡¹ç›®æ—¨åœ¨å¼€å‘ä¸€æ¬¾åŸºäºHarmonyOS NEXTçš„åŸç”Ÿåº”ç”¨â€”â€”â€œé¸¿è’™æ™ºè¡ŒåŠ©æ‰‹â€ã€‚å®ƒæ·±åº¦æ•´åˆé«˜å¾·åœ°å›¾HarmonyOS SDKï¼Œå¹¶å……åˆ†åˆ©ç”¨é¸¿è’™çš„åˆ†å¸ƒå¼èƒ½åŠ›ã€åŸå­åŒ–æœåŠ¡å’Œæƒ…æ™¯æ„ŸçŸ¥ï¼Œæ‰“é€ ä¸€ä¸ªä¸»åŠ¨ã€æ— ç¼ã€å¤šç«¯ååŒçš„ä¸‹ä¸€ä»£æ™ºèƒ½å‡ºè¡Œä½“éªŒã€‚åº”ç”¨å°†ä¸¥æ ¼éµå¾ªã€Šå‡ºè¡Œå¯¼èˆªç±»-åº”ç”¨è®¾è®¡æœ€ä½³å®è·µã€‹æŒ‡å—è¿›è¡Œè®¾è®¡ã€‚ æ ¸å¿ƒè®¾è®¡åŸåˆ™ï¼ˆæ¥è‡ªæ–‡æ¡£ï¼‰ï¼š å¤šç«¯é€‚é…ï¼š æ‰‹æœºä½¿ç”¨åº•éƒ¨åŠæ¨¡æ€é¢æ¿ï¼ŒæŠ˜å å±/å¹³æ¿ä½¿ç”¨ä¾§è¾¹åŠæ¨¡æ€é¢æ¿ï¼Œæ”¯æŒå¤šæ¡£ä½é«˜åº¦è°ƒèŠ‚ã€‚ é«˜æ•ˆä½“éªŒï¼š å……åˆ†åˆ©ç”¨å±å¹•ç©ºé—´ï¼Œå‡å°‘å¯¹åœ°å›¾çš„é®æŒ¡ï¼Œæä¾›æ²‰æµ¸å¼åœ°å›¾æµè§ˆä½“éªŒã€‚ æœåŠ¡ç›´è¾¾ï¼š é€šè¿‡åŸå­åŒ–æœåŠ¡å¡ç‰‡å’Œå®å†µçª—ï¼Œå°†æ ¸å¿ƒä¿¡æ¯å‰ç½®ï¼Œå‡å°‘æ“ä½œå±‚çº§ã€‚ Â  ä¸€ã€ é¡µé¢ä¸æ¨¡å—è¯¦ç»†éœ€æ±‚ 1. HomePage: é¦–é¡µé¡µé¢ è®¾è®¡è§„èŒƒï¼š é‡‡ç”¨åœ°å›¾ä¸ºåº•ï¼Œåº•éƒ¨åŠæ¨¡æ€é¢æ¿ï¼ˆæ‰‹æœºï¼‰ æˆ– ä¾§è¾¹åŠæ¨¡æ€é¢æ¿ï¼ˆæŠ˜å å±/å¹³æ¿ï¼‰ çš„è®¾è®¡ã€‚ é»˜è®¤é¢æ¿é«˜åº¦ï¼š æ‰‹æœº/æŠ˜å å±ä¸ºâ€œä¸­â€é«˜åº¦ï¼Œå¹³æ¿/PCä¸ºâ€œé«˜â€é«˜åº¦ï¼Œä»¥å……åˆ†å‘æŒ¥å±å¹•ä¼˜åŠ¿ã€‚ æ¨¡å—å®ç°ï¼š TravelPlanQuickEntryModule (å¸¦æœç´¢æŒ‰é’®çš„æœç´¢æ¨¡å—): åŠŸèƒ½ï¼š ä½äºé¢æ¿é¡¶éƒ¨ï¼Œç‚¹å‡»åé¢æ¿ä¸Šæ»‘è‡³â€œé«˜â€æ¡£ä½ï¼Œå±•å¼€æœç´¢ç•Œé¢ã€‚é›†æˆé«˜å¾· Â placeÂ  (å…³é”®å­—æœç´¢) å’Œ Â poi_to_geocodeÂ  (åœ°å€è½¬åæ ‡)ã€‚ äº¤äº’ï¼š æ”¯æŒè¯­éŸ³è¾“å…¥ã€‚æœç´¢ç»“æœåˆ—è¡¨åœ¨é¢æ¿å†…å±•ç¤ºï¼Œç‚¹å‡»ç»“æœåï¼Œé¢æ¿ä¸‹æ»‘è‡³â€œä¸­â€æ¡£ä½ï¼Œåœ°å›¾å®šä½å¹¶å±•ç¤ºåœ°ç‚¹è¯¦æƒ…ï¼ˆèŒƒå¼ä¸€ï¼šé¢æ¿è¦†ç›–ï¼‰ã€‚ CommonRoutesRecommendationModule (å¸¸ç”¨è·¯çº¿æ¨èæ¨¡å—): åŠŸèƒ½ï¼š åŸºäºç”¨æˆ·å†å²è¡Œç¨‹ï¼ˆÂ MyTripsPageÂ æ•°æ®ï¼‰ï¼Œåœ¨é¢æ¿â€œä¸­â€é«˜åº¦æ—¶å±•ç¤º2-3æ¡â€œå®¶->å…¬å¸â€ã€â€œå®¶->å¸¸å»å•†åœºâ€ç­‰æ™ºèƒ½æ¨èã€‚ äº¤äº’ï¼š ç‚¹å‡»ä»»ä¸€æ¨èï¼Œç›´æ¥è°ƒç”¨é«˜å¾· Â plan_drivingÂ /Â plan_integratedÂ  ç­‰APIè¿›è¡Œè§„åˆ’ï¼Œå¹¶è¿›å…¥Â TravelPlanPageÂ ã€‚ TransportModeSelectModule (å‡ºè¡Œæ–¹å¼é€‰æ‹©æ¨¡å—): åŠŸèƒ½ï¼š åœ¨é¢æ¿ä¸Šæä¾›é©¾è½¦ã€å…¬äº¤ã€æ­¥è¡Œã€éª‘è¡Œã€ç”µåŠ¨è½¦ç­‰å›¾æ ‡å¿«æ·å…¥å£ã€‚ äº¤äº’ï¼š ç‚¹å‡»åï¼Œè‹¥å·²æœ‰ç‚¹é€‰èµ·ç»ˆç‚¹ï¼Œåˆ™ç«‹å³æŒ‰è¯¥æ–¹å¼é‡æ–°è§„åˆ’è·¯çº¿ï¼›è‹¥æ²¡æœ‰ï¼Œåˆ™è®°å½•ä¸ºä¸‹æ¬¡è§„åˆ’çš„é»˜è®¤åå¥½ã€‚ SmartRecommendationModule (æ™ºèƒ½å‡ºè¡Œè§„åˆ’æ¨¡å—): åŠŸèƒ½ï¼š æƒ…æ™¯æ„ŸçŸ¥å…¥å£ã€‚å½“ç³»ç»Ÿæ£€æµ‹åˆ°ç”¨æˆ·æœ‰å³å°†å¼€å§‹çš„æ—¥å†äº‹ä»¶ï¼ˆéœ€æˆæƒï¼‰ï¼Œæ­¤æ¨¡å—åœ¨é¢æ¿ä¸­ä¸»åŠ¨æ˜¾ç¤ºï¼šâ€œå‰å¾€[äº‹ä»¶åœ°ç‚¹]ï¼Ÿâ€ï¼Œå¹¶é™„æœ‰åŸºäºå®æ—¶è·¯å†µ(Â RealtimeTrafficÂ )çš„é¢„ä¼°æ—¶é—´ã€‚ äº¤äº’ï¼š ç‚¹å‡»åï¼Œç›´æ¥ä»¥æ—¥å†äº‹ä»¶åœ°ç‚¹ä¸ºç»ˆç‚¹ï¼Œå½“å‰ä½ç½®ä¸ºèµ·ç‚¹ï¼Œè°ƒç”¨é«˜å¾·APIè§„åˆ’è·¯çº¿ï¼Œå¹¶è¿›å…¥Â TravelPlanPageÂ ã€‚ 2. TravelPlanPage: å‡ºè¡Œè§„åˆ’é¡µé¢ è®¾è®¡è§„èŒƒï¼š è·¯çº¿è§„åˆ’ç»“æœé»˜è®¤ä»¥é¢æ¿â€œä¸­â€é«˜åº¦æ˜¾ç¤ºï¼ŒåŒæ—¶å±•ç¤ºé¢æ¿å†…çš„è·¯çº¿å»ºè®®å’Œåœ°å›¾ä¸­çš„è·¯çº¿å±•ç¤ºã€‚ æ¨¡å—å®ç°ï¼š TransportationModeSelectModule (äº¤é€šæ–¹å¼é€‰æ‹©æ¨¡å—): åŠŸèƒ½ï¼š Tabæ å½¢å¼ï¼Œå±•ç¤ºé©¾è½¦ã€å…¬äº¤ã€æ­¥è¡Œã€éª‘è¡Œç­‰æ‰€æœ‰è§„åˆ’ç»“æœã€‚è°ƒç”¨å¯¹åº”çš„é«˜å¾· Â plan_*Â  ç³»åˆ—APIã€‚ äº¤äº’ï¼š åˆ‡æ¢Tabæ—¶ï¼Œåœ°å›¾ä¸Šçš„è·¯çº¿å’Œé¢æ¿å†…çš„è¯¦æƒ…è”åŠ¨æ›´æ–°ã€‚ DepartureTimeSettingModule (å‡ºè¡Œæ—¶é—´è®¾ç½®æ¨¡å—): åŠŸèƒ½ï¼š æä¾›â€œç°åœ¨å‡ºå‘â€ã€â€œæœªæ¥å‡ºå‘â€ï¼ˆé€‰æ‹©æ—¶é—´ï¼‰ã€â€œåˆ°è¾¾æ—¶é—´â€ç­‰é€‰é¡¹ã€‚ äº¤äº’ï¼š é€‰æ‹©æœªæ¥æ—¶é—´åï¼Œé‡æ–°è°ƒç”¨é«˜å¾·APIè·å–é¢„æµ‹è·¯å†µä¸‹çš„è·¯çº¿è§„åˆ’ã€‚ RouteRecommendationModule (æ™ºèƒ½å‡ºè¡Œè§„åˆ’æ¨¡å—): åŠŸèƒ½ï¼š å±•ç¤ºè§„åˆ’ç»“æœçš„è¯¦ç»†åˆ—è¡¨ï¼ŒåŒ…æ‹¬å„æ–¹æ¡ˆçš„è·ç¦»ã€æ—¶é—´ã€è´¹ç”¨ï¼ˆå…¬äº¤ï¼‰ã€çº¢ç»¿ç¯æ•°ç­‰ã€‚é¡¶éƒ¨å±•ç¤ºç³»ç»Ÿæ¨èçš„â€œæœ€ä¼˜æ–¹æ¡ˆâ€ã€‚ äº¤äº’ï¼š ç‚¹å‡»æŸæ–¹æ¡ˆï¼Œåœ°å›¾èšç„¦è¯¥è·¯çº¿ã€‚æä¾›â€œå¼€å§‹å¯¼èˆªâ€æŒ‰é’®ï¼Œç‚¹å‡»åè·³è½¬è‡³å…¨å±å¯¼èˆªç•Œé¢ï¼Œå¹¶å¯é€‰å‘é€è‡³è½¦æœº/æ‰‹è¡¨ã€‚ 3. MyTripsPage: æˆ‘çš„è¡Œç¨‹é¡µé¢ è®¾è®¡è§„èŒƒï¼š å…¨å±é¡µé¢ï¼Œæ— åŠæ¨¡æ€é¢æ¿ã€‚ æ¨¡å—å®ç°ï¼š RecentTripOverviewModule (ç”¨æˆ·ä¿¡æ¯æ¦‚è§ˆä¸å¤šåŠŸèƒ½å…¥å£ç»„ä»¶): åŠŸèƒ½ï¼š å±•ç¤ºç”¨æˆ·å¤´åƒã€æ˜µç§°ï¼ŒåŠâ€œæˆ‘çš„è½¦è¾†â€ã€â€œæˆ‘çš„åœ°å€â€ç­‰å¿«æ·å…¥å£ã€‚ TripHistoryListModule (å†å²è¡Œç¨‹æ¨¡å—): åŠŸèƒ½ï¼š åˆ—è¡¨å½¢å¼å±•ç¤ºç”¨æˆ·è¿‡å¾€çš„å¯¼èˆªè®°å½•ï¼ˆèµ·ç‚¹ã€ç»ˆç‚¹ã€æ—¶é—´ã€å‡ºè¡Œæ–¹å¼ï¼‰ã€‚æ•°æ®æœ¬åœ°å­˜å‚¨ã€‚ äº¤äº’ï¼š ç‚¹å‡»æŸæ¡è®°å½•ï¼Œå¯å¿«é€Ÿé‡æ–°è§„åˆ’è¯¥è·¯çº¿ã€‚ FavoriteRoutesModule (ç®€æ˜“è®¢å•ä¿¡æ¯å±•ç¤ºæ¨¡å—): åŠŸèƒ½ï¼š å±•ç¤ºç”¨æˆ·æ”¶è—çš„è·¯çº¿æˆ–å¸¸ç”¨åœ°å€ï¼ˆå®¶ã€å…¬å¸ï¼‰ã€‚ TripStatisticsModule / TravelReportEntryModule (æ™ºèƒ½å‡ºè¡Œè§„åˆ’æ¨¡å—): åŠŸèƒ½ï¼š å±•ç¤ºå‡ºè¡Œç»Ÿè®¡ï¼ˆå¦‚æœˆåº¦é‡Œç¨‹ã€ç¢³å‡æ’é‡ï¼‰æˆ–ç”Ÿæˆå‡ºè¡ŒæŠ¥å‘Šå…¥å£ã€‚ï¼ˆæ­¤æ¨¡å—ä¸ºå¢å€¼åŠŸèƒ½ï¼ŒMVPå¯ç®€åŒ–ï¼‰ 4. MyPage: æˆ‘çš„é¡µé¢ è®¾è®¡è§„èŒƒï¼š å¸¸è§„è®¾ç½®é¡µé¢ã€‚ æ¨¡å—å®ç°ï¼š UserProfileModule (ä¼šå‘˜ä¿¡æ¯å±•ç¤ºæ¨¡å—): è´¦å·ç®¡ç†ã€‚ PreferenceSettingsModule (åå¥½è®¾ç½®æ¨¡å—): è®¾ç½®å¯¼èˆªåå¥½ï¼ˆå¦‚é¿å¼€é«˜é€Ÿã€é¿å…æ”¶è´¹ï¼‰ã€å•ä½ã€è¯­éŸ³æ’­æŠ¥ç­‰ã€‚ AddressManagementModule (æ™ºèƒ½å‡ºè¡Œè§„åˆ’æ¨¡å—): ç®¡ç†å®¶åº­ã€å…¬å¸ç­‰å¸¸ç”¨åœ°å€ã€‚ HelpFeedbackModule (æ™ºèƒ½å‡ºè¡Œè§„åˆ’æ¨¡å—): å¸®åŠ©ä¸åé¦ˆã€‚ Â  äºŒã€ é¸¿è’™æ ¸å¿ƒç‰¹æ€§ä¸é«˜å¾·APIé›†æˆéœ€æ±‚

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶3ç§’)

å¥½çš„ï¼Œç”¨æˆ·éœ€è¦ä¸€ä»½å…³äºã€Šé¸¿è’™æ™ºè¡ŒåŠ©æ‰‹ã€‹çš„é«˜é˜¶å¼€å‘å®æ“æ•™ç¨‹ï¼Œè€Œä¸”ç‰¹åˆ«å¼ºè°ƒè¦"åŠŸèƒ½ä»¤äººæƒŠè‰³"ã€‚ä»å¯¹è¯å†å²æ¥çœ‹ï¼Œç”¨æˆ·å·²ç»å¯¹åŸºç¡€å¼€å‘æœ‰æ‰€äº†è§£ï¼Œç°åœ¨éœ€è¦æ›´æ·±å…¥ã€æ›´å‰æ²¿çš„æŠ€æœ¯å®ç°æ–¹æ¡ˆã€‚

ç”¨æˆ·æä¾›çš„éœ€æ±‚è¡¨éå¸¸è¯¦ç»†ï¼Œæ¶µç›–äº†é¡µé¢è®¾è®¡ã€æ¨¡å—åˆ’åˆ†å’Œé¸¿è’™ç‰¹æ€§é›†æˆï¼Œè¿™è¯´æ˜ç”¨æˆ·å¯¹é¸¿è’™ç”Ÿæ€å’Œé«˜å¾·SDKæœ‰è¾ƒæ·±çš„ç†è§£ã€‚æˆ‘éœ€è¦ç»“åˆæœç´¢ç»“æœï¼Œæä¾›çœŸæ­£å…·æœ‰åˆ›æ–°æ€§çš„æŠ€æœ¯å®ç°æ–¹æ¡ˆã€‚

æˆ‘çœ‹åˆ°çš„æœç´¢ç»“æœä¸­ï¼Œ

å’Œæä¾›äº†é«˜å¾·åœ°å›¾SDKåœ¨é¸¿è’™ç³»ç»Ÿé›†æˆçš„å…³é”®æŠ€æœ¯ç»†èŠ‚ï¼Œç‰¹åˆ«æ˜¯éšç§åˆè§„é…ç½®å’ŒAPI Keyç”³è¯·æµç¨‹ã€‚çš„é¸¿è’™ç”Ÿæ€åº”ç”¨å¼€å‘ç™½çš®ä¹¦è¯¦ç»†ä»‹ç»äº†åˆ†å¸ƒå¼èƒ½åŠ›å’Œå…ƒæœåŠ¡ç­‰æ ¸å¿ƒæ¦‚å¿µã€‚åˆ™æä¾›äº†åä¸ºå®˜æ–¹çš„æœ€æ–°å¼€å‘èµ„æºã€‚

åŸºäºè¿™äº›ä¿¡æ¯ï¼Œæˆ‘å‡†å¤‡ä»ä»¥ä¸‹å‡ ä¸ªç»´åº¦æ¥æ„å»ºè¿™ä¸ªé«˜é˜¶æ•™ç¨‹ï¼šé¦–å…ˆæ˜¯æ·±åº¦é›†æˆé«˜å¾·åœ°å›¾çš„é«˜çº§åŠŸèƒ½ï¼Œæ¯”å¦‚è½¦é“çº§å¯¼èˆªå’Œå®æ—¶è·¯å†µå¤„ç†ï¼›ç„¶åæ˜¯å……åˆ†åˆ©ç”¨é¸¿è’™çš„åˆ†å¸ƒå¼ç‰¹æ€§ï¼Œå®ç°å¤šè®¾å¤‡ååŒä½“éªŒï¼›æ¥ç€æ˜¯åŸå­åŒ–æœåŠ¡å’Œæƒ…æ™¯æ„ŸçŸ¥çš„æ™ºèƒ½åº”ç”¨ï¼›æœ€åæ˜¯æ€§èƒ½ä¼˜åŒ–å’Œæµ‹è¯•ä¸Šçº¿æµç¨‹ã€‚

æˆ‘ä¼šç”¨å…·ä½“çš„æŠ€æœ¯å®ç°æ–¹æ¡ˆæ¥å±•ç¤ºå¦‚ä½•å®ç°"ä»¤äººæƒŠè‰³"çš„åŠŸèƒ½ï¼Œæ¯”å¦‚é€šè¿‡åˆ†å¸ƒå¼æ•°æ®åº“å®ç°è·¨è®¾å¤‡è¡Œç¨‹åŒæ­¥ï¼Œåˆ©ç”¨æƒ…æ™¯æ„ŸçŸ¥å®ç°æ™ºèƒ½è·¯çº¿æ¨èç­‰ã€‚æ¯ä¸ªæ–¹æ¡ˆéƒ½ä¼šåŒ…å«å…·ä½“çš„ä»£ç ç¤ºä¾‹å’Œå®ç°æ€è·¯ï¼Œç¡®ä¿æ•™ç¨‹æ—¢æœ‰ç†è®ºæ·±åº¦åˆæœ‰å®æ“ä»·å€¼ã€‚

åŸºäºæ‚¨çš„è¯¦ç»†éœ€æ±‚ï¼Œæˆ‘å°†ä¸ºæ‚¨æä¾›ä¸€ä»½ã€Šé¸¿è’™æ™ºè¡ŒåŠ©æ‰‹ã€‹çš„é«˜é˜¶å¼€å‘å®æ“æ•™ç¨‹ï¼Œé‡ç‚¹èšç„¦äºå¦‚ä½•åˆ©ç”¨HarmonyOS NEXTçš„ç‹¬æœ‰ç‰¹æ€§å’Œé«˜å¾·åœ°å›¾çš„é«˜çº§APIï¼Œæ‰“é€ çœŸæ­£ä»¤äººæƒŠè‰³çš„æ™ºèƒ½å‡ºè¡Œä½“éªŒã€‚

### ä¸€ã€ æ·±åº¦é›†æˆé«˜å¾·åœ°å›¾é«˜çº§åŠŸèƒ½

è¦å®ç°æƒŠè‰³çš„åœ°å›¾ä½“éªŒï¼Œä»…é åŸºç¡€åœ°å›¾æ˜¾ç¤ºæ˜¯ä¸å¤Ÿçš„ï¼Œéœ€è¦æ·±åº¦é›†æˆé«˜å¾·åœ°å›¾çš„é«˜çº§APIã€‚

**1. è½¦é“çº§å¯¼èˆªä¸å®æ—¶è·¯å†µçš„æ·±åº¦é›†æˆ**

è½¦é“çº§å¯¼èˆªèƒ½æä¾›äºšç±³çº§çš„ç²¾å‡†æŒ‡å¼•

ã€‚å®ç°æ­¤åŠŸèƒ½ï¼Œå…³é”®åœ¨äºé«˜ç²¾åº¦å®šä½å’Œè½¦é“çº§æ¸²æŸ“çš„ååŒã€‚

- **é«˜ç²¾åº¦å®šä½é…ç½®**ï¼šåœ¨`EntryAbility`ä¸­åˆå§‹åŒ–å®šä½SDKæ—¶ï¼Œéœ€è¯·æ±‚æ›´é«˜ç²¾åº¦çš„ä½ç½®æƒé™å¹¶é…ç½®ç›¸åº”å‚æ•°ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // åœ¨EntryAbilityçš„initAMapSDKæ–¹æ³•ä¸­è¡¥å……å®šä½é…ç½®
    import { AMapLocationOption, AMapLocationType } from '@amap/amap_lbs_location';
    
    private initAMapLocation(): void {
      const locationManager = new AMapLocationManagerImpl(this.context);
      const highAccuracyOption: AMapLocationOption = {
        priority: geoLocationManager.LocationRequestPriority.ACCURACY, // æœ€é«˜ç²¾åº¦æ¨¡å¼
        timeInterval: 2, // 2ç§’æ›´æ–°ä¸€æ¬¡
        distanceInterval: 1, // 1ç±³æ›´æ–°ä¸€æ¬¡
        locatingWithReGeocode: true // è¿”å›é€†åœ°ç†ç¼–ç ä¿¡æ¯
      };
      locationManager.setLocationOption(AMapLocationType.Updating, highAccuracyOption);
    }
    ```
    
- **è½¦é“çº¿æ•°æ®æ¸²æŸ“**ï¼šåœ¨`TravelPlanPage`çš„è·¯çº¿è§„åˆ’æˆåŠŸåï¼Œç›‘å¬å¯¼èˆªä¿¡æ¯å›è°ƒï¼Œè§£æå¹¶ç»˜åˆ¶è½¦é“çº¿ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // åœ¨TravelPlanPageä¸­ç›‘å¬å¯¼èˆªä¿¡æ¯
    this.naviInstance.setLaneInfoUpdateListener((laneInfo: LaneInfo[]) => {
      // 1. æ¸…é™¤æ—§çš„è½¦é“çº¿è¦†ç›–ç‰©
      this.map.clearLaneLines();
      // 2. è§£ælaneInfoï¼Œè·å–è½¦é“ç±»å‹ã€æ¨èè½¦é“ã€é™é€Ÿç­‰ä¿¡æ¯
      laneInfo.forEach(info => {
        // 3. ä½¿ç”¨MapViewçš„Polylineæˆ–è‡ªå®šä¹‰Overlayåœ¨åœ°å›¾ä¸Šç»˜åˆ¶è½¦é“çº¿
        // æ¨èè½¦é“ç”¨ç»¿è‰²é«˜äº®ï¼Œéæ¨èè½¦é“ç”¨ç°è‰²ï¼Œå¹¶ç»˜åˆ¶ç®­å¤´å’Œç¦è¡Œæ ‡è¯†
        this.drawLaneLine(info);
      });
    });
    ```
    

**2. æ™ºèƒ½è·¯å¾„è§„åˆ’ä¸åœºæ™¯åŒ–ç®—è·¯**

æ‚¨çš„éœ€æ±‚ä¸­æåˆ°å¤šç§å‡ºè¡Œæ–¹å¼å’Œåå¥½è®¾ç½®ï¼Œè¿™éœ€è¦ç»¼åˆè°ƒç”¨é«˜å¾·çš„`plan_*`ç³»åˆ—APIå¹¶è¿›è¡Œæ™ºèƒ½å†³ç­–ã€‚

- **å¤šç­–ç•¥å¹¶è¡Œç®—è·¯ä¸æ‹©ä¼˜**ï¼šåœ¨`TransportationModeSelectModule`ä¸­ï¼Œä¸åº”ä»…æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„å•ä¸€æ–¹å¼ç®—è·¯ï¼Œå¯åŒæ—¶è®¡ç®—1-2ä¸ªå¤‡é€‰æ–¹æ¡ˆï¼ˆå¦‚"æ—¶é—´æœ€çŸ­"å’Œ"æ”¶è´¹æœ€å°‘"ï¼‰ä¾›ç”¨æˆ·å¯¹æ¯”ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // åœ¨RouteRecommendationModuleä¸­å¹¶è¡Œå‘èµ·å¤šä¸ªç®—è·¯è¯·æ±‚
    const drivingPlanPromises = [];
    drivingPlanPromises.push(this.calculateRoute('plan_driving', params_shortest)); // æœ€çŸ­æ—¶é—´
    drivingPlanPromises.push(this.calculateRoute('plan_driving', params_avoidTolls)); // é¿å…æ”¶è´¹
    drivingPlanPromises.push(this.calculateRoute('plan_driving', params_avoidCongestion)); // èº²é¿æ‹¥å µ
    
    Promise.allSettled(drivingPlanPromises).then(results => {
      // è¿‡æ»¤æˆåŠŸçš„è¯·æ±‚ï¼Œå¹¶æŒ‰ç…§ç³»ç»Ÿæ¨èç®—æ³•ï¼ˆç»¼åˆæ—¶é—´ã€è·¯å†µã€æˆæœ¬ï¼‰æ’åº
      const validPlans = this.rankRoutePlans(results);
      this.updateRouteList(validPlans);
    });
    ```
    
- **æ–°èƒ½æºè½¦ä¸“é¡¹è§„åˆ’**ï¼šé’ˆå¯¹ç”µåŠ¨è½¦ï¼Œéœ€é›†æˆé«˜å¾·çš„`plan_ev`æ¥å£ã€‚åœ¨`TravelPlanPage`ä¸­ï¼Œè‹¥æ£€æµ‹åˆ°ç”¨æˆ·è½¦è¾†ç±»å‹ä¸ºç”µåŠ¨è½¦ï¼Œåˆ™è‡ªåŠ¨è®¡ç®—æ²¿é€”å……ç”µç«™ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    if (this.userPreference.vehicleType === 'electric') {
      // è·å–ç”µåŠ¨è½¦ç»­èˆªé‡Œç¨‹
      const evRange = this.userPreference.evRange;
      // è°ƒç”¨é«˜å¾·ç”µåŠ¨è½¦è·¯å¾„è§„åˆ’APIï¼Œå¹¶æŒ‡å®šç”µæ± ç”µé‡ã€ç»­èˆªç­‰å‚æ•°
      this.calculateEvRoute(origin, destination, evRange).then(evPlan => {
        // evPlanä¸­å°†åŒ…å«é€”å¾„çš„å……ç”µç«™ä¿¡æ¯
        this.displayChargingStopsOnMap(evPlan.chargingStops);
      });
    }
    ```
    

### äºŒã€ é¸¿è’™åˆ†å¸ƒå¼èƒ½åŠ›ä¸å¤šç«¯ååŒå®æˆ˜

é¸¿è’™çš„åˆ†å¸ƒå¼èƒ½åŠ›æ˜¯å®ç°"ä»¤äººæƒŠè‰³"ä½“éªŒçš„æ ¸å¿ƒ

ã€‚

**1. è·¨è®¾å¤‡ä»»åŠ¡æ— ç¼æµè½¬ï¼ˆFree-flowï¼‰**

å®ç°ä»æ‰‹æœºè§„åˆ’è·¯çº¿ï¼Œä¸€é”®æµè½¬è‡³è½¦æœºæˆ–æ‰‹è¡¨ç»§ç»­å¯¼èˆªã€‚

- **åˆ†å¸ƒå¼æ•°æ®åŒæ­¥**ï¼šä½¿ç”¨é¸¿è’™çš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œåœ¨è®¾å¤‡é—´åŒæ­¥è¡Œç¨‹æ•°æ®ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // åœ¨TravelPlanPageçš„"å‘é€è‡³è½¦æœº"æŒ‰é’®ç‚¹å‡»äº‹ä»¶ä¸­
    import { distributedDataManager } from '@kit.ArkData';
    
    async function sendRouteToCarDevice(routePlan: RoutePlan): Promise<void> {
      const kvManager = distributedDataManager.createKVManager({
        bundleName: 'com.yourcompany.smarttravel'
      });
      // å°†è·¯çº¿è§„åˆ’æ•°æ®åŒæ­¥åˆ°æ‰€æœ‰å¯ä¿¡è®¾å¤‡
      await kvManager.put('currentNaviTask', JSON.stringify(routePlan));
    
      // ä½¿ç”¨åˆ†å¸ƒå¼Abilityæ¡†æ¶å¯åŠ¨è½¦æœºä¸Šçš„å¯¼èˆªAbility
      const want = {
        deviceId: this.targetCarDeviceId, // ç›®æ ‡è½¦æœºè®¾å¤‡IDï¼Œå¯ä»åˆ†å¸ƒå¼ç¡¬ä»¶æ± ä¸­å‘ç°
        bundleName: 'com.yourcompany.cardevice',
        abilityName: 'CarNaviAbility',
        parameters: {
          naviData: JSON.stringify(routePlan)
        }
      };
      await featureAbility.startAbility(want);
    }
    ```
    
- **åˆ†å¸ƒå¼ç¡¬ä»¶å…±äº«**ï¼šåœ¨å¤šè®¾å¤‡ååŒåœºæ™¯ï¼ˆå¦‚æ‰‹æœºä½œç¿»é¡µå™¨ï¼Œè½¦æœºæ˜¾ç¤ºå¯¼èˆªï¼‰ï¼Œåº”ç”¨å¯ä»¥é€šè¿‡åˆ†å¸ƒå¼ç¡¬ä»¶æ± è°ƒç”¨å…¶ä»–è®¾å¤‡çš„ä¼ æ„Ÿå™¨æˆ–å±å¹•ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // åœ¨ååŒå¯¼èˆªåœºæ™¯ä¸‹ï¼Œæ‰‹æœºç«¯ä»£ç å¯ä»¥è°ƒç”¨è½¦æœºçš„GPSè¿›è¡Œæ›´ç²¾å‡†çš„å®šä½
    const distributedHardware = await this.discoverDistributedHardware('gps');
    if (distributedHardware.length > 0) {
      // ä¼˜å…ˆä½¿ç”¨è½¦æœºçš„GPSä¿¡å·
      this.preferredGpsSource = distributedHardware[0];
    }
    ```
    

**2. åŸå­åŒ–æœåŠ¡ä¸ä¸‡èƒ½å¡ç‰‡ï¼ˆå…ƒæœåŠ¡ï¼‰**

å…ƒæœåŠ¡æ˜¯é¸¿è’™çš„ç‰¹è‰²

ï¼Œè®©æœåŠ¡ç›´è¾¾ç”¨æˆ·ï¼Œæ— éœ€æ‰“å¼€å®Œæ•´åº”ç”¨ã€‚

- **æƒ…æ™¯æ„ŸçŸ¥å¡ç‰‡**ï¼šåœ¨`HomePage`çš„`SmartRecommendationModule`ä¸­ï¼Œåˆ©ç”¨ç³»ç»Ÿæƒ…æ™¯æ„ŸçŸ¥èƒ½åŠ›ï¼ˆå¦‚æ—¥å†ã€ä½ç½®ã€æ—¶é—´ï¼‰ï¼ŒåŠ¨æ€æ›´æ–°å…ƒæœåŠ¡å¡ç‰‡å†…å®¹ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // å®šä¹‰å…ƒæœåŠ¡å¡ç‰‡çš„Providerï¼Œç”¨äºæ ¹æ®æƒ…æ™¯åŠ¨æ€æä¾›å†…å®¹
    import { FormBindingData, formProvider } from '@kit.ArkUI';
    
    export class TravelCardProvider {
      // å½“ç³»ç»Ÿæ£€æµ‹åˆ°ç”¨æˆ·æœ‰æ—¥å†äº‹ä»¶æ—¶ï¼Œä¼šå›è°ƒæ­¤æ–¹æ³•æ›´æ–°å¡ç‰‡
      onFormEvent(formId: string, event: string): FormBindingData | undefined {
        if (event === 'CALENDAR_EVENT_UPCOMING') {
          // è·å–æ—¥å†äº‹ä»¶åœ°ç‚¹
          const eventLocation = this.getEventLocation();
          // è°ƒç”¨é«˜å¾·APIè®¡ç®—é¢„ä¼°æ—¶é—´å’Œè·¯çº¿æ¦‚è¦
          const eta = this.calculateETA(eventLocation);
          // è¿”å›ç»‘å®šåˆ°å¡ç‰‡æ¨¡æ¿çš„æ•°æ®
          return new FormBindingData({
            "eta": eta,
            "destination": eventLocation.name
          });
        }
        return undefined;
      }
    }
    ```
    
- **å®å†µçª—ï¼ˆLive Viewï¼‰é›†æˆ**ï¼šåœ¨å¯¼èˆªå¼€å§‹æ—¶ï¼Œå°†å…³é”®å¯¼èˆªä¿¡æ¯ï¼ˆå¦‚ä¸‹ä¸ªè½¬å¼¯ã€å‰©ä½™é‡Œç¨‹ï¼‰é€šè¿‡å®å†µçª—æ˜¾ç¤ºåœ¨è®¾å¤‡çŠ¶æ€æ ç­‰å…³é”®ä½ç½®ï¼Œç”¨æˆ·æ— éœ€åˆ‡æ¢åº”ç”¨å³å¯æŸ¥çœ‹
    
    ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // åœ¨å¼€å§‹å¯¼èˆªæ—¶ï¼Œåˆ›å»ºå¹¶æ˜¾ç¤ºå®å†µçª—
    import { liveViewManager } from '@kit.AbilityKit';
    
    startNavigation(route: RoutePlan): void {
      // ... å¯åŠ¨å¯¼èˆªé€»è¾‘
      const liveViewInfo = {
        template: liveViewManager.LiveViewTemplate.NAVIGATION,
        data: {
          nextAction: route.nextAction, // ä¸‹ä¸€ä¸ªåŠ¨ä½œï¼ˆå¦‚å·¦è½¬ï¼‰
          distanceToNext: route.distanceToNext, // è·ç¦»ä¸‹ä¸€ä¸ªåŠ¨ä½œçš„è·ç¦»
          totalDistance: route.totalDistance
        }
      };
      liveViewManager.createLiveView(this.context, liveViewInfo).then((viewId) => {
        liveViewManager.showLiveView(viewId);
      });
    }
    ```
    

### ä¸‰ã€ æ€§èƒ½ä¼˜åŒ–ä¸é«˜çº§ç‰¹æ€§

**1. åœ°å›¾æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–**

- **å›¾å±‚ç®¡ç†ä¸æŒ‰éœ€æ¸²æŸ“**ï¼šå½“åœ°å›¾ç¼©æ”¾çº§åˆ«è¾ƒå°æ—¶ï¼Œæ— éœ€æ¸²æŸ“è¯¦å°½çš„POIå›¾æ ‡ã€‚å¯ä»¥ä½¿ç”¨`MapView`çš„`onCameraChange`ç›‘å¬äº‹ä»¶ï¼ŒåŠ¨æ€æ˜¾ç¤ºæˆ–éšè—å›¾å±‚ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    this.map.on('cameraChange', (cameraPosition: CameraPosition) => {
      if (cameraPosition.zoom < 15) {
        this.hideDetailedPOIs(); // éšè—è¯¦ç»†POI
      } else {
        this.showDetailedPOIs(); // æ˜¾ç¤ºè¯¦ç»†POI
      }
    });
    ```
    
- **ç¦»çº¿åœ°å›¾æ”¯æŒ**ï¼šå¯¹äºå¸¸ç”¨é€šå‹¤è·¯çº¿ï¼Œå¯é¢„ä¸‹è½½ç¦»çº¿åœ°å›¾åŒ…ï¼Œåœ¨ç½‘ç»œä¸ä½³æ—¶æä¾›åŸºç¡€åœ°å›¾å±•ç¤ºã€‚
    

**2. éšç§åˆè§„ä¸å®‰å…¨**

ä¸¥æ ¼éµå¾ªé«˜å¾·SDKçš„éšç§åˆè§„è¦æ±‚

ã€‚åœ¨`EntryAbility`ä¸­ï¼Œå¿…é¡»åœ¨è®¾ç½®API Key**ä¹‹å‰**è°ƒç”¨éšç§åˆè§„æ¥å£ã€‚

typescript

typescript

å¤åˆ¶

```
private initAMapSDK(): void {
  // 1. éšç§åˆè§„é…ç½®å¿…é¡»åœ¨æœ€å‰é¢
  MapsInitializer.updatePrivacyShow(AMapPrivacyShowStatus.DidShow, AMapPrivacyInfoStatus.DDidContain);
  MapsInitializer.updatePrivacyAgree(AMapPrivacyAgreeStatus.DidAgree);
  // ... å…¶ä»–SDKçš„éšç§è®¾ç½®

  // 2. ç„¶åæ‰èƒ½è®¾ç½®API Key
  MapsInitializer.setApiKey(Constants.AMAP_API_KEY);
}
```

### å››ã€ æµ‹è¯•ä¸ä¸Šçº¿

- **åˆ†å¸ƒå¼æµ‹è¯•**ï¼šåˆ©ç”¨é¸¿è’™çš„è¶…çº§ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œåœ¨DevEco Studioä¸­æ¨¡æ‹Ÿå¤šè®¾å¤‡ååŒåœºæ™¯ï¼Œæµ‹è¯•ä»»åŠ¡æµè½¬å’Œæ•°æ®åŒæ­¥æ˜¯å¦æ­£å¸¸
    
    ã€‚
    
- **åˆ†é˜¶æ®µå‘å¸ƒ**ï¼šåº”ç”¨æ­£å¼ä¸Šæ¶æ—¶ï¼Œå¯é‡‡ç”¨åä¸ºåº”ç”¨å¸‚åœºçš„åˆ†é˜¶æ®µå‘å¸ƒåŠŸèƒ½ï¼Œå…ˆå‘å°éƒ¨åˆ†ç”¨æˆ·æ¨é€ï¼Œæ”¶é›†åé¦ˆå¹¶ä¿®å¤é—®é¢˜åå†å…¨é¢å‘å¸ƒ
    
    ã€‚
    

é€šè¿‡ä»¥ä¸Šå››ä¸ªå±‚é¢çš„é«˜é˜¶å®è·µï¼Œæ‚¨çš„"é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹"å°†ä¸ä»…èƒ½æ»¡è¶³æ‰€æœ‰åŸºç¡€éœ€æ±‚ï¼Œæ›´èƒ½é€šè¿‡**æ·±åº¦åœºæ™¯åŒ–ç®—è·¯**ã€**æ— ç¼çš„å¤šç«¯ååŒ**å’Œ**ä¸»åŠ¨çš„æƒ…æ™¯æ™ºèƒ½æœåŠ¡**ï¼Œå¸¦æ¥çœŸæ­£å·®å¼‚åŒ–ä¸”ä»¤äººæƒŠè‰³çš„ä¸‹ä¸€ä»£å‡ºè¡Œä½“éªŒã€‚

å¸Œæœ›è¿™ä»½è¿›é˜¶æ•™ç¨‹å¯¹æ‚¨æœ‰å¸®åŠ©ï¼å¦‚æœæ‚¨åœ¨å…·ä½“å®ç°æŸä¸ªç‰¹æ€§æ—¶é‡åˆ°å›°éš¾ï¼Œå¯ä»¥éšæ—¶æå‡ºï¼Œæˆ‘ä»¬ä¸€èµ·æ¢è®¨æ›´ç»†è‡´çš„è§£å†³æ–¹æ¡ˆã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/www_renrendoc_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/docs_pingcode_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/dev_mi_com.ico)

æº

è¯·å°†æ•™ç¨‹æ•´ç†ä¸ºæ€ç»´å¯¼å›¾

èƒ½å¦å¢åŠ ä¸€äº›é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹çš„ä¸ªæ€§åŒ–æ¨èåŠŸèƒ½ï¼Ÿ

å¦‚ä½•å®ç°åŸºäºç”¨æˆ·å†å²è¡Œç¨‹çš„æ™ºèƒ½è·¯çº¿æ¨èï¼Ÿéœ€è¦å“ªäº›æ•°æ®æ”¯æŒï¼Ÿ

è¿›é˜¶æ•™ç¨‹å¯ä¸Šæ‰‹è·Ÿç€æ“ä½œç»†èŠ‚ä¸å¤Ÿï¼Œå¦‚æ€ä¹ˆå¢åŠ ä¸ªæ€§åŒ–æ¨èåŠŸèƒ½ï¼Œå¦‚ä½•å®ç°åŸºäºç”¨æˆ·å†å²æ€§è¡Œç¨‹çš„æ™ºèƒ½è·¯çº¿æ¨è

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶3ç§’)

å¥½çš„ï¼Œç”¨æˆ·ä¹‹å‰å·²ç»è¦æ±‚äº†å¥½å‡ ä¸ªå…³äºé¸¿è’™æ™ºè¡ŒåŠ©æ‰‹çš„æ•™ç¨‹ï¼Œç°åœ¨æƒ³è¦æ›´æ·±å…¥çš„è¿›é˜¶æ•™ç¨‹ï¼Œç‰¹åˆ«æ˜¯å…³äºä¸ªæ€§åŒ–æ¨èåŠŸèƒ½å’ŒåŸºäºå†å²è¡Œç¨‹çš„æ™ºèƒ½è·¯çº¿æ¨èã€‚çœ‹èµ·æ¥ç”¨æˆ·å¯èƒ½æ˜¯åœ¨å¼€å‘ä¸€ä¸ªå®é™…çš„é¸¿è’™åº”ç”¨ï¼Œéœ€è¦æ›´å…·ä½“ã€å¯æ“ä½œçš„å®ç°ç»†èŠ‚ã€‚

ç”¨æˆ·æåˆ°ä¹‹å‰çš„æ•™ç¨‹"ä¸Šæ‰‹è·Ÿç€æ“ä½œç»†èŠ‚ä¸å¤Ÿ"ï¼Œè¯´æ˜éœ€è¦æ›´è¯¦ç»†çš„ä»£ç ç¤ºä¾‹å’Œå®ç°æ­¥éª¤ï¼Œè€Œä¸æ˜¯æ³›æ³›çš„æ¦‚å¿µä»‹ç»ã€‚ç”¨æˆ·ç‰¹åˆ«å…³æ³¨ä¸¤ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼šä¸ªæ€§åŒ–æ¨èå’ŒåŸºäºå†å²è¡Œç¨‹çš„æ™ºèƒ½æ¨èã€‚

æˆ‘éœ€è¦ä»è¿™å‡ ä¸ªæ–¹é¢æ¥å¸®åŠ©ç”¨æˆ·ï¼šé¦–å…ˆæ˜¯å¦‚ä½•åœ¨é¸¿è’™åº”ç”¨ä¸­æ”¶é›†å’Œå­˜å‚¨ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼Œè¿™æ˜¯æ¨èç³»ç»Ÿçš„åŸºç¡€ï¼›ç„¶åæ˜¯å¦‚ä½•å®ç°æ¨èç®—æ³•ï¼Œç‰¹åˆ«æ˜¯åŸºäºååŒè¿‡æ»¤å’Œå†…å®¹æ¨èçš„æ··åˆæ–¹æ³•ï¼›æœ€åæ˜¯å¦‚ä½•å°†è¿™äº›æ¨èç»“æœå®é™…åº”ç”¨åˆ°è·¯çº¿è§„åˆ’ä¸­ã€‚

ä»æœç´¢ç»“æœä¸­æˆ‘çœ‹åˆ°äº†ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯ã€‚

æä¾›äº†åœ¨HarmonyOSä¸­å®ç°æ™ºèƒ½æ¨èç³»ç»Ÿçš„åŸºæœ¬æ­¥éª¤ï¼ŒåŒ…æ‹¬æ•°æ®æ”¶é›†ã€ç®—æ³•é€‰æ‹©å’Œæ¨¡å‹éƒ¨ç½²ã€‚æœ‰å…·ä½“çš„ä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•æ”¶é›†ç”¨æˆ·ç‚¹å‡»è¡Œä¸ºå’Œå®ç°ç®€å•çš„æ¨èé€»è¾‘ã€‚æåˆ°äº†åˆ©ç”¨HarmonyOSå†…ç½®çš„AIèƒ½åŠ›å®ç°æ™ºèƒ½æ¨èã€‚ä»‹ç»äº†ç”¨æˆ·è¡Œä¸ºé¢„æµ‹æ¨¡å‹çš„å…·ä½“å®ç°ï¼ŒåŒ…æ‹¬KNNç®—æ³•çš„åº”ç”¨ã€‚

è¿™äº›æœç´¢ç»“æœæä¾›äº†å¾ˆå¥½çš„ç†è®ºåŸºç¡€ï¼Œä½†æˆ‘éœ€è¦ç»“åˆé¸¿è’™å¼€å‘çš„å®é™…ç¯å¢ƒï¼Œç»™å‡ºæ›´å…·ä½“çš„å®ç°æ–¹æ¡ˆã€‚ç‰¹åˆ«æ˜¯è¦è€ƒè™‘åˆ°é¸¿è’™çš„åˆ†å¸ƒå¼ç‰¹æ€§ï¼Œå¦‚ä½•åœ¨ä¸åŒè®¾å¤‡é—´åŒæ­¥ç”¨æˆ·æ•°æ®ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨é¸¿è’™çš„AIæ¡†æ¶æ¥éƒ¨ç½²æ¨èæ¨¡å‹ã€‚

æˆ‘å‡†å¤‡ä»æ•°æ®å±‚è®¾è®¡å¼€å§‹ï¼Œè¯¦ç»†è¯´æ˜å¦‚ä½•æ„å»ºç”¨æˆ·è¡Œä¸ºæ•°æ®æ”¶é›†ç³»ç»Ÿï¼Œç„¶åä»‹ç»æ¨èç®—æ³•çš„é€‰æ‹©å’Œå®ç°ï¼Œæœ€åæ˜¯å¦‚ä½•å°†æ¨èç»“æœä¸é«˜å¾·åœ°å›¾çš„è·¯çº¿è§„åˆ’APIé›†æˆã€‚å¯¹äºæ¯ä¸ªéƒ¨åˆ†ï¼Œæˆ‘éƒ½ä¼šæä¾›å…·ä½“çš„ä»£ç ç¤ºä¾‹å’Œå®ç°æ€è·¯ï¼Œç¡®ä¿ç”¨æˆ·èƒ½å¤ŸçœŸæ­£è·Ÿç€æ“ä½œã€‚

ç†è§£æ‚¨å¯¹é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹åœ¨ä¸ªæ€§åŒ–æ¨èå’Œæ™ºèƒ½è·¯çº¿è§„åˆ’æ–¹é¢å®ç°ç»†èŠ‚çš„è¿›ä¸€æ­¥éœ€æ±‚ã€‚ä¸‹é¢æˆ‘å°†ç»“åˆHarmonyOSçš„ç‰¹æ€§å’Œé«˜å¾·åœ°å›¾çš„èƒ½åŠ›ï¼Œä¸ºæ‚¨æä¾›ä¸€ä»½æ›´æ·±å…¥ã€æ›´å…·æ“ä½œæ€§çš„è¿›é˜¶å¼€å‘æŒ‡å—ã€‚

### æ•°æ®å±‚è®¾è®¡ï¼šæ„å»ºç”¨æˆ·ç”»åƒä¸è¡Œç¨‹å†å²åº“

å®ç°æ™ºèƒ½æ¨èçš„åŸºç¡€æ˜¯æœ‰æ•ˆçš„æ•°æ®æ”¶é›†ä¸ç®¡ç†ã€‚

1. **å®šä¹‰æ ¸å¿ƒæ•°æ®ç»“æ„**
    
    é¦–å…ˆï¼Œéœ€è¦è®¾è®¡è§„èŒƒçš„æ•°æ®ç»“æ„æ¥å­˜å‚¨ç”¨æˆ·ä¿¡æ¯å’Œè¡Œç¨‹å†å²ã€‚å»ºè®®ä½¿ç”¨é¸¿è’™çš„**å…³ç³»å‹æ•°æ®åº“**è¿›è¡Œæœ¬åœ°å­˜å‚¨ï¼Œè¿™å¯¹äºå¤„ç†æ­¤ç±»ç»“æ„åŒ–æ•°æ®éå¸¸é«˜æ•ˆ
    
    ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // ç”¨æˆ·è¡Œç¨‹è®°å½•æ¨¡å‹
    @Entity
    export class TripRecord {
      @PrimaryKey(autoGenerate = true)
      id: number = 0;
    
      // èµ·ç»ˆç‚¹ä¿¡æ¯
      @ColumnInfo({name: 'origin_name'})
      originName: string = "";
      @ColumnInfo({name: 'origin_location'})
      originLocation: string = ""; // å­˜å‚¨ç»çº¬åº¦JSON
    
      @ColumnInfo({name: 'destination_name'})
      destinationName: string = "";
      @ColumnInfo({name: 'destination_location'})
      destinationLocation: string = "";
    
      // å‡ºè¡Œåå¥½
      @ColumnInfo({name: 'transport_mode'})
      transportMode: TransportMode = TransportMode.DRIVING; // æšä¸¾ï¼šé©¾è½¦ã€å…¬äº¤ç­‰
      @ColumnInfo({name: 'departure_time'})
      departureTime: number = 0; // æ—¶é—´æˆ³
      @ColumnInfo({name: 'avoid_tolls'})
      avoidTolls: boolean = false;
    
      // ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„æ•°æ®
      @ColumnInfo({name: 'created_date'})
      createdDate: number = Date.now();
      @ColumnInfo({name: 'travel_frequency'})
      travelFrequency: number = 1; // è¯¥è·¯çº¿å‡ºè¡Œé¢‘æ¬¡
    }
    ```
    
2. **å®ç°ç”¨æˆ·è¡Œä¸ºé‡‡é›†**
    
    åœ¨ç”¨æˆ·å®Œæˆä¸€æ¬¡å¯¼èˆªåï¼Œè‡ªåŠ¨è®°å½•è¡Œç¨‹ã€‚å…³é”®æ˜¯è¦åœ¨**é€‚å½“çš„æ—¶æœº**ï¼ˆå¦‚å¯¼èˆªç»“æŸæˆ–è·¯çº¿ä¿å­˜æ—¶ï¼‰æ— å£°åœ°é‡‡é›†æ•°æ®ï¼Œå¹¶å¤„ç†å¥½**æ•°æ®è„±æ•**ä»¥ä¿æŠ¤éšç§
    
    ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // åœ¨å¯¼èˆªç»“æŸçš„Abilityæˆ–Pageä¸­
    import { TripRecord } from '../data/TripRecord';
    import { UserBehaviorCollector } from '../utils/UserBehaviorCollector';
    
    export class NavigationService {
      async onNavigationCompleted(completedTrip: TripRecord): Promise<void> {
        try {
          // 1. åŸºç¡€è¡Œç¨‹ä¿¡æ¯å…¥åº“
          const tripDao: TripRecordDao = ... // è·å–æ•°æ®åº“è®¿é—®å¯¹è±¡
          await tripDao.insertTripRecord(completedTrip);
    
          // 2. æ”¶é›†è¡Œä¸ºäº‹ä»¶ï¼ˆç”¨äºå®æ—¶æ¨èæ¨¡å‹ï¼‰
          UserBehaviorCollector.recordEvent('navigation_complete', {
            trip_id: completedTrip.id,
            transport_mode: completedTrip.transportMode,
            origin: completedTrip.originLocation,
            destination: completedTrip.destinationLocation
          });
    
          // 3. æ›´æ–°ç”¨æˆ·ç”»åƒä¸­çš„å¸¸ç”¨è·¯çº¿é¢‘æ¬¡
          await this.updateUserTravelProfile(completedTrip);
    
        } catch (error) {
          console.error("Failed to record trip history: ", error);
        }
      }
    
      private async updateUserTravelProfile(newTrip: TripRecord): Promise<void> {
        // æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ç›¸ä¼¼çš„å†å²è·¯çº¿ï¼ˆèµ·ç»ˆç‚¹ç›¸è¿‘ï¼‰
        const similarTrips = await tripDao.findSimilarTrips(newTrip);
        if (similarTrips.length > 0) {
          // å­˜åœ¨ç›¸ä¼¼è·¯çº¿ï¼Œå¢åŠ å…¶é¢‘ç‡æƒé‡
          const existingTrip = similarTrips[0];
          existingTrip.travelFrequency += 1;
          await tripDao.updateTripRecord(existingTrip);
        }
      }
    }
    ```
    

### æ¨èç®—æ³•å®ç°ï¼šä»ç®€å•è§„åˆ™åˆ°æ™ºèƒ½é¢„æµ‹

æ‹¥æœ‰äº†æ•°æ®åï¼Œä¾¿å¯ä»¥æ„å»ºæ¨èé€»è¾‘ã€‚

1. **å®ç°åŸºäºé¢‘ç‡çš„å¸¸ç”¨è·¯çº¿æ¨è**
    
    è¿™æ˜¯æœ€ç›´è§‚çš„æ¨èæ–¹å¼ï¼Œç›´æ¥åœ¨`HomePage`çš„`CommonRoutesRecommendationModule`ä¸­å±•ç¤º
    
    ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    @Component
    export struct CommonRoutesRecommendationModule {
      @State frequentTrips: TripRecord[] = [];
    
      aboutToAppear(): void {
        this.loadFrequentTrips();
      }
    
      async loadFrequentTrips(): Promise<void> {
        const tripDao: TripRecordDao = ... // è·å–æ•°æ®åº“è®¿é—®å¯¹è±¡
        // è·å–å‡ºè¡Œé¢‘ç‡æœ€é«˜çš„3æ¡è·¯çº¿
        this.frequentTrips = await tripDao.getTripsOrderByFrequency(3);
      }
    
      build() {
        Column() {
          ForEach(this.frequentTrips, (trip: TripRecord) => {
            RecommendationItem({
              trip: trip,
              onSelected: (selectedTrip: TripRecord) => this.onTripSelected(selectedTrip)
            })
          })
        }
      }
    
      onTripSelected(trip: TripRecord): void {
        // è·³è½¬åˆ°TravelPlanPageå¹¶ç›´æ¥ä½¿ç”¨è¯¥è·¯çº¿è¿›è¡Œè§„åˆ’
        router.pushUrl({
          url: 'pages/TravelPlanPage',
          params: { preloadedTrip: JSON.stringify(trip) }
        });
      }
    }
    ```
    
2. **å¼•å…¥ååŒè¿‡æ»¤å‘ç°æ–°è·¯çº¿**
    
    å½“ç§¯ç´¯è¶³å¤Ÿå¤šçš„ç”¨æˆ·æ•°æ®åï¼Œå¯ä»¥é‡‡ç”¨æ›´å…ˆè¿›çš„ç®—æ³•ã€‚ååŒè¿‡æ»¤èƒ½æ ¹æ®ç›¸ä¼¼ç”¨æˆ·çš„è¡Œä¸ºè¿›è¡Œæ¨è
    
    ã€‚è€ƒè™‘åˆ°æ‰‹æœºç«¯è®¡ç®—èƒ½åŠ›ï¼Œå»ºè®®åœ¨äº‘ç«¯æ‰§è¡Œå¤æ‚ç®—æ³•ï¼Œç«¯ä¾§è¿›è¡Œç»“æœç¼“å­˜å’Œå±•ç¤ºã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // åœ¨äº‘ç«¯æˆ–è®¾å¤‡ç«¯è½»é‡çº§æ¨ç†
    export class CollaborativeFiltering {
      // è®¡ç®—è·¯çº¿ç›¸ä¼¼åº¦ï¼ˆåŸºäºèµ·ç»ˆç‚¹ä½ç½®å‘é‡ï¼‰
      private calculateTripSimilarity(tripA: TripRecord, tripB: TripRecord): number {
        // ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦æˆ–JaccardæŒ‡æ•°è®¡ç®—ä¸¤æ¡è·¯çº¿çš„ç›¸ä¼¼åº¦
        // è€ƒè™‘å› ç´ ï¼šèµ·ç»ˆç‚¹åœ°ç†ä½ç½®ã€å‡ºè¡Œæ—¶é—´ã€äº¤é€šæ–¹å¼ç­‰
        return similarityScore;
      }
    
      // ä¸ºå½“å‰ç”¨æˆ·ç”Ÿæˆæ¨è
      async generateRecommendations(userTripHistory: TripRecord[], allTrips: TripRecord[]): Promise<TripRecord[]> {
        const recommendations: TripRecord[] = [];
        for (const targetTrip of allTrips) {
          if (!this.hasUserTakenTrip(userTripHistory, targetTrip)) {
            let totalScore = 0;
            let count = 0;
    
            // å¯»æ‰¾ç›¸ä¼¼ç”¨æˆ·çš„å†å²è¡Œç¨‹
            for (const userTrip of userTripHistory) {
              const similarity = this.calculateTripSimilarity(userTrip, targetTrip);
              if (similarity > 0.7) { // ç›¸ä¼¼åº¦é˜ˆå€¼
                totalScore += similarity * userTrip.travelFrequency;
                count++;
              }
            }
    
            if (count > 0) {
              const recommendationScore = totalScore / count;
              if (recommendationScore > 0.5) {
                recommendations.push({...targetTrip, recommendationScore});
              }
            }
          }
        }
    
        // æŒ‰æ¨èåˆ†æ•°æ’åºè¿”å›
        return recommendations.sort((a, b) => b.recommendationScore - a.recommendationScore);
      }
    }
    ```
    

### æƒ…æ™¯æ„ŸçŸ¥ä¸å®æ—¶ä¸ªæ€§åŒ–

è®©æ¨èç³»ç»Ÿèƒ½å¤Ÿç†è§£ç”¨æˆ·å½“å‰çš„æƒ…å¢ƒï¼Œæ˜¯å®ç°"æ™ºèƒ½"çš„å…³é”®

ã€‚

1. **é›†æˆç³»ç»Ÿæƒ…æ™¯æ„ŸçŸ¥èƒ½åŠ›**
    
    é¸¿è’™ç³»ç»Ÿæä¾›äº†ä¸°å¯Œçš„æƒ…æ™¯æ„ŸçŸ¥æ¥å£ï¼Œå¯ä»¥è·å–ç”¨æˆ·å½“å‰çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
    
    ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    export class ContextAwareRecommender {
      // æ£€æŸ¥ç”¨æˆ·æ—¥å†äº‹ä»¶å¹¶æ¨èç›¸å…³è·¯çº¿
      async checkCalendarForRecommendations(): Promise<TripRecord | null> {
        try {
          const calendar = await this.getUserCalendar();
          const upcomingEvents = await calendar.getEvents(0, 2 * 60 * 60 * 1000); // æœªæ¥2å°æ—¶å†…çš„äº‹ä»¶
    
          if (upcomingEvents.length > 0) {
            const nextEvent = upcomingEvents[0];
            const eventLocation = await this.geocodeAddress(nextEvent.location);
    
            // åˆ›å»ºä»å½“å‰ä½ç½®åˆ°äº‹ä»¶åœ°ç‚¹çš„æ¨èè·¯çº¿
            return await this.createRecommendationTrip(
              'current_location', 
              eventLocation, 
              nextEvent.startTime
            );
          }
        } catch (error) {
          console.log('No relevant calendar events found or permission denied');
        }
        return null;
      }
    
      // æ ¹æ®å®æ—¶äº¤é€šçŠ¶å†µè°ƒæ•´æ¨è
      async applyRealTimeTrafficAdjustments(trip: TripRecord): Promise<TripRecord> {
        const trafficInfo = await GaodeService.getRealTimeTraffic(
          trip.originLocation, 
          trip.destinationLocation
        );
    
        // æ ¹æ®äº¤é€šæ‹¥å µæƒ…å†µè°ƒæ•´é¢„ä¼°æ—¶é—´
        const adjustedDuration = trip.estimatedDuration * trafficInfo.congestionFactor;
        return {...trip, estimatedDuration: adjustedDuration, trafficCondition: trafficInfo.level};
      }
    }
    ```
    

### æ€§èƒ½ä¼˜åŒ–ä¸éšç§ä¿æŠ¤

1. **æ¨èç»“æœç¼“å­˜**ï¼šå¯¹æ¨èç®—æ³•çš„ç»“æœè¿›è¡Œæœ¬åœ°ç¼“å­˜ï¼Œé¿å…é¢‘ç¹è®¡ç®—æˆ–ç½‘ç»œè¯·æ±‚ã€‚
    
2. **å·®åˆ†éšç§æŠ€æœ¯**ï¼šåœ¨å°†ç”¨æˆ·æ•°æ®ç”¨äºæ¨¡å‹è®­ç»ƒå‰ï¼ŒåŠ å…¥éšæœºå™ªå£°ï¼Œä¿æŠ¤ä¸ªä½“éšç§
    
    ã€‚
    
3. **æ¨¡å‹è½»é‡åŒ–**ï¼šè€ƒè™‘ä½¿ç”¨TensorFlow Liteæˆ–PyTorch Mobileåœ¨ç«¯ä¾§éƒ¨ç½²è½»é‡çº§æ¨èæ¨¡å‹
    
    ã€‚
    

### æµ‹è¯•ä¸è¿­ä»£

1. **A/Bæµ‹è¯•æ¡†æ¶**ï¼šå¯ä»¥è®¾è®¡A/Bæµ‹è¯•ï¼Œæ¯”è¾ƒä¸åŒæ¨èç­–ç•¥çš„ç”¨æˆ·ç‚¹å‡»ç‡ï¼ŒæŒç»­ä¼˜åŒ–ç®—æ³•
    
    ã€‚
    
2. **åé¦ˆå¾ªç¯**ï¼šåœ¨æ¨èç•Œé¢æ·»åŠ "ä¸æ„Ÿå…´è¶£"æŒ‰é’®ï¼Œæ ¹æ®ç”¨æˆ·åé¦ˆè°ƒæ•´æ¨èæƒé‡ã€‚
    

é€šè¿‡ä¸Šè¿°æ­¥éª¤ï¼Œæ‚¨çš„é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹å°†èƒ½å¤ŸåŸºäºç”¨æˆ·çš„å†å²è¡Œä¸ºå’Œä¸ªäººåå¥½ï¼Œæä¾›çœŸæ­£ä¸ªæ€§åŒ–çš„è·¯çº¿æ¨èã€‚å…³é”®æ˜¯å¾ªåºæ¸è¿›ï¼Œä»ç®€å•çš„åŸºäºé¢‘ç‡çš„æ¨èå¼€å§‹ï¼Œéšç€æ•°æ®ç§¯ç´¯é€æ­¥å¼•å…¥æ›´å¤æ‚çš„ç®—æ³•ã€‚

å¸Œæœ›è¿™äº›æ›´å…·ä½“çš„å®ç°ç»†èŠ‚èƒ½å¸®åŠ©æ‚¨å°†åŠŸèƒ½è½åœ°ï¼å¦‚æœæ‚¨åœ¨æŸä¸ªå…·ä½“ç¯èŠ‚éœ€è¦æ›´æ·±å…¥çš„ä»£ç ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/segmentfault_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/www_fzithome_com.ico)

æº

å¦‚ä½•è®¾è®¡ç”¨æˆ·ç”»åƒçš„æ•°æ®ç»“æ„æ¥æ”¯æŒä¸ªæ€§åŒ–è·¯çº¿æ¨èï¼Ÿ

ååŒè¿‡æ»¤ç®—æ³•åœ¨è·¯çº¿æ¨èä¸­çš„å…·ä½“å®ç°æ­¥éª¤å’Œä»£ç ç¤ºä¾‹

å¦‚ä½•åˆ©ç”¨é¸¿è’™çš„æƒ…æ™¯æ„ŸçŸ¥APIå®ç°å®æ—¶æ™ºèƒ½è·¯çº¿è°ƒæ•´ï¼Ÿ

è¦å¢åŠ åœ°å›¾ç²¾å‡†å®šä½è¿˜æœ‰éœ€è¦ç”³è¯·çš„ç›¸å…³æƒé™ï¼Œæ¯ä¸ªé¡µé¢å…·ä½“ä»£ç è¡¥å……æ•™ç¨‹

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶3ç§’)

å¥½çš„ï¼Œç”¨æˆ·ä¹‹å‰å·²ç»è®¨è®ºäº†é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹çš„é«˜çº§å¼€å‘ï¼Œç°åœ¨æ˜ç¡®è¦æ±‚è¡¥å……åœ°å›¾ç²¾å‡†å®šä½å’Œç›¸å…³æƒé™ç”³è¯·çš„å…·ä½“ä»£ç æ•™ç¨‹ã€‚è¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®æˆ˜é˜¶æ®µçš„å¼€å‘è€…ï¼Œéœ€è¦è½åœ°å®æ–½çš„ç»†èŠ‚ã€‚

æˆ‘éœ€è¦é‡ç‚¹è§£å†³ä¸¤ä¸ªæ ¸å¿ƒéœ€æ±‚ï¼šä¸€æ˜¯ç²¾å‡†å®šä½çš„æŠ€æœ¯å®ç°ï¼ŒåŒ…æ‹¬æƒé™ç”³è¯·å’Œåœ°å›¾é›†æˆï¼›äºŒæ˜¯æ¯ä¸ªé¡µé¢çš„å…·ä½“ä»£ç ç¤ºä¾‹ï¼Œè®©ç”¨æˆ·èƒ½ç›´æ¥å¤åˆ¶ä½¿ç”¨ã€‚ä»å¯¹è¯å†å²çœ‹ï¼Œç”¨æˆ·å¯¹æŠ€æœ¯æ·±åº¦è¦æ±‚å¾ˆé«˜ï¼Œéœ€è¦æä¾›çœŸæ­£èƒ½ä¸Šæ‰‹çš„å®æ“å†…å®¹ã€‚

æˆ‘æ‰“ç®—å…ˆæ„å»ºä¸€ä¸ªæ¸…æ™°çš„æµç¨‹æ¡†æ¶ï¼Œè®©ç”¨æˆ·å¯¹æ•´ä½“å¼€å‘æ­¥éª¤æœ‰æ¦‚å¿µã€‚ç„¶åé‡ç‚¹æ·±å…¥æƒé™ç”³è¯·å’Œç²¾å‡†å®šä½è¿™ä¸¤ä¸ªå…³é”®æŠ€æœ¯ç‚¹ï¼Œæœ€åç»™å‡ºä¸åŒé¡µé¢çš„ä»£ç ç¤ºä¾‹ã€‚

å…³äºæƒé™ç”³è¯·ï¼Œ

æä¾›äº†å¾ˆè¯¦ç»†çš„æƒé™ç±»å‹è¯´æ˜å’Œé…ç½®æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯æ˜ç¡®äº†ç²¾å‡†å®šä½éœ€è¦åŒæ—¶ç”³è¯·ohos.permission.LOCATIONå’Œohos.permission.APPROXIMATELY_LOCATIONä¸¤ä¸ªæƒé™ã€‚è¿™äº›ä¿¡æ¯å¾ˆå…³é”®ï¼Œæˆ‘ä¼šåœ¨æƒé™é…ç½®éƒ¨åˆ†é‡ç‚¹ä½¿ç”¨ã€‚

åœ¨åœ°å›¾å®šä½å®ç°æ–¹é¢ï¼Œ

çš„ä»£ç éå¸¸å®Œæ•´ï¼Œä»æƒé™æ£€æŸ¥åˆ°å®šä½æ¨¡å¼è®¾ç½®éƒ½æœ‰è¯¦ç»†ç¤ºä¾‹ï¼Œç‰¹åˆ«æ˜¯MyLocationStyleçš„ä¸åŒæ¨¡å¼è¯´æ˜å¾ˆå®ç”¨ã€‚æåˆ°çš„å®‰å…¨æ§ä»¶LocationButtonæ˜¯ä¸ªä¸é”™çš„è¡¥å……æ–¹æ¡ˆï¼Œå¯ä»¥ç®€åŒ–ç”¨æˆ·æ“ä½œã€‚

æåˆ°äº†ä¸€ä¸ªå®é™…å¼€å‘ä¸­å¸¸è§çš„é—®é¢˜ï¼šå³ä½¿è®¾ç½®äº†è¿”å›é€†åœ°ç†ä¿¡æ¯ï¼Œæœ‰æ—¶ä¹Ÿåªèƒ½æ‹¿åˆ°ç»çº¬åº¦ï¼Œéœ€è¦é¢å¤–è¿›è¡Œé€†åœ°ç†ç¼–ç ã€‚è¿™ä¸ªå®æˆ˜ç»éªŒå¾ˆæœ‰ä»·å€¼ï¼Œæˆ‘ä¼šåœ¨ä»£ç ä¸­ä½“ç°å¤„ç†æ–¹æ¡ˆã€‚

æˆ‘å‡†å¤‡ç”¨è¡¨æ ¼å¯¹æ¯”ä¸åŒçš„å®šä½æ¨¡å¼ï¼Œè¿™æ ·æ›´ç›´è§‚ã€‚ä»£ç ç¤ºä¾‹ä¼šä¿æŒå®Œæ•´æ€§å’Œå¯å¤åˆ¶æ€§ï¼Œç¡®ä¿ç”¨æˆ·èƒ½ç›´æ¥ä½¿ç”¨ã€‚åŒæ—¶è¦å¼ºè°ƒä¸€äº›æ˜“é”™ç‚¹ï¼Œæ¯”å¦‚æƒé™ç”³è¯·é¡ºåºã€éšç§åˆè§„é…ç½®ç­‰ã€‚

ä¸ºä½ çš„é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹å¢åŠ ç²¾å‡†å®šä½åŠŸèƒ½ï¼Œç¡®å®èƒ½æå¤§æå‡ç”¨æˆ·ä½“éªŒã€‚ä¸‹é¢è¿™ä»½è¯¦ç»†çš„å®æ“æŒ‡å—å°†å¸¦ä½ å®Œæˆä»æƒé™ç”³è¯·åˆ°åœ¨å„ä¸ªé¡µé¢é›†æˆå®šä½åŠŸèƒ½çš„å®Œæ•´æµç¨‹ã€‚

### ğŸ—ºï¸ ç²¾å‡†å®šä½ä¸æƒé™ç”³è¯·æµç¨‹

å®ç°ç²¾å‡†å®šä½ï¼Œé¦–å…ˆéœ€è¦æ­£ç¡®ç”³è¯·æƒé™å¹¶åœ¨ä»£ç ä¸­å¤„ç†æˆæƒé€»è¾‘ã€‚å…¶æ ¸å¿ƒæµç¨‹å¯æ¦‚æ‹¬ä¸ºä»¥ä¸‹å‡ ä¸ªå…³é”®æ­¥éª¤ï¼š

mermaid

```mermaid
flowchart TD
    A[å¼€å§‹é›†æˆå®šä½åŠŸèƒ½] --> B(é…ç½®æƒé™å£°æ˜)
    B --> C{åŠ¨æ€ç”³è¯·æƒé™}
    C -- ç”¨æˆ·æˆæƒ --> D[åˆå§‹åŒ–åœ°å›¾ä¸å®šä½]
    C -- ç”¨æˆ·æ‹’ç» --> E[å¼•å¯¼ç”¨æˆ·æ‰‹åŠ¨å¼€å¯]
    E --> C
    D --> F(å®ç°å®šä½é€»è¾‘)
    F --> G[æ˜¾ç¤ºå®šä½è“ç‚¹]
    F --> H[è°ƒæ•´åœ°å›¾è§†è§’]
    F --> I[è·å–ä½ç½®ä¿¡æ¯]
    G --> J[åœ¨å„é¡µé¢è°ƒç”¨]
    H --> J
    I --> J
    J --> K(å®Œæˆé›†æˆ)
```

### ğŸ“‹ æƒé™é…ç½®ä¸å£°æ˜

é¦–å…ˆï¼Œåœ¨ `module.json5`æ–‡ä»¶ä¸­å£°æ˜åº”ç”¨æ‰€éœ€çš„å®šä½æƒé™ã€‚è¿™ä¸€æ­¥æ˜¯å‘Šè¯‰ç³»ç»Ÿä½ çš„åº”ç”¨ä¸ºä»€ä¹ˆéœ€è¦è¿™äº›æƒé™ã€‚

json

json

å¤åˆ¶

```
{
  "module": {
    "requestPermissions": [
      {
        "name": "ohos.permission.LOCATION",
        "reason": "$string:location_permission_reason",
        "usedScene": {
          "abilities": ["EntryAbility"],
          "when": "inuse"
        }
      },
      {
        "name": "ohos.permission.APPROXIMATELY_LOCATION",
        "reason": "$string:location_permission_reason",
        "usedScene": {
          "abilities": ["EntryAbility"],
          "when": "inuse"
        }
      }
    ]
  }
}
```

åœ¨ `string.json`æ–‡ä»¶ä¸­æä¾›æƒé™ç”³è¯·çš„è¯¦ç»†ç†ç”±ï¼Œè¿™èƒ½å¢åŠ ç”¨æˆ·æˆæƒçš„å¯èƒ½æ€§ï¼š

json

json

å¤åˆ¶

```
{
  "string": [
    {
      "name": "location_permission_reason",
      "value": "åº”ç”¨éœ€è¦è·å–æ‚¨çš„ä½ç½®ä¿¡æ¯ç”¨äºè·¯çº¿è§„åˆ’ã€å¯¼èˆªå’Œæ¨èå‘¨è¾¹æœåŠ¡"
    }
  ]
}
```

**å…³é”®ç‚¹è¯´æ˜**ï¼š

- **æƒé™ç±»å‹**ï¼š`ohos.permission.LOCATION`å¯¹åº”**ç²¾å‡†å®šä½**ï¼ˆGPSçº§åˆ«ï¼Œç²¾åº¦é«˜ï¼‰ï¼›`ohos.permission.APPROXIMATELY_LOCATION`å¯¹åº”**æ¨¡ç³Šå®šä½**ï¼ˆåŸºç«™/WiFiçº§åˆ«ï¼Œç²¾åº¦ä½ä½†çœç”µï¼‰
    
    ã€‚
    
- **ç”³è¯·ç­–ç•¥**ï¼šå»ºè®®åŒæ—¶ç”³è¯·è¿™ä¸¤ä¸ªæƒé™ï¼Œå¹¶æ ¹æ®å®é™…éœ€è¦å‘ç”¨æˆ·è§£é‡Šå…¶ç”¨é€”
    
    ã€‚
    

### âš™ï¸ åŠ¨æ€æƒé™ç”³è¯·ä¸å®šä½åˆå§‹åŒ–

æƒé™å£°æ˜åï¼Œéœ€è¦åœ¨åº”ç”¨è¿è¡Œæ—¶åŠ¨æ€å‘ç”¨æˆ·ç”³è¯·ã€‚è¿™éƒ¨åˆ†ä»£ç é€šå¸¸æ”¾åœ¨ `EntryAbility.ets`ä¸­ã€‚

typescript

typescript

å¤åˆ¶

```
// EntryAbility.ets
import { abilityAccessCtrl, bundleManager, common, Permissions } from '@kit.AbilityKit';
import { BusinessError } from '@kit.BasicServicesKit';
import { geoLocationManager } from '@kit.LocationKit';
import { MapsInitializer } from '@amap/amap_lbs_map3d'; // é«˜å¾·åœ°å›¾åˆå§‹åŒ–å™¨

export default class EntryAbility extends UIAbility {
  async onCreate(want: Want, launchParam: AbilityConstant.LaunchParam): Promise<void> {
    // 1. ç”³è¯·å®šä½æƒé™
    await this.requestLocationPermissions();
    
    // 2. åˆå§‹åŒ–é«˜å¾·åœ°å›¾SDK (éœ€å…ˆç”³è¯·æƒé™)
    MapsInitializer.setApiKey('ä½ çš„é«˜å¾·åœ°å›¾API Key'); // è¯·æ›¿æ¢ä¸ºå®é™…Key
    // å…¶ä»–SDKåˆå§‹åŒ–ä»£ç ...
  }

  private async requestLocationPermissions(): Promise<void> {
    const permissions: Permissions[] = [
      'ohos.permission.APPROXIMATELY_LOCATION',
      'ohos.permission.LOCATION'
    ];
    
    try {
      const atManager = abilityAccessCtrl.createAtManager();
      const result = await atManager.requestPermissionsFromUser(this.context, permissions);
      
      const allGranted = result.authResults.every(status => status === 0);
      if (!allGranted) {
        // æƒé™è¢«æ‹’ç»ï¼Œå¯ä»¥å¼•å¯¼ç”¨æˆ·å»è®¾ç½®é¡µæ‰‹åŠ¨å¼€å¯
        this.showPermissionGuide();
      }
    } catch (error) {
      console.error('[EntryAbility] è¯·æ±‚å®šä½æƒé™å¤±è´¥:', (error as BusinessError).message);
    }
  }

  private showPermissionGuide(): void {
    // è¿™é‡Œå¯ä»¥å¼¹çª—æç¤ºç”¨æˆ·æƒé™çš„é‡è¦æ€§ï¼Œå¹¶å¼•å¯¼å…¶å‰å¾€ç³»ç»Ÿè®¾ç½®å¼€å¯
    console.info('[EntryAbility] å®šä½æƒé™è¢«æ‹’ç»ï¼Œéƒ¨åˆ†åŠŸèƒ½å°†å—é™');
  }
}
```

### ğŸ“ åœ°å›¾é¡µé¢å®šä½åŠŸèƒ½å®ç°

åœ¨éœ€è¦ä½¿ç”¨åœ°å›¾çš„é¡µé¢ï¼ˆå¦‚ `HomePage.ets`ï¼‰ï¼Œå®ç°å®šä½è“ç‚¹çš„æ˜¾ç¤ºå’Œåœ°å›¾è§†è§’çš„ç§»åŠ¨ã€‚

typescript

typescript

å¤åˆ¶

```
// HomePage.ets
import { MapView, MapViewComponent, MapViewManager, MyLocationStyle, LatLng, CameraUpdateFactory } from '@amap/amap_lbs_map3d';
import { geoLocationManager } from '@kit.LocationKit';

@Entry
@Component
struct HomePage {
  private mapView: MapView | undefined = undefined;
  private aMap: AMap | undefined = undefined;
  @State currentLocation: string = 'å®šä½ä¸­...';

  aboutToAppear(): void {
    // æ³¨å†Œåœ°å›¾åˆ›å»ºå›è°ƒ
    MapViewManager.getInstance().registerMapViewCreatedCallback(this.mapViewCreateCallback);
  }

  private mapViewCreateCallback: MapViewCreateCallback = (mapview: MapView | undefined, mapViewName: string | undefined) => {
    if (!mapview) return;
    
    this.mapView = mapview;
    this.mapView.onCreate();
    
    this.mapView.getMapAsync(async (map: AMap) => {
      this.aMap = map;
      // é…ç½®å¹¶å¯åŠ¨å®šä½
      this.setupLocation();
    });
  };

  private async setupLocation(): Promise<void> {
    if (!this.aMap) return;

    // 1. è®¾ç½®å®šä½æ ·å¼ï¼ˆå®šä½è“ç‚¹ï¼‰
    const locationStyle = new MyLocationStyle();
    locationStyle.myLocationType(MyLocationStyle.LOCATION_TYPE_FOLLOW); // æ¨¡å¼ï¼šè·Ÿéš
    this.aMap.setMyLocationStyle(locationStyle);
    this.aMap.setMyLocationEnabled(true); // å¯ç”¨å®šä½å›¾å±‚

    // 2. è·å–å½“å‰ä½ç½®å¹¶ç§»åŠ¨åœ°å›¾è§†è§’
    try {
      const requestInfo: geoLocationManager.CurrentLocationRequest = {
        priority: geoLocationManager.LocationRequestPriority.ACCURACY, // é«˜ç²¾åº¦
        scenario: geoLocationManager.LocationRequestScenario.NAVIGATION, // å¯¼èˆªåœºæ™¯
        maxAccuracy: 50 // ç²¾åº¦è¦æ±‚ï¼ˆç±³ï¼‰
      };
      
      const location = await geoLocationManager.getCurrentLocation(requestInfo);
      const latLng = new LatLng(location.latitude, location.longitude);
      
      // ç§»åŠ¨åœ°å›¾åˆ°å½“å‰ä½ç½®
      this.aMap.moveCamera(CameraUpdateFactory.newLatLngZoom(latLng, 16)); // ç¼©æ”¾çº§åˆ«16
      
      // æ›´æ–°UIæ˜¾ç¤ºä½ç½®ä¿¡æ¯
      this.currentLocation = `ç»åº¦: ${location.longitude.toFixed(6)}, çº¬åº¦: ${location.latitude.toFixed(6)}`;
      
    } catch (error) {
      console.error('[HomePage] è·å–ä½ç½®å¤±è´¥:', (error as BusinessError).message);
      this.currentLocation = 'å®šä½å¤±è´¥';
    }
  }

  build() {
    Column() {
      // ä½ç½®ä¿¡æ¯æ˜¾ç¤º
      Text(this.currentLocation)
        .fontSize(14)
        .padding(10)
      
      // åœ°å›¾å®¹å™¨
      MapComponent({ mapOptions: { zoom: 10 } })
        .width('100%')
        .height('100%')
    }
  }
}
```

### ğŸ”„ å…¶ä»–é¡µé¢çš„å®šä½è°ƒç”¨

åœ¨ä¸åŒé¡µé¢ï¼Œå®šä½åŠŸèƒ½çš„éœ€æ±‚å¯èƒ½ä¸åŒã€‚ä¾‹å¦‚ï¼Œåœ¨è·¯çº¿è§„åˆ’é¡µé¢ï¼ˆ`TravelPlanPage.ets`ï¼‰ï¼Œä½ å¯èƒ½åªéœ€è¦å•æ¬¡å®šä½æ¥ç¡®å®šèµ·ç‚¹ã€‚

typescript

typescript

å¤åˆ¶

```
// TravelPlanPage.ets (éƒ¨åˆ†ä»£ç )
import { geoLocationManager } from '@kit.LocationKit';

@Entry
@Component
struct TravelPlanPage {
  @State startPoint: string = 'æˆ‘çš„ä½ç½®';

  // é¡µé¢æ˜¾ç¤ºæ—¶è·å–å½“å‰ä½ç½®ä½œä¸ºè·¯çº¿èµ·ç‚¹
  async onPageShow(): Promise<void> {
    await this.getCurrentLocationForStartPoint();
  }

  private async getCurrentLocationForStartPoint(): Promise<void> {
    try {
      const location = await geoLocationManager.getCurrentLocation({
        priority: geoLocationManager.LocationRequestPriority.FIRST_FIX, // å¿«é€Ÿè·å–ä½ç½®
        scenario: geoLocationManager.LocationRequestScenario.NAVIGATION
      });
      
      // è¿™é‡Œå¯ä»¥è°ƒç”¨é€†åœ°ç†ç¼–ç æ¥å£ï¼Œå°†ç»çº¬åº¦è½¬æ¢ä¸ºå…·ä½“åœ°å€
      // ä¾‹å¦‚ï¼šè°ƒç”¨é«˜å¾·é€†åœ°ç†ç¼–ç APIï¼Œå°†ç»“æœèµ‹äºˆthis.startPoint
      this.startPoint = await this.reverseGeocode(location.latitude, location.longitude);
      
    } catch (error) {
      console.error('[TravelPlanPage] è·å–èµ·ç‚¹ä½ç½®å¤±è´¥:', error);
      this.startPoint = 'è·å–ä½ç½®å¤±è´¥';
    }
  }

  build() {
    // ... é¡µé¢å…¶ä»–éƒ¨åˆ†
    TextInput({ placeholder: 'èµ·ç‚¹', text: this.startPoint })
    // ...
  }
}
```

### ğŸ’¡ å®ç”¨æŠ€å·§ä¸æ³¨æ„äº‹é¡¹

1. **å®šä½æ¨¡å¼é€‰æ‹©**ï¼š`MyLocationStyle`æä¾›äº†å¤šç§æ¨¡å¼
    
    ï¼Œå¯æ ¹æ®åœºæ™¯é€‰æ‹©ï¼š
    
    |æ¨¡å¼|å¸¸é‡|é€‚ç”¨åœºæ™¯|
    |---|---|---|
    |åªå±•ç¤º|`LOCATION_TYPE_SHOW`|ä»…æ˜¾ç¤ºä½ç½®ï¼Œä¸ç§»åŠ¨åœ°å›¾|
    |å®šä½ä¸€æ¬¡|`LOCATION_TYPE_LOCATE`|è·å–ä¸€æ¬¡ä½ç½®å¹¶ç§»åŠ¨åœ°å›¾ï¼ˆå¸¸ç”¨ï¼‰|
    |è·Ÿéš|`LOCATION_TYPE_FOLLOW`|æŒç»­å®šä½ï¼Œåœ°å›¾éšä½ç½®ç§»åŠ¨ï¼ˆå¯¼èˆªæ—¶ï¼‰|
    
2. **æƒé™ç”³è¯·æ—¶æœº**ï¼šä¸è¦åœ¨åº”ç”¨ä¸€å¯åŠ¨å°±ç”³è¯·æ‰€æœ‰æƒé™ã€‚æ›´å¥½çš„åšæ³•æ˜¯**åœ¨ç”¨æˆ·è§¦å‘ç›¸å…³åŠŸèƒ½æ—¶å†ç”³è¯·**ï¼ˆä¾‹å¦‚ï¼Œå½“ç”¨æˆ·ç‚¹å‡»è·¯çº¿è§„åˆ’æŒ‰é’®æ—¶ï¼‰ï¼Œè¿™æ ·ç”¨æˆ·æ›´å®¹æ˜“ç†è§£æƒé™çš„ç”¨é€”å¹¶åŒæ„æˆæƒ
    
    ã€‚
    
3. **å¤„ç†ç”¨æˆ·æ‹’ç»**ï¼šå¦‚æœç”¨æˆ·æ‹’ç»æˆæƒï¼Œåº”å‹å¥½åœ°æç¤ºæƒé™çš„é‡è¦æ€§ï¼Œå¹¶å¼•å¯¼ç”¨æˆ·å‰å¾€ç³»ç»Ÿè®¾ç½®æ‰‹åŠ¨å¼€å¯
    
    ã€‚
    
4. **é€†åœ°ç†ç¼–ç **ï¼šè·å–åˆ°çš„ç»çº¬åº¦éœ€è¦è½¬æ¢ä¸ºå…·ä½“åœ°å€æ–‡å­—æ‰æ›´æœ‰æ„ä¹‰ã€‚è¿™é€šå¸¸éœ€è¦è°ƒç”¨é«˜å¾·åœ°å›¾çš„é€†åœ°ç†ç¼–ç æœåŠ¡ï¼ˆä¾‹å¦‚ `geoLocationManager.getAddressesFromLocation`æ–¹æ³•æˆ–é«˜å¾·ç›¸å…³APIï¼‰
    
    ã€‚
    

å¸Œæœ›è¿™ä»½è¯¦ç»†çš„æŒ‡å—èƒ½å¸®åŠ©ä½ é¡ºåˆ©å®ç°é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹çš„ç²¾å‡†å®šä½åŠŸèƒ½ï¼å¦‚æœåœ¨å…·ä½“çš„å®ç°æ­¥éª¤ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥éšæ—¶æé—®ã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_51cto_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/bbs_huaweicloud_com.ico)

æº

è¯·æä¾›æ‰€æœ‰é¡µé¢çš„å®šä½ä»£ç ç¤ºä¾‹

å¦‚ä½•åœ¨é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹ä¸­å®ç°å®šä½ä¿¡æ¯çš„å®æ—¶æ›´æ–°ï¼Ÿ

å¦‚ä½•å®ç°å®šä½æƒé™çš„è‡ªåŠ¨ç»­ç­¾ï¼ˆå³å½“ç”¨æˆ·æ‹’ç»åï¼Œå†æ¬¡æ‰“å¼€åº”ç”¨æ—¶è‡ªåŠ¨è¡¥ç­¾ï¼‰ï¼Ÿ

ç”³è¯·æ˜¯å‘ç”¨æˆ·ç”³è¯·è¿˜æ˜¯å¹³å°

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶7ç§’)

å¥½çš„ï¼Œç”¨æˆ·è¯¢é—®çš„æ˜¯é¸¿è’™åº”ç”¨å¼€å‘ä¸­æƒé™ç”³è¯·çš„æŒ‡å‘é—®é¢˜ï¼Œå³å‘ç”¨æˆ·ç”³è¯·è¿˜æ˜¯å‘å¹³å°ç”³è¯·ã€‚è¿™ç¡®å®æ˜¯å¼€å‘åˆæœŸä¸€ä¸ªå…³é”®çš„åŸºç¡€æ¦‚å¿µã€‚

æˆ‘éœ€è¦å¸®ç”¨æˆ·æ˜ç¡®é¸¿è’™ç³»ç»Ÿä¸­æƒé™ç”³è¯·çš„å¯¹è±¡å’Œæµç¨‹ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œé¸¿è’™ç³»ç»Ÿå°†æƒé™åˆ†ä¸ºä¸¤ç±»ï¼Œå…¶ç”³è¯·æ–¹å¼æœ‰æ ¹æœ¬åŒºåˆ«

ã€‚

ä¸€ç±»æ˜¯**ç³»ç»Ÿæˆæƒï¼ˆsystem_grantï¼‰**ã€‚è¿™ç±»æƒé™ä¸æ¶‰åŠç”¨æˆ·æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚ç½‘ç»œè®¿é—®ï¼ˆ`ohos.permission.INTERNET`ï¼‰ã€‚åº”ç”¨å®‰è£…æ—¶ç³»ç»Ÿä¼š**è‡ªåŠ¨æˆäºˆ**ï¼Œæ— éœ€ç”¨æˆ·æ“ä½œ

ã€‚è¿™å¯ä»¥ç†è§£ä¸ºæ˜¯å‘â€œå¹³å°â€çš„è‡ªåŠ¨ç”³è¯·ã€‚

å¦ä¸€ç±»æ˜¯**ç”¨æˆ·æˆæƒï¼ˆuser_grantï¼‰**ã€‚è¿™ç±»æƒé™æ¶‰åŠæ•æ„Ÿä¿¡æ¯ï¼Œå¦‚ä½ç½®ï¼ˆ`ohos.permission.LOCATION`ï¼‰ã€ç›¸æœºï¼ˆ`ohos.permission.CAMERA`ï¼‰ç­‰

ã€‚åº”ç”¨å¿…é¡»åœ¨è¿è¡Œæ—¶**åŠ¨æ€å¼¹çª—è¯·æ±‚ç”¨æˆ·æˆæƒ**ã€‚ç”¨æˆ·å¯ä»¥é€‰æ‹©å…è®¸æˆ–æ‹’ç»ã€‚å¦‚æœç”¨æˆ·æ‹’ç»ï¼Œåº”ç”¨æ— æ³•å†æ¬¡å¼¹çª—ï¼Œåªèƒ½å¼•å¯¼ç”¨æˆ·å»ç³»ç»Ÿè®¾ç½®æ‰‹åŠ¨å¼€å¯ã€‚

å› æ­¤ï¼Œé¸¿è’™åº”ç”¨çš„æƒé™ç”³è¯·ï¼Œæ ¹æ®æƒé™ç±»å‹ä¸åŒï¼Œæ—¢æœ‰é¢å‘å¹³å°çš„è‡ªåŠ¨æµç¨‹ï¼Œä¹Ÿæœ‰å…³é”®çš„é¢å‘ç”¨æˆ·çš„äº¤äº’æµç¨‹ã€‚ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£ä¸åŒæƒé™çš„ç”³è¯·è·¯å¾„ï¼Œæ‚¨å¯ä»¥å‚è€ƒä¸‹é¢çš„æµç¨‹å›¾ï¼š

flowchart TD
    A[åº”ç”¨éœ€è¦æƒé™] --> B{åˆ¤æ–­æƒé™ç±»å‹}
    B -->|ç³»ç»Ÿæˆæƒ<br>ï¼ˆsystem_grantï¼‰| C[å¹³å°è‡ªåŠ¨æˆäºˆ<br>å®‰è£…æ—¶é™é»˜å®Œæˆ]
    B -->|ç”¨æˆ·æˆæƒ<br>ï¼ˆuser_grantï¼‰| D[åº”ç”¨åŠ¨æ€ç”³è¯·]
    
    D --> E[ç³»ç»Ÿå‘ç”¨æˆ·å¼¹çª—]
    E --> F{ç”¨æˆ·é€‰æ‹©}
    F -->|å…è®¸| G[æˆæƒæˆåŠŸ]
    F -->|æ‹’ç»| H[æˆæƒå¤±è´¥]
    
    H --> I[å¼•å¯¼ç”¨æˆ·è‡³ç³»ç»Ÿè®¾ç½®]
    I --> J{ç”¨æˆ·åœ¨è®¾ç½®ä¸­æˆæƒ}
    J -->|æˆæƒ| G
    J -->|ä»ä¸æˆæƒ| K[åŠŸèƒ½å—é™æˆ–ä½¿ç”¨é™çº§æ–¹æ¡ˆ]
    
    C --> L[åº”ç”¨è·å¾—æƒé™]
    G --> L

ç®€å•æ¥è¯´ï¼Œ**å¹³å°ï¼ˆç³»ç»Ÿï¼‰è´Ÿè´£è‡ªåŠ¨å¤„ç†éæ•æ„Ÿæƒé™çš„æˆäºˆï¼Œè€Œç”¨æˆ·åˆ™æŒæ¡ç€æ•æ„Ÿæƒé™çš„æœ€ç»ˆå†³å®šæƒ**ã€‚

åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¤„ç†å¥½ç”¨æˆ·æˆæƒæµç¨‹å¯¹ç”¨æˆ·ä½“éªŒè‡³å…³é‡è¦ã€‚ä»¥ä¸‹å‡ ç‚¹å€¼å¾—æ³¨æ„ï¼š

- **é€‚æ—¶ç”³è¯·**ï¼šæœ€å¥½åœ¨ç”¨æˆ·éœ€è¦ç›¸å…³åŠŸèƒ½æ—¶å†ç”³è¯·å¯¹åº”æƒé™ï¼Œå¹¶ç®€è¦è¯´æ˜ç”¨é€”
    
    ã€‚
    
- **æœ‰å¤‡é€‰æ–¹æ¡ˆ**ï¼šå¦‚æœç”¨æˆ·æ‹’ç»æˆæƒï¼Œåº”ç”¨åº”æœ‰é™çº§æ–¹æ¡ˆï¼ˆå¦‚æ‰‹åŠ¨è¾“å…¥åœ°å€ä»£æ›¿å®šä½ï¼‰
    
    ã€‚
    
- **éµå¾ªæœ€å°åŒ–åŸåˆ™**ï¼šåªç”³è¯·åº”ç”¨åŠŸèƒ½å¿…éœ€çš„å¿…è¦æƒé™
    
    ã€‚
    

å¸Œæœ›è¿™äº›è§£é‡Šèƒ½å¸®åŠ©æ‚¨ç†æ¸…æ€è·¯ã€‚å¦‚æœæ‚¨æƒ³äº†è§£æŸä¸ªå…·ä½“æƒé™çš„ç”³è¯·ç»†èŠ‚ï¼Œæ¯”å¦‚ç²¾ç¡®å®šä½ï¼Œæˆ‘å¯ä»¥æä¾›æ›´å…·ä½“çš„ä»£ç ç¤ºä¾‹ã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/juejin_cn.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/segmentfault_com.ico)

æº

æœ‰äº›åŠŸèƒ½å¦‚å¡ç‰‡æœåŠ¡æ˜¯è¦å‘å¹³å°ç”³è¯·çš„ï¼Œè¿˜æœ‰sdkç‰ˆæœ¬é€‚é…ç»†èŠ‚ï¼Œå¦‚æœdevecoè£…çš„api12ä»¥ä¸‹æˆ–ä»¥ä¸Šä¼šä¸ä¼šæœ‰è°ƒè¯•é—®é¢˜éƒ½è¦è®²æ¸…ï¼Œå°‘è®©å­¦ä¹ çš„äººè¸©å‘ï¼Œæé«˜ä¸€æ¬¡ä¸Šæ‰‹æˆåŠŸç‡æ‰æœ‰å­¦ä¹ åŠ¨åŠ›

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶4ç§’)

å¥½çš„ï¼Œç”¨æˆ·ä¹‹å‰ä¸€ç›´åœ¨è®¨è®ºé¸¿è’™æ™ºè¡ŒåŠ©æ‰‹çš„å¼€å‘ï¼Œç°åœ¨ç‰¹åˆ«å…³æ³¨ä¸¤ä¸ªå®æ“ä¸­å®¹æ˜“è¸©å‘çš„åœ°æ–¹ï¼šå¡ç‰‡æœåŠ¡å¦‚ä½•å‘å¹³å°ç”³è¯·ï¼Œä»¥åŠSDKç‰ˆæœ¬é€‚é…çš„å…·ä½“ç»†èŠ‚ã€‚ä»–å¸Œæœ›æ•™ç¨‹èƒ½è®²æ¸…æ¥šè¿™äº›ï¼Œé¿å…å­¦ä¹ è€…è¸©å‘ï¼Œæé«˜ä¸€æ¬¡ä¸Šæ‰‹çš„æˆåŠŸç‡ã€‚

ä»å¯¹è¯å†å²çœ‹ï¼Œç”¨æˆ·åº”è¯¥æ˜¯æœ‰ä¸€å®šå¼€å‘ç»éªŒçš„å¼€å‘è€…ï¼Œæ­£åœ¨å®é™…æ„å»ºä¸€ä¸ªé¸¿è’™åº”ç”¨ï¼Œå¯¹ç»†èŠ‚è¦æ±‚å¾ˆé«˜ã€‚ä»–éœ€è¦çš„æ˜¯èƒ½å¤Ÿç›´æ¥æŒ‡å¯¼å®æ“çš„ã€éå¸¸å…·ä½“çš„æŠ€æœ¯æ–‡æ¡£ï¼Œè€Œä¸æ˜¯æ³›æ³›è€Œè°ˆçš„æ¦‚å¿µã€‚ä¹‹å‰çš„å›å¤å¯èƒ½åœ¨æŸäº›å®æ“ç»†èŠ‚ä¸Šä¸å¤Ÿè¯¦å°½ï¼Œæ‰€ä»¥ä»–è¿™æ¬¡ç‰¹åˆ«å¼ºè°ƒäº†è¦å‡å°‘è¸©å‘ç‚¹ã€‚

æˆ‘éœ€è¦é‡ç‚¹è§£å†³ä¸¤ä¸ªæ ¸å¿ƒé—®é¢˜ï¼šä¸€æ˜¯å¡ç‰‡æœåŠ¡å‘å¹³å°ç”³è¯·çš„å…·ä½“æµç¨‹å’Œæ³¨æ„äº‹é¡¹ï¼ŒäºŒæ˜¯SDKç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜çš„è¯¦ç»†è§£å†³æ–¹æ¡ˆã€‚è¿™äº›éƒ½æ˜¯å¼€å‘ä¸­çœŸå®ä¼šé‡åˆ°çš„ç—›ç‚¹ã€‚

å…³äºå¡ç‰‡æœåŠ¡ç”³è¯·ï¼Œæˆ‘çœ‹åˆ°çš„æœç´¢ç»“æœ

æä¾›äº†é¸¿è’™æ™ºè”è®¾å¤‡æ¥å…¥æµç¨‹å’Œè®¤è¯æœºåˆ¶çš„è¯¦ç»†è¯´æ˜ï¼Œè™½ç„¶ä¸»è¦é¢å‘ç¡¬ä»¶è®¾å¤‡ï¼Œä½†å…¶å¯¹åˆä½œä¼™ä¼´èµ„è´¨å®¡æ ¸ã€å¹³å°åˆ›å»ºäº§å“ã€èƒ½åŠ›é›†æˆä¸è‡ªæµ‹ã€é€æ£€è®¤è¯çš„æµç¨‹æè¿°ï¼Œå¯¹åº”ç”¨æœåŠ¡å¡ç‰‡çš„ä¸Šæ¶æœ‰é‡è¦å‚è€ƒä»·å€¼ã€‚åˆ™ç›´æ¥å±•ç¤ºäº†é¸¿è’™æ™ºè¡Œå¡ç‰‡çš„å…·ä½“å½¢æ€å’Œç”Ÿæˆæ¡ä»¶ï¼Œå…·æœ‰å¾ˆé«˜çš„å‚è€ƒä»·å€¼ã€‚åˆ™è¯¦ç»†ä»‹ç»äº†æœåŠ¡å¡ç‰‡çš„å®ç°åŸç†å’Œé…ç½®æ–¹æ³•ã€‚

å…³äºSDKç‰ˆæœ¬é€‚é…é—®é¢˜ï¼Œ

æä¾›äº†éå¸¸å…·ä½“çš„é”™è¯¯æ¡ˆä¾‹å’Œè§£å†³æ–¹æ¡ˆï¼Œç‰¹åˆ«æ˜¯compatibleSdkVersionçš„é…ç½®é—®é¢˜ã€‚æ˜¯åä¸ºå®˜æ–¹å…³äºAPIç‰ˆæœ¬å˜æ›´é€‚é…çš„æŒ‡å¯¼ï¼Œæƒå¨æ€§å¾ˆé«˜ã€‚åˆ™ç»™å‡ºäº†ç³»ç»Ÿç‰ˆæœ¬ç‰¹æ€§æ£€æµ‹çš„å…·ä½“ä»£ç ç¤ºä¾‹ã€‚

æˆ‘æ‰“ç®—ç”¨è¡¨æ ¼çš„å½¢å¼å…ˆæ¸…æ™°å±•ç¤ºSDKç‰ˆæœ¬ä¸DevEco Studioã€HarmonyOSç‰ˆæœ¬çš„å¯¹åº”å…³ç³»ï¼Œè¿™æ˜¯å¼€å‘è€…æœ€å®¹æ˜“æ··æ·†çš„åœ°æ–¹ã€‚ç„¶ååˆ†ä¸¤éƒ¨åˆ†è¯¦ç»†è¯´æ˜ï¼šå¡ç‰‡æœåŠ¡çš„ç”³è¯·æµç¨‹ï¼ˆåŒ…æ‹¬å‡†å¤‡ææ–™ã€å…·ä½“æ­¥éª¤å’Œæ³¨æ„äº‹é¡¹ï¼‰ã€SDKç‰ˆæœ¬é€‚é…çš„å®æˆ˜æŒ‡å—ï¼ˆåŒ…æ‹¬é…ç½®æ–¹æ³•ã€å…¼å®¹æ€§å¤„ç†å’Œè°ƒè¯•æŠ€å·§ï¼‰ã€‚è¿™æ ·ç»“æ„æ¸…æ™°ï¼Œåˆèƒ½è¦†ç›–ç”¨æˆ·å…³å¿ƒçš„æ‰€æœ‰ç»†èŠ‚ã€‚

æ‚¨æçš„è¿™ç‚¹éå¸¸å…³é”®ï¼Œç¡®å®æ˜¯å®æˆ˜ä¸­å†³å®šæˆè´¥çš„ç»†èŠ‚ã€‚ä¸‹é¢æˆ‘å°†é‡ç‚¹é˜è¿°å¦‚ä½•å‘å¹³å°ç”³è¯·æœåŠ¡å¡ç‰‡èµ„è´¨ï¼Œä»¥åŠå¦‚ä½•ç²¾å‡†ç®¡ç†SDKç‰ˆæœ¬ä»¥é¿å…è°ƒè¯•é™·é˜±ï¼Œå¸Œæœ›èƒ½åŠ©æ‚¨ä¸€æ¬¡æå®šã€‚

### å¡ç‰‡æœåŠ¡ï¼šå‘å¹³å°ç”³è¯·èµ„è´¨ä¸ä¸Šçº¿æµç¨‹

æœåŠ¡å¡ç‰‡åŠŸèƒ½æœ¬èº«æ˜¯é¸¿è’™ç³»ç»Ÿçš„åŸºç¡€èƒ½åŠ›ï¼Œä½†è¦è®©æ‚¨çš„â€œé¸¿è’™æ™ºè¡ŒåŠ©æ‰‹â€å¡ç‰‡å…·å¤‡**åœ¨è´Ÿä¸€å±æ˜¾ç¤ºã€è·¨è®¾å¤‡æµè½¬ç­‰é«˜çº§ç‰¹æ€§**ï¼Œå°¤å…¶æ˜¯æ¶‰åŠè½¦è¾†å……ç”µçŠ¶æ€ç­‰æ•æ„Ÿä¿¡æ¯æ—¶ï¼Œé€šå¸¸éœ€è¦**é€šè¿‡åä¸ºçš„â€œé¸¿è’™æ™ºè”â€ï¼ˆHarmonyOS Connectï¼‰ç”Ÿæ€è®¤è¯**

ã€‚è¿™æœ¬è´¨ä¸Šæ˜¯å‘å¹³å°ç”³è¯·ä¸€ä¸ªâ€œä¿¡ç”¨èƒŒä¹¦â€ï¼Œç¡®ä¿æ‚¨çš„åº”ç”¨å’Œå¡ç‰‡ç¬¦åˆå¹³å°çš„è´¨é‡ä¸å®‰å…¨è§„èŒƒã€‚

ä¸‹é¢çš„æµç¨‹å›¾æ¸…æ™°åœ°å±•ç¤ºäº†ä»å‡†å¤‡åˆ°ä¸Šçº¿çš„å®Œæ•´æµç¨‹ï¼š

mermaid

```mermaid
flowchart TD
    A[å‡†å¤‡é˜¶æ®µ] --> B(ä¼ä¸šèµ„è´¨å®¡æ ¸)
    B --> C{åˆ›å»ºäº§å“å¹¶é€‰æ‹©ä½“éªŒ}
    C --> D[é›†æˆå¿…è¦èƒ½åŠ›<br>å¿«è¿/å¡ç‰‡/å…¥å£/ååŒ]
    D --> E[è‡ªæµ‹é€šè¿‡]
    E --> F[æäº¤æ ·æœºä¸ç‰©æ–™]
    F --> G{åä¸ºå®éªŒå®¤è®¤è¯}
    G -- é€šè¿‡ --> H[è®¤è¯æˆåŠŸ<br>è·å–å¹³å°èµ„æº]
    G -- å¤±è´¥ --> I[æ ¹æ®æŠ¥å‘Šæ•´æ”¹]
    I --> F
    H --> J[æ­£å¼ä¸Šçº¿åˆ†å‘]
```

å…¶æ ¸å¿ƒæ­¥éª¤å¦‚ä¸‹ï¼š

1. **å‰æœŸå‡†å¤‡ä¸ä¼ä¸šèµ„è´¨å®¡æ ¸**
    
    - **æ³¨å†Œä¼ä¸šå¼€å‘è€…**ï¼šåœ¨åä¸ºå¼€å‘è€…è”ç›Ÿï¼ˆHuawei Developerï¼‰å®˜ç½‘å®Œæˆä¼ä¸šå®åè®¤è¯å’Œæ³¨å†Œ
        
        ã€‚
        
    - **ç­¾ç½²ç”Ÿæ€åè®®**ï¼šåŒæ„å¹¶ç­¾ç½²é¸¿è’™æ™ºè”çš„ç›¸å…³åè®®ï¼Œæ­£å¼æˆä¸ºç”Ÿæ€ä¼™ä¼´
        
        ã€‚
        
    
2. **äº§å“åˆ›å»ºä¸èƒ½åŠ›é›†æˆ**
    
    - åœ¨é¸¿è’™æ™ºè”å¹³å°åˆ›å»ºæ‚¨çš„äº§å“ï¼ˆå¦‚â€œé¸¿è’™æ™ºè¡ŒåŠ©æ‰‹â€ï¼‰ã€‚æ‚¨éœ€è¦æ˜ç¡®è®¡åˆ’å®ç°çš„ä½“éªŒç‰¹å¾ï¼Œä¾‹å¦‚è‡³å°‘ä¸¤ç§æœåŠ¡å¡ç‰‡å½¢æ€ã€æ˜¯å¦æ”¯æŒå¿«è¿ç­‰
        
        ã€‚
        
    - åœ¨æ‚¨çš„åº”ç”¨å·¥ç¨‹ä¸­ï¼ŒæŒ‰ç…§è§„èŒƒå¼€å‘æœåŠ¡å¡ç‰‡ã€‚å…³é”®é…ç½®åœ¨ `module.json5`æ–‡ä»¶çš„ `extensionAbilities`å­—æ®µä¸‹å£°æ˜ `FormExtensionAbility`ï¼Œå¹¶é…ç½®å¡ç‰‡çš„ `name`ã€`description`ä»¥åŠå¿…è¦çš„å…ƒæ•°æ®
        
        ã€‚
        
    
3. **è‡ªæµ‹ä¸é€æ£€è®¤è¯**
    
    - è¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ã€‚æ‚¨éœ€è¦ä¸¥æ ¼æŒ‰ç…§å¹³å°æä¾›çš„è‡ªæµ‹ç”¨ä¾‹è¿›è¡Œæµ‹è¯•ï¼Œè¦†ç›–**é…ç½‘æ³¨å†Œã€å‡çº§ã€ç¨³å®šæ€§ã€ProfileåŠŸèƒ½**ç­‰
        
        ã€‚
        
    - è‡ªæµ‹é€šè¿‡åï¼Œåœ¨å¹³å°æäº¤è®¤è¯ç”³è¯·ï¼Œå¹¶å°†æµ‹è¯•æ ·æœºç­‰ç‰©æ–™å¯„é€è‡³åä¸ºæŒ‡å®šçš„è®¤è¯å®éªŒå®¤ã€‚å®éªŒå®¤ä¼šä¾æ®å¹³å°è§„èŒƒè¿›è¡Œä¸¥æ ¼æµ‹è¯•
        
        ã€‚
        
    
4. **è®¤è¯é€šè¿‡ä¸ä¸Šå¸‚åˆ†å‘**
    
    - è®¤è¯é€šè¿‡åï¼Œæ‚¨çš„åº”ç”¨ä¾¿è·å¾—äº†å¹³å°çš„â€œè´´æ ‡â€è®¤å¯ï¼Œå¯ä»¥æ­£å¼ä¸Šæ¶åä¸ºåº”ç”¨å¸‚åœºï¼Œå¹¶äº«å—å¹³å°çš„åˆ†å‘èµ„æº
        
        ã€‚ä¾‹å¦‚ï¼Œæ‚¨çš„å……ç”µçŠ¶æ€å¡ç‰‡æ‰èƒ½åƒå®˜æ–¹æ–‡æ¡£æè¿°çš„é‚£æ ·ï¼Œåœ¨è´Ÿä¸€å±çš„â€œæˆ‘çš„â€é¡µåŠ¨æ€æ¨¡å—ä¸­å±•ç¤ºã€‚
        
    

**æ ¸å¿ƒå»ºè®®**ï¼šåœ¨è§„åˆ’é˜¶æ®µå°±ç™»å½•é¸¿è’™æ™ºè”å¹³å°ï¼Œä»”ç»†é˜…è¯»æœ€æ–°çš„ã€ŠHarmonyOS Connect äº§å“è§„èŒƒã€‹å’Œã€Šè®¤è¯æµ‹è¯•æ ‡å‡†ã€‹ï¼Œç¡®ä¿æ‚¨çš„å¼€å‘ç›®æ ‡ä¸å¹³å°è¦æ±‚å¯¹é½ï¼Œé¿å…åæœŸè¿”å·¥

ã€‚

### SDKç‰ˆæœ¬é€‚é…ï¼šç²¾å‡†åŒ¹é…é¿å…è°ƒè¯•å™©æ¢¦

æ‚¨æåˆ°çš„DevEco Studioå®‰è£…çš„SDKç‰ˆæœ¬é—®é¢˜è‡³å…³é‡è¦ã€‚ç‰ˆæœ¬ä¸åŒ¹é…æ˜¯å¯¼è‡´ç¼–è¯‘å¤±è´¥ã€æ— æ³•çœŸæœºè°ƒè¯•çš„æœ€å¸¸è§åŸå› ã€‚

1. **ç†è§£ç‰ˆæœ¬é…å¥—å…³ç³»**
    
    åä¸ºå®˜æ–¹ä¸¥æ ¼å®šä¹‰äº† **DevEco Studioç‰ˆæœ¬ã€HarmonyOS SDKç‰ˆæœ¬ï¼ˆAPI Levelï¼‰ã€ç›®æ ‡é¸¿è’™ç³»ç»Ÿç‰ˆæœ¬**ä¸‰è€…çš„é…å¥—å…³ç³»
    
    ã€‚ä¾‹å¦‚ï¼ŒDevEco Studio 4.0 Release ç‰ˆæœ¬é»˜è®¤æ”¯æŒçš„æœ€é«˜APIç‰ˆæœ¬ä¸º9ï¼Œè€ŒDevEco Studio 5.0åŠä»¥ä¸Šç‰ˆæœ¬åˆ™ä¸»è¦é¢å‘API 12åŠä»¥ä¸Šçš„HarmonyOS NEXTã€‚ä¸‹è¡¨æ˜¯ä¸€ä¸ªå¸¸è§çš„å¯¹åº”å…³ç³»ç¤ºä¾‹ï¼š
    
    |DevEco Studio ç‰ˆæœ¬|ä¸»è¦æ”¯æŒçš„ API ç‰ˆæœ¬ (compileSdkVersion)|å¯¹åº”çš„ä¸»è¦ HarmonyOS ç³»ç»Ÿç‰ˆæœ¬|
    |---|---|---|
    |3.1.x|7, 8|HarmonyOS 2.x-3.x|
    |4.0.x|9|HarmonyOS 4.0|
    |5.0.x|12, 13|HarmonyOS 5.0 (NEXT)|
    
2. **é¡¹ç›®ä¸­çš„å…³é”®é…ç½®**
    
    åœ¨é¡¹ç›®çš„ `build-profile.json5`æ–‡ä»¶ä¸­ï¼Œæœ‰ä¸‰ä¸ªå…³é”®ç‰ˆæœ¬é…ç½®ï¼Œå®ƒä»¬çš„å…³ç³»æ˜¯ï¼š`compatibleSdkVersion <= compileSdkVersion <= targetSdkVersion`ã€‚
    
    json
    
    json
    
    å¤åˆ¶
    
    ```
    {
      "app": {
        "compileSdkVersion": 9, // ç¼–è¯‘æ—¶ä½¿ç”¨çš„SDKç‰ˆæœ¬ï¼Œéœ€ä¸DevEco Studioæ”¯æŒçš„ç‰ˆæœ¬åŒ¹é…
        "compatibleSdkVersion": 9, // åº”ç”¨å…¼å®¹çš„æœ€ä½SDKç‰ˆæœ¬ï¼Œä¸èƒ½é«˜äºcompileSdkVersion[8](@ref)
        "targetSdkVersion": 9 // åº”ç”¨ç›®æ ‡SDKç‰ˆæœ¬ï¼Œé€šå¸¸ä¸compileSdkVersionä¸€è‡´
      }
    }
    ```
    
    **å¸¸è§å‘ç‚¹**ï¼šå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯è¾ƒæ–°çš„DevEco Studioï¼ˆå¦‚5.0ï¼‰ï¼Œä½†æƒ³å…¼å®¹æ—§ç‰ˆç³»ç»Ÿï¼ˆå¦‚HarmonyOS 4.0ï¼‰ï¼Œéœ€è¦æ‰‹åŠ¨åœ¨ `build-profile.json5`ä¸­å°† `compileSdkVersion`å’Œ `targetSdkVersion`è®¾ç½®ä¸º `9`ï¼Œå¦åˆ™å¯èƒ½æ— æ³•åœ¨æ—§ç‰ˆæœ¬è®¾å¤‡ä¸Šå®‰è£…æˆ–è¿è¡Œ
    
    ã€‚
    
3. **å¤„ç†APIå…¼å®¹æ€§é—®é¢˜**
    
    å³ä½¿è®¾ç½®äº†å…¼å®¹ç‰ˆæœ¬ï¼Œåœ¨ä»£ç ä¸­ä¹Ÿè¦æ³¨æ„é«˜ç‰ˆæœ¬APIåœ¨ä½ç‰ˆæœ¬ç³»ç»Ÿä¸Šçš„å…¼å®¹æ€§ã€‚
    
    - **æŸ¥è¯¢APIçº§åˆ«**ï¼šåœ¨åä¸ºå®˜æ–¹æ–‡æ¡£ä¸­ï¼Œæ¯ä¸ªArkTS APIéƒ½ä¼šæ³¨æ˜å…¶èµ·å§‹APIç‰ˆæœ¬ã€‚
        
    - **è¿è¡Œæ—¶åˆ¤æ–­**ï¼šåœ¨ä»£ç ä¸­é€šè¿‡åˆ¤æ–­ç³»ç»ŸAPIç‰ˆæœ¬æ¥å†³å®šæ˜¯å¦è°ƒç”¨æ–°æ¥å£æˆ–ä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆã€‚
        
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    import systemVersion from '@ohos.system.version';
    
    let apiVersion = systemVersion.getApiVersion();
    if (apiVersion >= 9) {
      // ä½¿ç”¨ API 9 åŠä»¥ä¸Šç‰ˆæœ¬çš„æ–°ç‰¹æ€§
      this.useNewFeature();
    } else {
      // ä½¿ç”¨å…¼å®¹æ—§ç‰ˆæœ¬çš„å®ç°
      this.useCompatibleMethod();
    }
    [11](@ref)
    ```
    

### æé«˜ä¸€æ¬¡ä¸Šæ‰‹æˆåŠŸç‡çš„å®æ“å»ºè®®

1. **ç¯å¢ƒæ­å»ºé˜¶æ®µ**
    
    - æ ¹æ®æ‚¨çš„ç›®æ ‡ç”¨æˆ·ä¸»è¦ä½¿ç”¨çš„é¸¿è’™ç³»ç»Ÿç‰ˆæœ¬ï¼Œé€‰æ‹©**åŒ¹é…çš„DevEco Studioç‰ˆæœ¬**ã€‚å¦‚æœä¸ç¡®å®šï¼Œé€‰æ‹©LTSï¼ˆé•¿æœŸæ”¯æŒï¼‰ç‰ˆæœ¬é€šå¸¸æ›´ç¨³å¦¥ã€‚
        
    - å®‰è£…å®Œæˆåï¼Œåœ¨SDK Managerä¸­åªä¸‹è½½é¡¹ç›®éœ€è¦çš„SDKç‰ˆæœ¬ï¼Œé¿å…å¤šç‰ˆæœ¬å¹²æ‰°ã€‚
        
    
2. **çœŸæœºè°ƒè¯•é˜¶æ®µ**
    
    - **ç¡®ä¿çœŸæœºç³»ç»Ÿç‰ˆæœ¬ >= é¡¹ç›®è®¾ç½®çš„ `compatibleSdkVersion`**ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé¡¹ç›® `compatibleSdkVersion`è®¾ä¸º9ï¼Œåˆ™æ‰‹æœºç³»ç»Ÿè‡³å°‘éœ€ä¸ºHarmonyOS 4.0
        
        ã€‚
        
    - å¦‚æœé‡åˆ° `The compatibleSdkVersion 9 cannot be smaller than version 10 declared`è¿™ç±»é”™è¯¯ï¼Œé¦–è¦æ£€æŸ¥é¡¹å°±æ˜¯ `build-profile.json5`ä¸­çš„ç‰ˆæœ¬é…ç½®æ˜¯å¦æ»¡è¶³ä¸Šè¿°å…³ç³»
        
        ã€‚
        
    
3. **åˆ©ç”¨å®˜æ–¹å·¥å…·**
    
    - ä½¿ç”¨DevEco Studioå†…ç½®çš„ **APIå˜æ›´åŠ©æ‰‹ï¼ˆAPI Change Assistantï¼‰**ã€‚å®ƒå¯ä»¥å¸®åŠ©æ‰«æä»£ç ï¼Œè¯†åˆ«å½“å‰å·¥ç¨‹ä½¿ç”¨çš„APIåœ¨ä¸åŒSDKç‰ˆæœ¬é—´çš„è¡Œä¸ºå˜æ›´ï¼Œå¹¶ç»™å‡ºé€‚é…æŒ‡å¯¼ï¼Œå¼ºçƒˆæ¨èåœ¨å‡çº§SDKç‰ˆæœ¬æ—¶ä½¿ç”¨
        
        ã€‚
        
    

å¸Œæœ›è¿™äº›è¯¦å°½çš„è§£é‡Šå’Œå®æ“å»ºè®®èƒ½åˆ‡å®å¸®åŠ©æ‚¨å’Œæ‚¨çš„å­¦ä¹ è€…ç»•å¼€é™·é˜±ï¼Œé¡ºåˆ©ä¸Šæ‰‹ã€‚å¦‚æœæ‚¨åœ¨ç‰¹å®šç¯èŠ‚é‡åˆ°æ›´å…·ä½“çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/consumer_huawei_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_51cto_com.ico)

æº

ç”³è¯·æœåŠ¡å¡ç‰‡èµ„è´¨çš„å…·ä½“ææ–™æ¸…å•å’Œå®¡æ ¸å‘¨æœŸæ˜¯å¤šä¹…ï¼Ÿ

å¦‚ä½•å¿«é€Ÿæ£€æµ‹å½“å‰é¡¹ç›®æ˜¯å¦å­˜åœ¨SDKç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜ï¼Ÿ

DevEco Studioä¸åŒç‰ˆæœ¬å¯¹é«˜å¾·åœ°å›¾HarmonyOS SDKçš„å…¼å®¹æ€§å·®å¼‚æœ‰å“ªäº›ï¼Ÿ

è¿˜æ˜¯å¼€å‘å·¥å…·çš„é€‰æ‹©ï¼Œåœ¨ç»ˆç«¯æ˜¯æ— æ³•è‡ªåŠ¨è°ƒè¯•çš„ï¼Œåªèƒ½é€šè¿‡devecoåŒæ­¥æ„å»ºé¢„è§ˆç­‰ç»†èŠ‚ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ï¼Œå¾ˆå¤šæ¨¡å‹å­¦ä¹ äº†å¼€å‘è§„èŒƒçŸ¥è¯†åº“è¿˜æ˜¯ä¼šä¸€ééçŠ¯é”™ï¼Œå¦‚ä½•é¿å…æˆä¸ºé”™è¯¯æ¶ˆæ¯æ¬è¿å·¥ä¹Ÿè¦åœ¨æ•™ç¨‹è®²æ¸…å¹¶æ¨èå…è´¹æˆ–è€…æ€§ä»·æ¯”ï¼Œæ•ˆç‡æœ€é«˜çš„æ¨¡å‹ï¼Œæ¯”è¾ƒä»¥ä¸‹çš„è¡¨ç° opencode,çµç ï¼Œcodebuddy,trae,catpaw,vscodeå«æ’ä»¶,k2,glm4.6v

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶18ç§’)

å¥½çš„ï¼Œç”¨æˆ·è¿™æ¬¡é—®çš„æ˜¯é¸¿è’™å¼€å‘ä¸­éå¸¸å®é™…çš„ä¸¤ä¸ªç—›ç‚¹ï¼šä¸€æ˜¯DevEco Studioåœ¨ç»ˆç«¯æ— æ³•è‡ªåŠ¨è°ƒè¯•ã€éœ€è¦åŒæ­¥æ„å»ºé¢„è§ˆçš„æ“ä½œç»†èŠ‚ï¼›äºŒæ˜¯å¦‚ä½•é¿å…è¢«ä½è´¨é‡AIç¼–ç¨‹åŠ©æ‰‹è¯¯å¯¼ï¼Œå¹¶å¸Œæœ›æˆ‘å¯¹æ¯”è¯„æµ‹å¤šæ¬¾ä¸»æµç¼–ç åŠ©æ‰‹ã€‚ä»å¯¹è¯å†å²çœ‹ï¼Œç”¨æˆ·æ˜æ˜¾æ˜¯ä½æ³¨é‡å®æ“çš„å¼€å‘è€…ï¼Œå·²ç»è¸©è¿‡ä¸€äº›å‘ï¼Œç°åœ¨éœ€è¦èƒ½çœŸæ­£æå‡æ•ˆç‡çš„è§£å†³æ–¹æ¡ˆã€‚

ç”¨æˆ·æåˆ°çš„ç¬¬ä¸€ä¸ªé—®é¢˜å¾ˆå…³é”®â€”â€”å¾ˆå¤šæ•™ç¨‹ç¡®å®åªè®²ç†æƒ³åŒ–æµç¨‹ï¼Œä½†å®é™…åœ¨ç»ˆç«¯æˆ–å‘½ä»¤è¡Œç¯å¢ƒä¸‹ï¼ŒDevEco Studioçš„å®æ—¶é¢„è§ˆå’Œè°ƒè¯•åŠŸèƒ½ç¡®å®æ— æ³•ç›´æ¥ä½¿ç”¨ã€‚è¿™éœ€è¦è¯¦ç»†è¯´æ˜å˜é€šæ–¹æ¡ˆã€‚ç¬¬äºŒä¸ªé—®é¢˜æ›´æ™®éï¼Œç°åœ¨AIç¼–ç å·¥å…·æ³›æ»¥ï¼Œä½†è´¨é‡å‚å·®ä¸é½ï¼Œå¼€å‘è€…å¾ˆå®¹æ˜“è¢«é”™è¯¯å»ºè®®å¸¦åï¼Œéœ€è¦ç»™å‡ºå¯é çš„ç­›é€‰æ–¹æ³•ã€‚

æˆ‘æ‰“ç®—å…ˆç³»ç»Ÿè§£å†³DevEco Studioçš„ç»ˆç«¯è°ƒè¯•å±€é™é—®é¢˜ï¼Œç»™å‡ºå…·ä½“çš„å·¥ä½œæµå»ºè®®ï¼›ç„¶åé‡ç‚¹åˆ†æå¦‚ä½•ç”„åˆ«ä¼˜è´¨AIç¼–ç¨‹åŠ©æ‰‹ï¼Œå¹¶åŸºäºå®é™…ä½“éªŒå¯¹æ¯”å‡ æ¬¾ä¸»æµå·¥å…·ã€‚è¿™äº›å·¥å…·ä¸­ï¼Œæœ‰äº›æˆ‘æœ‰æ·±å…¥ä½¿ç”¨ç»éªŒï¼Œæœ‰äº›åˆ™å‚è€ƒäº†å¯é çš„ç¤¾åŒºåé¦ˆã€‚

å¯¹äºå¼€å‘å·¥å…·çš„é€‰æ‹©ï¼Œåä¸ºå®˜æ–¹æ¨å‡ºçš„DevEco Studioæ˜¯ä¸“ä¸ºé¸¿è’™åº”ç”¨åŠå…ƒæœåŠ¡å¼€å‘çš„é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰ï¼Œæä¾›AIè¾…åŠ©ç¼–ç¨‹ã€ç¼–è¯‘æ„å»ºã€UIå®æ—¶é¢„è§ˆã€ä»£ç è°ƒè¯•ã€æ€§èƒ½è°ƒä¼˜ã€æ¨¡æ‹Ÿå™¨ç­‰åŠŸèƒ½

ã€‚å…¶AIè¾…åŠ©ç¼–ç¨‹å·¥å…·DevEco CodeGenieæ”¯æŒæ™ºèƒ½é—®ç­”ã€ä»£ç ç”Ÿæˆã€é¡µé¢ç”Ÿæˆã€ä¸‡èƒ½å¡ç‰‡ç”Ÿæˆç­‰èƒ½åŠ›ã€‚

å…³äºç»ˆç«¯æ— æ³•è‡ªåŠ¨è°ƒè¯•çš„é—®é¢˜ï¼Œå…¶æ ¸å¿ƒåœ¨äºDevEco Studioçš„æŸäº›åŠŸèƒ½ï¼ˆå¦‚UIå®æ—¶é¢„è§ˆã€ç«¯äº‘ååŒè°ƒè¯•ï¼‰éœ€è¦IDEå±‚é¢çš„æ·±åº¦é›†æˆæ”¯æŒï¼Œè¿™åœ¨çº¯ç»ˆç«¯æˆ–å‘½ä»¤è¡Œç¯å¢ƒä¸‹ç¡®å®å­˜åœ¨å±€é™

ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹æ¯”è¡¨æ ¼ï¼Œå¸®åŠ©ä½ æ›´æ¸…æ™°åœ°ç†è§£ä¸åŒè°ƒè¯•æ–¹å¼çš„é€‚ç”¨åœºæ™¯å’Œæ“ä½œè¦ç‚¹ã€‚

|è°ƒè¯•æ–¹å¼|é€‚ç”¨åœºæ™¯|å…³é”®æ“ä½œ/å‘½ä»¤|ä¼˜ç‚¹|å±€é™|
|---|---|---|---|---|
|**çœŸæœºè°ƒè¯•**â€‹|éœ€è¦æµ‹è¯•åº”ç”¨åœ¨çœŸå®è®¾å¤‡ä¸Šçš„æ€§èƒ½å’Œè¡¨ç°|1. è®¾å¤‡é€šè¿‡USBè¿æ¥ç”µè„‘å¹¶å¼€å¯è°ƒè¯•æ¨¡å¼  <br>2. åœ¨DevEco Studioä¸­é€‰æ‹©ç›®æ ‡è®¾å¤‡è¿è¡Œæˆ–è°ƒè¯•|æœ€çœŸå®çš„è¿è¡Œç¯å¢ƒï¼Œèƒ½å‡†ç¡®åæ˜ åº”ç”¨è¡Œä¸º|éœ€è¦ç‰©ç†è®¾å¤‡ï¼Œä¸”éƒ¨åˆ†è®¾å¤‡è°ƒè¯•å¯èƒ½éœ€è¦ç­¾å|
|**æ¨¡æ‹Ÿå™¨è°ƒè¯•**â€‹|å¿«é€ŸéªŒè¯UIå’ŒåŸºç¡€åŠŸèƒ½ï¼Œæ— çœŸæœºæ—¶|1. åœ¨DevEco Studioçš„Device Managerä¸­åˆ›å»ºå¹¶å¯åŠ¨æ¨¡æ‹Ÿå™¨  <br>2. é€‰æ‹©è¯¥æ¨¡æ‹Ÿå™¨è¿è¡Œåº”ç”¨|æ–¹ä¾¿å¿«æ·ï¼Œå¯æ¨¡æ‹Ÿå¤šç§è®¾å¤‡å‹å·å’Œç³»ç»Ÿç‰ˆæœ¬|æ— æ³•å®Œå…¨æ¨¡æ‹Ÿæ‰€æœ‰ç¡¬ä»¶ä¼ æ„Ÿå™¨å’Œè¡Œä¸º|
|**ç»ˆç«¯æ„å»º**â€‹|éœ€è¦è‡ªåŠ¨åŒ–æ„å»ºã€æŒç»­é›†æˆ(CI)ç¯å¢ƒ|åœ¨é¡¹ç›®æ ¹ç›®å½•ä½¿ç”¨ `./gradlew assembleDebug`æˆ– `./gradlew assembleRelease`ç­‰å‘½ä»¤è¿›è¡Œç¼–è¯‘|é€‚åˆè‡ªåŠ¨åŒ–è„šæœ¬å’Œæµç¨‹|æ— æ³•ç›´æ¥è¿›è¡Œäº¤äº’å¼è°ƒè¯•å’Œå®æ—¶é¢„è§ˆ|

ä¸ºäº†æå‡å¼€å‘æ•ˆç‡ï¼Œé€‰æ‹©åˆé€‚çš„AIç¼–ç¨‹åŠ©æ‰‹è‡³å…³é‡è¦ã€‚ä¸åŒçš„AIç¼–ç¨‹åŠ©æ‰‹åœ¨é¸¿è’™å¼€å‘æ–¹é¢çš„è¡¨ç°ç¡®å®å­˜åœ¨å·®å¼‚ã€‚ä»¥ä¸‹æ˜¯å¯¹æ¯”è¡¨æ ¼ï¼Œå¸®åŠ©ä½ æ ¹æ®è‡ªèº«æƒ…å†µé€‰æ‹©ã€‚

|å·¥å…·åç§°|ç±»å‹/å½’å±|é¸¿è’™çŸ¥è¯†åº“æ—¶æ•ˆæ€§ä¸å‡†ç¡®æ€§|ä¸»è¦ä¼˜åŠ¿|ä¸»è¦å±€é™|æ€§ä»·æ¯”æ¨è|
|---|---|---|---|---|---|
|**çµç  (Lingma)**â€‹|é˜¿é‡Œäº‘/é€šä¹‰ç çµ|å¯¹ArkTSå’Œé¸¿è’™APIæ”¯æŒè¾ƒå¥½ï¼ŒçŸ¥è¯†åº“æ›´æ–°è¾ƒå¿«|å¯¹å›½å†…å¼€å‘è€…ç”Ÿæ€å…¼å®¹æ€§å¥½ï¼Œæç¤ºè´¨é‡è¾ƒé«˜|æ·±åº¦é›†æˆäºç‰¹å®šIDEï¼Œé€šç”¨æ€§ç¨å¼±|â˜…â˜…â˜…â˜…â˜† (ç¤¾åŒºç‰ˆå…è´¹)|
|**é€šä¹‰Xcode (opencode)**â€‹|é˜¿é‡Œäº‘|å¯¹é¸¿è’™å¼€å‘æœ‰ä¸€å®šæ”¯æŒ|ä¸é˜¿é‡Œäº‘æœåŠ¡é›†æˆå¯èƒ½æœ‰ä¸€å®šä¾¿åˆ©|åœ¨é¸¿è’™å¼€å‘åœºæ™¯çš„ä¸“ä¸šæ€§ä¸Šå¯èƒ½ä¸å¦‚çµç |â˜…â˜…â˜…â˜†â˜† (é€šå¸¸æœ‰å…è´¹é¢åº¦)|
|**CodeGeeX (CodeBuddy)**â€‹|æ¸…åå¤§å­¦|çŸ¥è¯†åº“å¯èƒ½æœªä¸“é—¨é’ˆå¯¹æœ€æ–°é¸¿è’™APIä¼˜åŒ–|å¼€æºå…è´¹ï¼ŒåŸºç¡€ä»£ç è¡¥å…¨èƒ½åŠ›ä¸é”™|åœ¨ç†è§£å’Œç”Ÿæˆæ¶‰åŠé¸¿è’™æ–°ç‰¹æ€§çš„å¤æ‚ä»£ç æ—¶å¯èƒ½ä¸å¤Ÿå‡†ç¡®|â˜…â˜…â˜…â˜†â˜† (å…è´¹)|
|**VS Code é¸¿è’™æ’ä»¶**â€‹|å¾®è½¯/åä¸º|å®˜æ–¹ç»´æŠ¤ï¼Œå‡†ç¡®æ€§ç›¸å¯¹æœ‰ä¿éšœ|åœ¨VS Codeå†…æä¾›é¸¿è’™é¡¹ç›®åˆ›å»ºã€ç¼–è¯‘ã€è°ƒè¯•ç­‰åŠŸèƒ½|åŠŸèƒ½æ·±åº¦å¯èƒ½ä¸å¦‚DevEco Studioï¼Œè°ƒè¯•ä½“éªŒå¯èƒ½æœ‰å·®å¼‚|â˜…â˜…â˜…â˜…â˜† (å…è´¹)|
|**æ™ºè°±æ¸…è¨€ (GLM-4.6V)**â€‹|æ™ºè°±AI|é€šç”¨å¤§æ¨¡å‹ï¼Œé¸¿è’™ä¸“ä¸šçŸ¥è¯†éœ€é€šè¿‡æç¤ºè¯å¼•å¯¼|å¤šæ¨¡æ€èƒ½åŠ›å¼ºï¼Œå¯å¤„ç†å›¾åƒã€æ–‡æ¡£ç­‰|ç”Ÿæˆé¸¿è’™ä»£ç æ—¶å¯èƒ½éœ€è¦æ›´ç»†è‡´çš„æç¤ºè¯çº¦æŸ|éœ€å‚è€ƒå®˜æ–¹å®šä»·|
|**K2**â€‹|é˜¶è·ƒæ˜Ÿè¾°|è¾ƒæ–°çš„æ¨¡å‹ï¼Œé¸¿è’™ä¸“é¡¹ä¼˜åŒ–ä¿¡æ¯ä¸è¯¦|åœ¨é€šç”¨ä»£ç ä»»åŠ¡ä¸Šè¡¨ç°å€¼å¾—å…³æ³¨|åœ¨é¸¿è’™å¼€å‘è¿™ä¸€å‚ç›´é¢†åŸŸçš„è¡¨ç°æœ‰å¾…æ›´å¤šéªŒè¯|éœ€å‚è€ƒå®˜æ–¹å®šä»·|
|**Cusp**â€‹|æ— ç•ŒAI|ä¿¡æ¯ä¸è¯¦|ä¿¡æ¯ä¸è¯¦|ä¿¡æ¯ä¸è¯¦|ä¿¡æ¯ä¸è¯¦|
|**CatPaw (çˆªçˆª)**â€‹|ä¸ªäººå¼€å‘è€…|çŸ¥è¯†åº“è§„æ¨¡å’Œæ›´æ–°é€Ÿåº¦å¯èƒ½æœ‰é™|è½»é‡ã€å¿«é€Ÿ|å¤„ç†å¤æ‚æˆ–æœ€æ–°çš„é¸¿è’™å¼€å‘ä»»åŠ¡æ—¶å¯é æ€§å¯èƒ½ä¸è¶³|(å…è´¹)|

### ğŸ’¡ å¦‚ä½•é¿å…æˆä¸ºâ€œé”™è¯¯æ¶ˆæ¯æ¬è¿å·¥â€

ä¸ºäº†é¿å…è¢«ä¸å‡†ç¡®çš„AIå»ºè®®è¯¯å¯¼ï¼Œä½ å¯ä»¥å‚è€ƒä»¥ä¸‹ç­–ç•¥ï¼š

1. **äº¤å‰éªŒè¯æ˜¯å…³é”®**ï¼šæ— è®ºAIåŠ©æ‰‹ç»™å‡ºä»€ä¹ˆå»ºè®®ï¼Œå°¤å…¶æ˜¯æ¶‰åŠå…³é”®é€»è¾‘æˆ–æ–°APIä½¿ç”¨æ—¶ï¼Œ**åŠ¡å¿…æŸ¥é˜…å®˜æ–¹æ–‡æ¡£**
    
    è¿›è¡Œæ ¸å®ã€‚å®˜æ–¹æ–‡æ¡£æ˜¯å‡†ç¡®ä¿¡æ¯çš„æœ€ç»ˆæ¥æºã€‚
    
2. **å»ºç«‹çŸ¥è¯†åŸºå‡†**ï¼šèŠ±äº›æ—¶é—´å­¦ä¹ é¸¿è’™å¼€å‘çš„åŸºç¡€æ¦‚å¿µå’Œæ ¸å¿ƒæ¡†æ¶
    
    ã€‚å½“ä½ å¯¹åŸºæœ¬åŸç†æœ‰äº†è§£åï¼Œæ›´å®¹æ˜“åˆ¤æ–­AIç”Ÿæˆçš„ä»£ç æ˜¯å¦åˆç†ã€‚
    
3. **åˆ©ç”¨å®˜æ–¹èµ„æº**ï¼šåä¸ºå¼€å‘è€…è”ç›Ÿå®˜ç½‘æä¾›äº†ä¸°å¯Œçš„å­¦ä¹ èµ„æºï¼ŒåŒ…æ‹¬æŠ€æœ¯æ–‡æ¡£ã€Codelabsã€ç¤ºä¾‹ä»£ç å’Œç¤¾åŒºè®¨è®º
    
    ã€‚è¿™äº›æ˜¯æ¯”å¤§å¤šæ•°AIæ¨¡å‹è®­ç»ƒæ•°æ®æ›´å¯é çš„ä¿¡æ¯æºã€‚
    
4. **ç†è§£è€Œéå¤åˆ¶**ï¼šä½¿ç”¨AIåŠ©æ‰‹æ—¶ï¼Œè¯•ç€å»ç†è§£å®ƒç”Ÿæˆçš„ä»£ç é€»è¾‘å’Œæ„å›¾ã€‚å¦‚æœçœ‹ä¸æ‡‚ï¼Œå°±æŠŠå®ƒå½“ä½œä¸€ä¸ªé«˜çº§çš„ä»£ç æœç´¢å·¥å…·ï¼Œç„¶åè‡ªå·±å»ææ‡‚å®ƒã€‚
    
5. **ä¿æŒå·¥å…·æ›´æ–°**ï¼šæ— è®ºæ˜¯DevEco Studioè¿˜æ˜¯AIç¼–ç¨‹åŠ©æ‰‹æ’ä»¶ï¼Œéƒ½å°½é‡ä¿æŒæœ€æ–°ç‰ˆæœ¬ï¼Œä»¥è·å¾—æœ€å¥½çš„åŠŸèƒ½æ”¯æŒå’ŒçŸ¥è¯†æ›´æ–°
    
    ã€‚
    

å¸Œæœ›è¿™ä»½è¯¦ç»†çš„æŒ‡å—èƒ½å¸®åŠ©ä½ æ›´é¡ºç•…åœ°è¿›è¡Œé¸¿è’™å¼€å‘ã€‚å¦‚æœä½ åœ¨å…·ä½“æ“ä½œä¸­é‡åˆ°æ›´ç»†è‡´çš„é—®é¢˜ï¼Œæ¬¢è¿éšæ—¶æå‡ºï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/wapbaike_baidu_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/cn_chinadaily_com_cn.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/www_informat_cn.ico)

æº

Codex â€“ OpenAIâ€™s coding agent åœ¨vscodeä¸­å…è´¹å—

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶5ç§’)

å¥½çš„ï¼Œç”¨æˆ·è¿™æ¬¡é—®çš„æ˜¯Codexåœ¨VSCodeä¸­æ˜¯å¦å…è´¹ï¼Œè¿™éœ€è¦æ˜ç¡®åŒºåˆ†äº§å“å½’å±å’Œå…è´¹æ”¿ç­–ã€‚ä»å¯¹è¯å†å²çœ‹ï¼Œç”¨æˆ·ä¹‹å‰ä¸€ç›´åœ¨ç ”ç©¶é¸¿è’™å¼€å‘ç›¸å…³çš„AIå·¥å…·ï¼Œç°åœ¨è½¬å‘äº†è§£OpenAIçš„ç¼–ç¨‹å·¥å…·ï¼Œå¯èƒ½æ˜¯æƒ³å¯»æ‰¾æ›´é«˜æ•ˆçš„å¼€å‘è¾…åŠ©æ–¹æ¡ˆã€‚

æˆ‘è€ƒè™‘å…ˆç›´æ¥å›ç­”æ ¸å¿ƒé—®é¢˜ï¼Œç„¶åè§£é‡Šæ¸…æ¥šäº§å“å…³ç³»ï¼Œæœ€åæä¾›å®ç”¨çš„æ›¿ä»£æ–¹æ¡ˆã€‚æ ¹æ®æœç´¢ç»“æœï¼ŒCodexæœ¬èº«æ˜¯OpenAIçš„æŠ€æœ¯æ¨¡å‹ï¼Œè€Œå®ƒåœ¨VSCodeä¸­çš„ä¸»è¦ä½“ç°å½¢å¼æ˜¯GitHub Copilotã€‚éœ€è¦æ˜ç¡®è¯´æ˜Codexä¸ç›´æ¥ä½œä¸ºç‹¬ç«‹äº§å“åœ¨VSCodeä¸­æä¾›å…è´¹æœåŠ¡

ï¼Œä½†åŸºäºå…¶æŠ€æœ¯çš„GitHub Copilotæœ‰å…è´¹é€‰é¡¹ã€‚

æˆ‘æ‰“ç®—å…ˆé€šè¿‡å¯¹æ¯”è¡¨æ ¼ç›´è§‚å±•ç¤ºä¸åŒCopilotè®¡åˆ’çš„åŒºåˆ«ï¼Œè¿™æ ·ç”¨æˆ·èƒ½å¿«é€ŸæŠ“ä½é‡ç‚¹ã€‚è¡¨æ ¼å¯ä»¥åŒ…å«ä»·æ ¼ã€æ ¸å¿ƒé™åˆ¶å’Œé€‚ç”¨åœºæ™¯ç­‰å…³é”®ä¿¡æ¯ã€‚ç„¶åéœ€è¦è¯¦ç»†è§£é‡Šå…è´¹ç‰ˆçš„å…·ä½“é™åˆ¶ï¼Œæ¯”å¦‚2000æ¬¡è¡¥å…¨å’Œ50æ¡èŠå¤©çš„æœˆé¢åº¦

ï¼Œå¸®åŠ©ç”¨æˆ·åˆ¤æ–­æ˜¯å¦å¤Ÿç”¨ã€‚

æ¥ç€è¦ä»‹ç»å…è´¹ç‰ˆå¯ç”¨çš„æ¨¡å‹ï¼ˆGPT-4oå’ŒClaude 3.5 Sonnetï¼‰

ä»¥åŠå¤šæ–‡ä»¶ç¼–è¾‘ç­‰å…³é”®åŠŸèƒ½ã€‚æœ€åè¡¥å……å­¦ç”Ÿç­‰ç‰¹å®šç¾¤ä½“å¯èƒ½è·å¾—æ›´ä¼˜æƒ æ¡ä»¶çš„ä¿¡æ¯ï¼Œå¹¶ç®€è¦è¯´æ˜Codexä¸Copilotçš„æŠ€æœ¯å…³ç³»ï¼Œè®©å›ç­”æ›´å®Œæ•´ã€‚

å…³äºOpenAI Codexåœ¨VSCodeä¸­æ˜¯å¦å…è´¹çš„é—®é¢˜ï¼Œå…³é”®åœ¨äºåŒºåˆ†å…¶åº•å±‚æŠ€æœ¯ä¸å…·ä½“äº§å“ã€‚ç®€å•æ¥è¯´ï¼Œ**OpenAI Codexæ¨¡å‹æœ¬èº«å¹¶ä¸ç›´æ¥ä½œä¸ºä¸€æ¬¾ç‹¬ç«‹çš„ã€å…è´¹çš„äº§å“åœ¨VSCodeä¸­æä¾›**ï¼Œä½†åŸºäºCodexæŠ€æœ¯æ„å»ºçš„ã€æœ€è‘—åçš„VSCodeæ’ä»¶â€”â€”**GitHub Copilotï¼Œç¡®å®æä¾›äº†å…è´¹ä½¿ç”¨å±‚çº§**

ã€‚

ä¸‹é¢è¿™ä¸ªè¡¨æ ¼èƒ½å¸®ä½ å¿«é€Ÿäº†è§£GitHub Copilotçš„ä¸åŒè®¡åˆ’ã€‚

|åŠŸèƒ½ç‰¹æ€§|GitHub Copilot Free (å…è´¹ç‰ˆ)|GitHub Copilot Pro (ä¸“ä¸šç‰ˆ)|GitHub Copilot Business (å•†ä¸šç‰ˆ)|
|---|---|---|---|
|**ä»·æ ¼**â€‹|**å…è´¹**|æ¯æœˆ10ç¾å…ƒï¼ˆæˆ–æ¯å¹´100ç¾å…ƒï¼‰|æ¯ä½ç”¨æˆ·æ¯æœˆ19ç¾å…ƒ|
|**ä»£ç è¡¥å…¨**â€‹|æ¯æœˆ**2000æ¬¡**|**æ— é™åˆ¶**|**æ— é™åˆ¶**|
|**èŠå¤©è¯·æ±‚**â€‹|æ¯æœˆ**50æ¡**|**æ— é™åˆ¶**|**æ— é™åˆ¶**|
|**å¯ç”¨æ¨¡å‹**â€‹|GPT-4o, Claude 3.5 Sonnet|å¢åŠ Google Gemini 1.5 Pro, OpenAI o1ç³»åˆ—ç­‰|å¢åŠ Google Gemini 1.5 Pro, OpenAI o1ç³»åˆ—ç­‰|
|**æ ¸å¿ƒåœºæ™¯**â€‹|ä¸ªäººå­¦ä¹ ã€å°å‹é¡¹ç›®ã€ä½é¢‘ä½¿ç”¨|ä¸“ä¸šå¼€å‘è€…ã€å¤§å‹é¡¹ç›®ã€é«˜é¢‘éœ€æ±‚|å›¢é˜Ÿåä½œã€ä¼ä¸šç®¡ç†ã€å®‰å…¨åˆè§„|

### ğŸ’¡ å…è´¹ç‰ˆä½¿ç”¨è¯¦è§£

GitHub Copilot Freeæ˜¯ä¸€ä¸ªéå¸¸å‹å¥½çš„èµ·ç‚¹ï¼Œè®©ä½ èƒ½ä»¥é›¶æˆæœ¬ä½“éªŒAIç¼–ç¨‹åŠ©æ‰‹çš„æ ¸å¿ƒåŠŸèƒ½ã€‚

- **å¦‚ä½•å¼€å¯**ï¼šä½ åªéœ€è¦ä¸€ä¸ªGitHubè´¦æˆ·ã€‚åœ¨VSCodeä¸­å®‰è£…GitHub Copilotæ‰©å±•åï¼Œç‚¹å‡»æ’ä»¶å›¾æ ‡ï¼Œé€‰æ‹©â€œSign in to Use GitHub Copilot for Freeâ€å¹¶ç™»å½•ä½ çš„GitHubè´¦æˆ·å³å¯æ¿€æ´»
    
    ã€‚
    
- **åŠŸèƒ½ä½“éªŒ**ï¼šå…è´¹ç‰ˆæ”¯æŒ**ä»£ç è‡ªåŠ¨è¡¥å…¨**å’Œ**èŠå¤©å¯¹è¯**ä¸¤å¤§æ ¸å¿ƒåŠŸèƒ½ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥æé—®ç¼–ç¨‹é—®é¢˜ã€è§£é‡Šä»£ç ã€ä¿®å¤é”™è¯¯ï¼Œç”šè‡³é€šè¿‡â€œCopilot Editsâ€åŠŸèƒ½å¯¹å¤šä¸ªæ–‡ä»¶è¿›è¡ŒååŒç¼–è¾‘
    
    ã€‚
    
- **é¢åº¦è€ƒé‡**ï¼šæ¯æœˆ2000æ¬¡è¡¥å…¨å’Œ50æ¡èŠå¤©å¯¹äº**ç¼–ç¨‹å…¥é—¨ã€è¯¾ç¨‹å­¦ä¹ æˆ–å¶å°”è¿›è¡Œå°å‹é¡¹ç›®å¼€å‘**çš„ç”¨æˆ·æ¥è¯´ï¼Œé€šå¸¸æ˜¯è¶³å¤Ÿçš„
    
    ã€‚ä½†å¦‚æœä½ æ˜¯ä¸€åå…¨èŒå¼€å‘è€…ï¼Œè¿™ä¸ªé¢åº¦å¯èƒ½å‡ å¤©å°±ä¼šç”¨å®Œã€‚
    

### ğŸ”„ å¦‚ä½•é€‰æ‹©

ç»“åˆä¸Šé¢çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªèº«æƒ…å†µåšå‡ºé€‰æ‹©ï¼š

1. **å¦‚æœä½ æ˜¯å­¦ç”Ÿã€æ•™å¸ˆæˆ–çŸ¥åå¼€æºé¡¹ç›®çš„ç»´æŠ¤è€…**ï¼šä½ æœ‰æœºä¼šç”³è¯·åˆ°**å®Œå…¨å…è´¹çš„GitHub Copilot Proè´¦æˆ·**ï¼Œäº«å—æ— é™åˆ¶çš„ä½¿ç”¨é¢åº¦
    
    ã€‚è¯·æŸ¥é˜…GitHubå®˜æ–¹æ•™è‚²ç¦åˆ©æˆ–å¼€æºé¡¹ç›®è®¡åˆ’äº†è§£è¯¦æƒ…ã€‚
    
2. **å¦‚æœä½ æ˜¯ç¼–ç¨‹æ–°æ‰‹æˆ–è½»åº¦ä½¿ç”¨è€…**ï¼šå¼ºçƒˆå»ºè®®ä» **GitHub Copilot Free**â€‹ å¼€å§‹ã€‚å®ƒæ²¡æœ‰æˆæœ¬ï¼Œè¶³ä»¥å¸®åŠ©ä½ ç†Ÿæ‚‰AIç¼–ç¨‹çš„æµç¨‹ï¼Œå¹¶åˆ¤æ–­å…¶å¯¹ä½ çš„å®é™…ä»·å€¼ã€‚
    
3. **å¦‚æœä½ æ˜¯ä¸“ä¸šå¼€å‘è€…æˆ–é‡åº¦ç”¨æˆ·**ï¼šå¦‚æœå…è´¹ç‰ˆé¢åº¦æ— æ³•æ»¡è¶³ä½ çš„æ—¥å¸¸å¼€å‘éœ€æ±‚ï¼Œå‡çº§åˆ° **GitHub Copilot Pro**â€‹ æ˜¯æ€§ä»·æ¯”å¾ˆé«˜çš„é€‰æ‹©ã€‚æ— é™åˆ¶çš„é¢åº¦ã€æ›´å¿«çš„å“åº”é€Ÿåº¦ä»¥åŠæ›´å¤šæ¨¡å‹é€‰æ‹©ï¼Œèƒ½æ˜¾è‘—æå‡å¼€å‘æ•ˆç‡
    
    ã€‚
    

å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ åšå‡ºæ˜æ™ºçš„å†³å®šï¼å¦‚æœä½ å¯¹æŸä¸ªç‰¹å®šç¼–ç¨‹åœºæ™¯ä¸‹çš„ä½¿ç”¨æœ‰æ›´å¤šç–‘é—®ï¼Œæˆ‘å¾ˆä¹æ„æä¾›æ›´å…·ä½“çš„åˆ†æã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/juejin_cn.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/www_bilibili_com.ico)

æº

å·²ç»å®‰è£…çš„åŒ…åŒ…æ‹¬äº‘ç«¯çš„ï¼Œæ˜¯å¦è¿˜èƒ½ä¿®æ”¹åŒ…åï¼Œé«˜å¾·é¸¿è’™çš„å¼€å‘æœ‰é™åˆ¶ç”¨äº‘ç«¯çš„å—ï¼Ÿè¿™äº›ç»†èŠ‚éƒ½è¦ç»§ç»­åœ¨æ•™ç¨‹ä¸­å®Œå–„

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶7ç§’)

å¥½çš„ï¼Œç”¨æˆ·ç°åœ¨æ˜¯åœ¨ç»§ç»­æ·±å…¥æ¢è®¨é¸¿è’™åº”ç”¨å¼€å‘ä¸­çš„ä¸¤ä¸ªå…³é”®ç»†èŠ‚ï¼šå·²å®‰è£…åº”ç”¨çš„åŒ…åä¿®æ”¹å¯èƒ½æ€§ï¼Œä»¥åŠé«˜å¾·åœ°å›¾SDKå¯¹äº‘ç«¯æœåŠ¡çš„ä¾èµ–é™åˆ¶ã€‚ä»å¯¹è¯å†å²çœ‹ï¼Œç”¨æˆ·åº”è¯¥æ˜¯åœ¨å¼€å‘ä¸€ä¸ªé›†æˆé«˜å¾·åœ°å›¾çš„é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹ï¼Œå¹¶ä¸”å¯¹å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„å®é™…é—®é¢˜éå¸¸å…³æ³¨ã€‚

ç”¨æˆ·å¯èƒ½å·²ç»æŒ‰ç…§ä¹‹å‰çš„æ•™ç¨‹è¿›è¡Œäº†åˆæ­¥å¼€å‘ï¼Œä½†åœ¨å®é™…æµ‹è¯•æˆ–éƒ¨ç½²é˜¶æ®µé‡åˆ°äº†åŒ…åç®¡ç†å’Œäº‘ç«¯æœåŠ¡é›†æˆçš„å›°æƒ‘ã€‚taç‰¹åˆ«å¼ºè°ƒ"è¿™äº›ç»†èŠ‚éƒ½è¦ç»§ç»­åœ¨æ•™ç¨‹ä¸­å®Œå–„"ï¼Œè¯´æ˜éœ€è¦éå¸¸å…·ä½“ã€å¯æ“ä½œçš„æŒ‡å¯¼ï¼Œè€Œä¸ä»…ä»…æ˜¯ç†è®ºè¯´æ˜ã€‚

æˆ‘éœ€è¦é‡ç‚¹è§£å†³ä¸¤ä¸ªæ ¸å¿ƒé—®é¢˜ï¼šä¸€æ˜¯åŒ…åä¿®æ”¹åœ¨åº”ç”¨å‘å¸ƒå‰åçš„ä¸åŒå¤„ç†æ–¹å¼ï¼Œç‰¹åˆ«æ˜¯å·²ç»å…³è”äº‘ç«¯æœåŠ¡çš„åº”ç”¨ï¼›äºŒæ˜¯é«˜å¾·é¸¿è’™SDKåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å¯¹äº‘ç«¯æœåŠ¡çš„å®é™…ä¾èµ–ç¨‹åº¦å’Œé™åˆ¶ã€‚

é¦–å…ˆå…³äºåŒ…åä¿®æ”¹ï¼Œæ ¹æ®æœç´¢ç»“æœ

æ˜ç¡®æŒ‡å‡ºå·²ä¸Šçº¿çš„åº”ç”¨"ä¸èƒ½ä¿®æ”¹åŒ…åï¼Œè¦ä¿®æ”¹åªèƒ½åˆ é™¤é‡å»º"ã€‚è¿™æ„å‘³ç€å¦‚æœåº”ç”¨å·²ç»é€šè¿‡åä¸ºAppGallery Connectï¼ˆAGCï¼‰åˆ†å‘ï¼ŒåŒ…åå°±æˆä¸ºäº†å”¯ä¸€æ ‡è¯†ã€‚ä¸è¿‡æåˆ°äº†å¼€å‘é˜¶æ®µå¯ä»¥é€šè¿‡ä¿®æ”¹app.json5å’Œbuild.profile.json5æ¥è°ƒæ•´åŒ…åã€‚è¿™é‡Œéœ€è¦åŒºåˆ†å¼€å‘æœŸå’Œå‘å¸ƒåçš„ä¸åŒå¤„ç†æ–¹æ¡ˆã€‚

å…³äºé«˜å¾·SDKçš„äº‘ç«¯é™åˆ¶ï¼Œ

æ˜¾ç¤ºé«˜å¾·é¸¿è’™SDKæœ¬èº«éœ€è¦ä¾èµ–äº‘ç«¯æœåŠ¡æä¾›åœ°å›¾æ•°æ®ã€è·¯å¾„è§„åˆ’ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚ä½†æåˆ°äº†ä¸€ä¸ªå…³é”®é—®é¢˜ï¼šåœ¨æŸäº›ç½‘ç»œç¯å¢ƒä¸‹è®¿é—®äº‘å‡½æ•°å¯èƒ½å‡ºç°å¼‚å¸¸ã€‚è¿™è¯´æ˜è™½ç„¶é«˜å¾·SDKéœ€è¦äº‘ç«¯æœåŠ¡ï¼Œä½†å¯èƒ½å­˜åœ¨ç½‘ç»œé€‚é…æˆ–é…ç½®è¦æ±‚ã€‚

æˆ‘è¿˜æ³¨æ„åˆ°

æåˆ°åä¸ºäº‘å¼€å‘æœåŠ¡çš„ä¸€äº›é™åˆ¶ï¼Œæ¯”å¦‚é¢„åŠ è½½ç¼“å­˜å¤§å°é™åˆ¶ã€å­˜å‚¨å®ä¾‹å‘½åè§„èŒƒç­‰ï¼Œè¿™äº›è™½ç„¶ä¸ç›´æ¥å…³è”é«˜å¾·SDKï¼Œä½†å¯¹å¼€å‘é›†æˆäº‘ç«¯åŠŸèƒ½çš„é¸¿è’™åº”ç”¨æœ‰å‚è€ƒä»·å€¼ã€‚

éœ€è¦å‘ç”¨æˆ·å¼ºè°ƒï¼ŒåŒ…åä¿®æ”¹çš„å…³é”®æ—¶é—´èŠ‚ç‚¹æ˜¯åº”ç”¨å‘å¸ƒå‰ï¼Œä¸€æ—¦ä¸Šçº¿å°±åªèƒ½é€šè¿‡åˆ›å»ºæ–°åº”ç”¨çš„æ–¹å¼è§£å†³ã€‚è€Œé«˜å¾·SDKçš„äº‘ç«¯ä¾èµ–æ˜¯åŠŸèƒ½æ€§çš„ï¼Œä¸»è¦å½±å“ç¦»çº¿ä½¿ç”¨åœºæ™¯ï¼Œéœ€è¦æå‰è§„åˆ’å¥½ç½‘ç»œè¯·æ±‚çš„å¤„ç†é€»è¾‘ã€‚

ç†è§£æ‚¨å¯¹é¸¿è’™åº”ç”¨å¼€å‘ä¸­åŒ…åä¿®æ”¹å’Œäº‘ç«¯æœåŠ¡é›†æˆçš„ç»†èŠ‚å…³æ³¨ã€‚ä¸‹é¢æˆ‘å°†ç»“åˆé«˜å¾·åœ°å›¾SDKçš„ä½¿ç”¨ï¼Œä¸ºæ‚¨å®Œå–„è¿™äº›å…³é”®ç»†èŠ‚ã€‚

### ğŸ“¦ ä¿®æ”¹åŒ…åçš„é™åˆ¶ä¸ç­–ç•¥

åœ¨é¸¿è’™åº”ç”¨å¼€å‘ä¸­ï¼Œä¿®æ”¹åŒ…åéœ€è¦æ ¹æ®åº”ç”¨æ˜¯å¦å·²å‘å¸ƒåˆ°åä¸ºåº”ç”¨å¸‚åœºï¼ˆAppGallery Connectï¼Œç®€ç§°AGCï¼‰æ¥é‡‡å–ä¸åŒçš„ç­–ç•¥ã€‚

- **åº”ç”¨æœªä¸Šæ¶AGC**ï¼šåœ¨å¼€å‘é˜¶æ®µï¼Œæ‚¨å¯ä»¥ç›¸å¯¹è‡ªç”±åœ°ä¿®æ”¹åŒ…åã€‚ä¸»è¦æ¶‰åŠä¿®æ”¹é¡¹ç›®ä¸­ `entry/src/main/module.json5`ï¼ˆæˆ–æ—©æœŸç‰ˆæœ¬çš„ `config.json`ï¼‰æ–‡ä»¶é‡Œçš„ `bundleName`å­—æ®µï¼Œä»¥åŠå¯èƒ½éœ€è¦æ›´æ–°å·¥ç¨‹ç­¾åé…ç½®ï¼ˆ`build-profile.json5`ä¸­çš„ `signingConfigs`ï¼‰
    
    ã€‚
    
- **åº”ç”¨å·²ä¸Šæ¶AGC**ï¼š**ä¸€æ—¦åº”ç”¨åœ¨AGCä¸Šæ¶ï¼Œå…¶åŒ…åï¼ˆbundleNameï¼‰é€šå¸¸æ— æ³•ç›´æ¥ä¿®æ”¹**
    
    ã€‚è¿™æ˜¯å› ä¸ºåŒ…åæ˜¯åº”ç”¨åœ¨ç³»ç»Ÿä¸­çš„å”¯ä¸€æ ‡è¯†ã€‚å¦‚æœå¿…é¡»ä¿®æ”¹ï¼Œå¸¸è§„åšæ³•æ˜¯ï¼š
    
    1. åœ¨AGCä¸­**åˆ›å»ºä¸€ä¸ªæ–°çš„åº”ç”¨**ï¼Œå¹¶è®¾ç½®æ–°çš„åŒ…åã€‚
        
    2. å°†åŸæœ‰åº”ç”¨çš„ä»£ç ã€èµ„æºåŠä¸šåŠ¡æ•°æ®ï¼ˆè‹¥é€‚ç”¨ï¼‰è¿ç§»è‡³æ–°åº”ç”¨å·¥ç¨‹ã€‚
        
    3. ä½¿ç”¨æ–°çš„ç­¾åè¯ä¹¦ï¼ˆæˆ–æ²¿ç”¨æ—§è¯ä¹¦ï¼Œä½†éœ€å…³è”æ–°åº”ç”¨ï¼‰é‡æ–°ç¼–è¯‘æ‰“åŒ…ï¼Œå¹¶æäº¤æ–°åº”ç”¨è‡³AGCå®¡æ ¸ä¸Šæ¶ã€‚
        
    
    å¯¹äºå·²å…³è”äº‘ç«¯æœåŠ¡çš„åº”ç”¨ï¼Œä¿®æ”¹åŒ…åæ„å‘³ç€äº‘ç«¯æœåŠ¡é…ç½®ï¼ˆå¦‚é«˜å¾·åœ°å›¾çš„API Keyï¼‰éœ€è¦æ›´æ–°å…³è”åˆ°æ–°çš„AppIDï¼ˆç”±æ–°åŒ…åå’Œç­¾åè¯ä¹¦ç”Ÿæˆï¼‰ã€‚**å› æ­¤ï¼Œå¼ºçƒˆå»ºè®®åœ¨åº”ç”¨é¦–æ¬¡ä¸Šæ¶å‰ï¼ŒåŠ¡å¿…ç¡®è®¤å¹¶è®¾ç½®å¥½æœ€ç»ˆçš„åŒ…åã€‚**
    

### â˜ï¸ é«˜å¾·åœ°å›¾SDKçš„äº‘ç«¯ä¾èµ–ä¸é™åˆ¶

é«˜å¾·åœ°å›¾é¸¿è’™ç‰ˆSDKçš„åŠŸèƒ½å®ç°ä¾èµ–äºå…¶äº‘ç«¯æœåŠ¡ï¼Œäº†è§£è¿™äº›é™åˆ¶å¯¹åº”ç”¨å¼€å‘è‡³å…³é‡è¦ã€‚

|ç‰¹æ€§ç±»åˆ«|äº‘ç«¯ä¾èµ–ä¸é™åˆ¶è¯´æ˜|å¼€å‘å»ºè®®|
|---|---|---|
|**æ ¸å¿ƒåœ°å›¾æœåŠ¡**â€‹|åœ°å›¾ç“¦ç‰‡ã€å«æ˜Ÿå›¾ã€å®æ—¶è·¯å†µã€è·¯å¾„è§„åˆ’ï¼ˆé©¾è½¦ã€æ­¥è¡Œã€éª‘è¡Œç­‰ï¼‰ã€åœ°ç‚¹æœç´¢ï¼ˆPOIï¼‰ã€åœ°ç†/é€†åœ°ç†ç¼–ç ç­‰æ ¸å¿ƒåŠŸèƒ½éœ€è¦ç½‘ç»œè¿æ¥ä»é«˜å¾·æœåŠ¡å™¨è·å–æ•°æ®<br><br>ã€‚|åº”ç”¨éœ€è¯·æ±‚ç½‘ç»œæƒé™ï¼ˆ`ohos.permission.INTERNET`ï¼‰ã€‚åœ¨æ— ç½‘ç»œæˆ–å¼±ç½‘ç¯å¢ƒä¸‹ï¼Œè¿™äº›åŠŸèƒ½å°†æ— æ³•ä½¿ç”¨æˆ–æ•°æ®é™ˆæ—§ï¼Œéœ€åœ¨UIä¸Šåšå¥½å‹å¥½æç¤ºã€‚|
|**SDKé‰´æƒ**â€‹|ä½¿ç”¨é«˜å¾·åœ°å›¾SDKå‰ï¼Œå¿…é¡»è°ƒç”¨ `MapsInitializer.setApiKey("æ‚¨çš„Key")`è¿›è¡Œé‰´æƒ<br><br>ã€‚API Keyä¸åº”ç”¨çš„AppIDï¼ˆç”±åŒ…åå’Œç­¾åä¿¡æ¯ç”Ÿæˆï¼‰ç»‘å®šã€‚**å¦‚æœä¿®æ”¹åŒ…åæˆ–ç­¾åè¯ä¹¦ï¼Œä¼šå¯¼è‡´AppIDå˜æ›´ï¼ŒåŸæœ‰çš„API Keyå°†å¤±æ•ˆ**ï¼Œå¿…é¡»åœ¨é«˜å¾·æ§åˆ¶å°ä¸ºæ–°çš„AppIDç”³è¯·æ–°çš„API Keyã€‚|ç¡®ä¿ç­¾åå’ŒåŒ…åç¨³å®šã€‚è‹¥éœ€å˜æ›´ï¼Œæå‰åœ¨é«˜å¾·æ§åˆ¶å°é…ç½®æ–°çš„API Keyã€‚|
|**ç¦»çº¿æ”¯æŒ**â€‹|é«˜å¾·åœ°å›¾SDK**ä¸æ”¯æŒ**å®Œå…¨çš„ç¦»çº¿åœ°å›¾åŒ…ä¸‹è½½å’Œç¦»çº¿è·¯å¾„è§„åˆ’ã€‚è¿™æ„å‘³ç€åœ¨æ— ç½‘ç»œç¯å¢ƒä¸‹ï¼Œåœ°å›¾å¯èƒ½æ— æ³•æ˜¾ç¤ºæˆ–ä»…æ˜¾ç¤ºå·²ç¼“å­˜çš„åŸºæœ¬å›¾å—ï¼Œæœç´¢ã€å¯¼èˆªç­‰åŠŸèƒ½åŸºæœ¬ä¸å¯ç”¨ã€‚|å¯¹äºæœ‰å¼ºç¦»çº¿ä½¿ç”¨éœ€æ±‚çš„åœºæ™¯ï¼Œéœ€è¦è¯„ä¼°é«˜å¾·SDKæ˜¯å¦æ»¡è¶³è¦æ±‚ï¼Œæˆ–è€ƒè™‘å…¶ä»–å¤‡ç”¨æ–¹æ¡ˆã€‚|
|**æœåŠ¡é…é¢**â€‹|é«˜å¾·åœ°å›¾æœåŠ¡é€šå¸¸è®¾æœ‰**æ¯æ—¥è°ƒç”¨é…é¢é™åˆ¶**<br><br>ã€‚è¶…å‡ºé…é¢åï¼Œç›¸å…³APIè°ƒç”¨ä¼šå¤±è´¥ã€‚|åœ¨é«˜å¾·æ§åˆ¶å°å…³æ³¨è°ƒç”¨é‡ç»Ÿè®¡ï¼Œé¢„ä¼°ä¸šåŠ¡é‡å¹¶ç”³è¯·è°ƒæ•´é…é¢ã€‚åœ¨ä»£ç ä¸­å®ç°é€‚å½“çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶ã€‚|

### âš™ï¸ é›†æˆäº‘ç«¯æœåŠ¡çš„é€šç”¨æ³¨æ„äº‹é¡¹

é™¤äº†é«˜å¾·åœ°å›¾ï¼Œé›†æˆå…¶ä»–äº‘ç«¯æœåŠ¡ï¼ˆå¦‚åä¸ºAGCçš„å„é¡¹æœåŠ¡ã€è‡ªæœ‰æœåŠ¡å™¨ç­‰ï¼‰ä¹Ÿéœ€æ³¨æ„ï¼š

- **ç½‘ç»œæƒé™ä¸å…¼å®¹æ€§**ï¼šç¡®ä¿åº”ç”¨å£°æ˜äº†ç½‘ç»œæƒé™ã€‚ç‰¹åˆ«æ³¨æ„**é¸¿è’™åº”ç”¨æ‰“åŒ…ååœ¨æŸäº›ç‰¹å®šç½‘ç»œç¯å¢ƒä¸‹ï¼ˆå¦‚åˆ‡æ¢WIFIæˆ–ä½¿ç”¨æ•°æ®æµé‡ï¼‰å¯èƒ½å‡ºç°çš„äº‘å‡½æ•°/æ¥å£è®¿é—®å¤±è´¥é—®é¢˜**ã€‚è¿™å¯èƒ½éœ€è¦æ£€æŸ¥ç½‘ç»œå®‰å…¨æ€§é…ç½®ã€æœåŠ¡å™¨åŸŸåçš„å¤‡æ¡ˆçŠ¶æ€ï¼ˆé’ˆå¯¹å›½å†…æœåŠ¡å™¨ï¼‰ä»¥åŠè¯ä¹¦é“¾çš„å®Œæ•´æ€§
    
    ã€‚
    
- **äº‘ç«¯æ•°æ®ä¸è®¾å¤‡ç¼“å­˜**ï¼šå¯ä»¥åˆ©ç”¨åä¸ºæä¾›çš„**äº‘å¼€å‘æœåŠ¡ï¼ˆCloud Foundation Kitï¼‰**ï¼Œä¾‹å¦‚å…¶**é¢„åŠ è½½**åŠŸèƒ½ï¼Œå°†é¡µé¢æ‰€éœ€çš„é™æ€èµ„æºï¼ˆå¦‚å›¾ç‰‡ã€æ–‡æœ¬ï¼‰æå‰ç¼“å­˜åˆ°è®¾å¤‡æœ¬åœ°ï¼Œæå‡åº”ç”¨é¦–å¼€é€Ÿåº¦å’Œç‰¹å®šåœºæ™¯ï¼ˆå¦‚èŠ‚æ—¥ä¸»é¢˜ï¼‰çš„ä½“éªŒ
    
    ã€‚è¯·æ³¨æ„ï¼Œäº‘å­˜å‚¨ç­‰æœåŠ¡å¯¹å­˜å‚¨å®ä¾‹åç§°ã€æ–‡ä»¶å¤§å°å’Œåç§°å­—ç¬¦ç­‰æœ‰ç›¸åº”é™åˆ¶ã€‚
    

å¸Œæœ›è¿™äº›è¡¥å……çš„ç»†èŠ‚èƒ½å¸®åŠ©æ‚¨æ›´é¡ºåˆ©åœ°è¿›è¡Œå¼€å‘ã€‚å¦‚æœæ‚¨åœ¨ç‰¹å®šç¯èŠ‚é‡åˆ°æ›´å…·ä½“çš„é—®é¢˜ï¼Œæ¬¢è¿éšæ—¶æå‡ºï¼

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_51cto_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/ost_51cto_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/segmentfault_com.ico)

æº

åŒ…åä½•æ—¶åº”è¯¥ç”¨ç®€å•ç‰ˆçš„ï¼Œä½•æ—¶åº”è¯¥ç”¨å¸¦ç­¾åç‰ˆçš„éƒ½éœ€è¯´æ˜

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶5ç§’)

å¥½çš„ï¼Œç”¨æˆ·è¯¢é—®çš„æ˜¯å…³äºé¸¿è’™åº”ç”¨å¼€å‘ä¸­åŒ…åä½¿ç”¨çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯ç®€å•ç‰ˆåŒ…åå’Œå¸¦ç­¾åç‰ˆåŒ…åçš„åŒºåˆ«å’Œé€‚ç”¨åœºæ™¯ã€‚è¿™åº”è¯¥æ˜¯ä¸€ä½æ­£åœ¨å­¦ä¹ æˆ–è¿›è¡Œé¸¿è’™åº”ç”¨å¼€å‘çš„å¼€å‘è€…ï¼Œå¯èƒ½åœ¨æ‰“åŒ…æˆ–å‘å¸ƒåº”ç”¨æ—¶é‡åˆ°äº†é€‰æ‹©å›°éš¾ã€‚

ä»é—®é¢˜æ¥çœ‹ï¼Œç”¨æˆ·éœ€è¦æ˜ç¡®çš„æŒ‡å¯¼æ¥åˆ¤æ–­åœ¨ä¸åŒå¼€å‘é˜¶æ®µè¯¥ä½¿ç”¨å“ªç§åŒ…åé…ç½®ã€‚æˆ‘éœ€è¦ä»åŸºç¡€æ¦‚å¿µè®²èµ·ï¼Œæ˜ç¡®åŒºåˆ†ä¸¤ç§åŒ…åçš„æœ¬è´¨å·®å¼‚ï¼Œç„¶åé€šè¿‡å…·ä½“åœºæ™¯è¯´æ˜ä½•æ—¶è¯¥ç”¨å“ªç§ã€‚

æˆ‘çœ‹åˆ°çš„æœç´¢ç»“æœæä¾›äº†å¾ˆå¥½çš„æŠ€æœ¯èƒŒæ™¯ã€‚

è¯¦ç»†ä»‹ç»äº†ç­¾åæœºåˆ¶å’Œä¸åŒç±»å‹ç­¾åçš„ç”¨é€”ï¼Œåˆ™æä¾›äº†å®Œæ•´çš„æ‰“åŒ…å’Œå‘å¸ƒæµç¨‹è¯´æ˜ã€‚è¿™äº›èµ„æ–™å¯ä»¥å¸®åŠ©æˆ‘æ„å»ºä¸€ä¸ªæ¸…æ™°çš„å¯¹æ¯”æ¡†æ¶ã€‚

æˆ‘æ‰“ç®—å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼æ¥ç›´è§‚å±•ç¤ºæ ¸å¿ƒåŒºåˆ«ï¼Œè¿™æ ·ç”¨æˆ·èƒ½å¿«é€ŸæŠ“ä½å…³é”®ç‚¹ã€‚è¡¨æ ¼å¯ä»¥åŒ…å«åŒ…åç±»å‹ã€æ ¸å¿ƒç‰¹å¾ã€ä¸»è¦ç”¨é€”ã€å…¸å‹åœºæ™¯å’Œå…³é”®çº¦æŸç­‰ç»´åº¦ã€‚

ç„¶åæˆ‘éœ€è¦åˆ†åœºæ™¯è¯¦ç»†è¯´æ˜ã€‚å¼€å‘è°ƒè¯•é˜¶æ®µæ˜¾ç„¶åº”è¯¥ç”¨è‡ªåŠ¨ç”Ÿæˆçš„è°ƒè¯•ç­¾ååŒ…åï¼Œå› ä¸ºé‡ç‚¹æ˜¯å¿«é€Ÿè¿­ä»£ã€‚å†…éƒ¨åˆ†å‘é˜¶æ®µå°±æ¯”è¾ƒå¤æ‚äº†ï¼Œ

æåˆ°äº†è®¾å¤‡æ•°é‡é™åˆ¶å’Œæ‰‹åŠ¨ç®¡ç†çš„é—®é¢˜ï¼Œè¿™é‡Œéœ€è¦è¯¦ç»†è¯´æ˜ã€‚æ­£å¼ä¸Šæ¶é˜¶æ®µåˆ™å¿…é¡»ä½¿ç”¨å‘å¸ƒè¯ä¹¦ç­¾åçš„åŒ…åã€‚

å’Œå…³äºåŒ…åå”¯ä¸€æ€§å’Œæ ‡è¯†ä½œç”¨çš„è¯´æ˜ä¹Ÿå¾ˆé‡è¦ï¼Œéœ€è¦èå…¥å›ç­”ä¸­ã€‚è€Œæåˆ°çš„å¤šç›®æ ‡äº§ç‰©æ„å»ºå¯¹äºéœ€è¦å¤šä¸ªå˜ä½“ç‰ˆæœ¬çš„é«˜çº§åœºæ™¯å¾ˆæœ‰å‚è€ƒä»·å€¼ã€‚

æˆ‘è¿˜éœ€è¦æé†’ç”¨æˆ·ä¸€äº›å¸¸è§çš„é™·é˜±ï¼Œæ¯”å¦‚åŒ…åå†²çªã€ç­¾åæ–‡ä»¶ç®¡ç†ç­‰é—®é¢˜ï¼Œè¿™äº›åœ¨

çš„"é¿å‘æŒ‡å—"ä¸­æœ‰æåŠã€‚æœ€åç»™å‡ºä¸€ä¸ªæ¸…æ™°çš„å†³ç­–æµç¨‹å›¾å’Œæ€»ç»“æ€§çš„é€‰æ‹©å»ºè®®åº”è¯¥ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚

åœ¨é¸¿è’™åº”ç”¨å¼€å‘ä¸­ï¼Œç†è§£â€œç®€å•ç‰ˆâ€åŒ…åå’Œâ€œå¸¦ç­¾åç‰ˆâ€åŒ…åçš„åŒºåˆ«åŠé€‚ç”¨åœºæ™¯è‡³å…³é‡è¦ï¼Œè¿™ç›´æ¥å…³ç³»åˆ°åº”ç”¨èƒ½å¦æˆåŠŸå®‰è£…ã€è°ƒè¯•å’Œå‘å¸ƒã€‚ç®€å•æ¥è¯´ï¼Œ**â€œç®€å•ç‰ˆâ€åŒ…åä¸»è¦ç”¨äºæ—©æœŸå¼€å‘å’ŒçœŸæœºè°ƒè¯•**ï¼Œè€Œ**â€œå¸¦ç­¾åç‰ˆâ€åŒ…ååˆ™ç”¨äºåº”ç”¨çš„å†…éƒ¨åˆ†å‘å’Œæ­£å¼ä¸Šæ¶**ã€‚

ä¸ºäº†è®©ä½ å¿«é€ŸæŠŠæ¡å…¨è²Œï¼Œä¸‹è¡¨æ¸…æ™°åœ°å±•ç¤ºäº†ä¸¤è€…çš„æ ¸å¿ƒåŒºåˆ«ä¸é€‚ç”¨åœºæ™¯ã€‚

|ç‰¹æ€§ç»´åº¦|ç®€å•ç‰ˆåŒ…å (è°ƒè¯•ç­¾å)|å¸¦ç­¾åç‰ˆåŒ…å (å‘å¸ƒç­¾å)|
|---|---|---|
|**æ ¸å¿ƒç‰¹å¾**â€‹|åŒ…å + **è°ƒè¯•è¯ä¹¦/Profile**â€‹|åŒ…å + **å‘å¸ƒè¯ä¹¦/Profile**â€‹|
|**ä¸»è¦ç”¨é€”**â€‹|**å¼€å‘é˜¶æ®µ**ï¼šå¿«é€ŸçœŸæœºè°ƒè¯•ã€åŠŸèƒ½éªŒè¯|**åˆ†å‘é˜¶æ®µ**ï¼šåº”ç”¨å¸‚åœºä¸Šæ¶ã€ä¼ä¸šå†…éƒ¨åˆ†å‘|
|**å…¸å‹åœºæ™¯**â€‹|- ä½¿ç”¨DevEco Studioç›´æ¥è¿è¡Œåˆ°æ‰‹æœº  <br>- å¼€å‘å›¢é˜Ÿå†…éƒ¨æµ‹è¯•|- æäº¤è‡³AppGallery Connectå®¡æ ¸  <br>- ç”Ÿæˆ.hapåŒ…ä¾›ç‰¹å®šè®¾å¤‡ç»„å®‰è£…|
|**å¯†é’¥ç®¡ç†**â€‹|ç”±DevEco Studio**è‡ªåŠ¨ç”Ÿæˆå’Œç®¡ç†**ï¼Œé€šå¸¸åœ¨ç”¨æˆ·ç›®å½•ä¸‹|å¼€å‘è€…æ‰‹åŠ¨åœ¨AGCå¹³å°ç”³è¯·ï¼Œ**éœ€å¦¥å–„å¤‡ä»½**â€‹|
|**è®¾å¤‡é™åˆ¶**â€‹|ä»…é™åœ¨**å¼€å¯äº†USBè°ƒè¯•çš„æµ‹è¯•è®¾å¤‡**ä¸Šå®‰è£…|ä¾èµ–Profileæ–‡ä»¶ï¼š**ä¸Šæ¶å¸‚åœºåˆ™æ— é™åˆ¶ï¼›å†…éƒ¨åˆ†å‘åˆ™é™åˆ¶è®¾å¤‡**â€‹|
|**å®‰å…¨æ€§ä¸èº«ä»½**â€‹|æ ‡è¯†**å¼€å‘è€…èº«ä»½**ï¼Œç”¨äºè°ƒè¯•ç¯å¢ƒ|æ ‡è¯†**åº”ç”¨å‘å¸ƒè€…èº«ä»½**ï¼Œç”¨äºæ­£å¼ç¯å¢ƒ|

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¦ç»†çœ‹çœ‹å‡ ä¸ªå…³é”®åœºæ™¯ä¸‹çš„å…·ä½“æ“ä½œå’Œæ³¨æ„äº‹é¡¹ã€‚

### ğŸ’» å¼€å‘ä¸è°ƒè¯•é˜¶æ®µï¼ˆä½¿ç”¨ç®€å•ç‰ˆåŒ…åï¼‰

å½“ä½ å¤„äºç¼–ç å’ŒåŠŸèƒ½éªŒè¯é˜¶æ®µæ—¶ï¼Œç›®æ ‡æ˜¯**å¿«é€Ÿå°†åº”ç”¨å®‰è£…åˆ°çœŸæœºä¸Šè¿›è¡Œè°ƒè¯•**ã€‚

- **æ“ä½œæµç¨‹**ï¼šåœ¨DevEco Studioä¸­ï¼Œé…ç½®å¥½é¡¹ç›®åï¼Œé€šå¸¸åªéœ€ç”¨USBçº¿è¿æ¥æ‰‹æœºå¹¶å¼€å¯è°ƒè¯•æ¨¡å¼ï¼Œç„¶åç‚¹å‡»è¿è¡ŒæŒ‰é’®ã€‚IDEä¼šè‡ªåŠ¨ä¸ºä½ å®Œæˆç­¾åæ­¥éª¤ï¼Œå°†åº”ç”¨å®‰è£…åˆ°æ‰‹æœº
    
    ã€‚
    
- **åº•å±‚åŸç†**ï¼šDevEco Studioä¼šä¸ºä½ è‡ªåŠ¨ç”Ÿæˆä¸€å¥—è°ƒè¯•è¯ä¹¦å’ŒProfileæ–‡ä»¶ã€‚è¿™ä¸ªè°ƒè¯•Profileé€šå¸¸å·²ç»åŒ…å«äº†å½“å‰è¿æ¥çš„æµ‹è¯•è®¾å¤‡ä¿¡æ¯ï¼Œå› æ­¤åº”ç”¨å¯ä»¥ç›´æ¥å®‰è£…
    
    ã€‚
    
- **æ³¨æ„äº‹é¡¹**ï¼šç”¨è¿™ç§æ–¹å¼æ‰“åŒ…çš„åº”ç”¨**æ— æ³•ç›´æ¥ç”¨äºåˆ†å‘**ï¼Œå› ä¸ºå®ƒä½¿ç”¨çš„æ˜¯ä¸å®‰å…¨çš„è°ƒè¯•è¯ä¹¦ï¼Œç³»ç»Ÿä¸å…è®¸å…¶å®‰è£…åˆ°æœªç»æˆæƒçš„è®¾å¤‡ä¸Šã€‚
    

### ğŸ¢ å†…éƒ¨åˆ†å‘é˜¶æ®µï¼ˆä½¿ç”¨å¸¦ç­¾åç‰ˆåŒ…åï¼‰

å½“éœ€è¦å°†åº”ç”¨æä¾›ç»™æµ‹è¯•å›¢é˜Ÿã€å®¢æˆ·æˆ–ç”¨äºä¼ä¸šå†…éƒ¨åˆ†å‘ï¼Œä½†åˆä¸æƒ³æˆ–æ— éœ€ä¸Šæ¶å…¬å¼€åº”ç”¨å¸‚åœºæ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨å‘å¸ƒè¯ä¹¦è¿›è¡Œç­¾åã€‚

- **æ“ä½œæµç¨‹**ï¼š
    
    1. **ç”³è¯·å‘å¸ƒè¯ä¹¦**ï¼šåœ¨AppGallery Connectä¸­åˆ›å»ºåº”ç”¨ï¼Œå¹¶ç”³è¯·å‘å¸ƒè¯ä¹¦å’ŒProfileæ–‡ä»¶
        
        ã€‚
        
    2. **å·¥ç¨‹é…ç½®**ï¼šåœ¨DevEco Studioçš„`build-profile.json5`ä¸­ï¼Œé…ç½®å‘å¸ƒç­¾åè·¯å¾„å’Œå¯†ç 
        
        ã€‚
        
    3. **æ„å»ºHAPåŒ…**ï¼šé€‰æ‹©Releaseæ¨¡å¼è¿›è¡Œæ„å»ºï¼Œç”Ÿæˆç»è¿‡å‘å¸ƒç­¾åçš„.hapæ–‡ä»¶
        
        ã€‚
        
    
- **è®¾å¤‡ç®¡ç†**ï¼šè¿™æ˜¯å†…éƒ¨åˆ†å‘çš„å…³é”®ã€‚åœ¨AGCä¸Šç”³è¯·Profileæ–‡ä»¶æ—¶ï¼Œå¦‚æœé€‰æ‹©â€œå†…éƒ¨æµ‹è¯•â€ç±»å‹ï¼Œ**å¿…é¡»æ˜ç¡®æŒ‡å®šå…è®¸å®‰è£…æ­¤åº”ç”¨çš„è®¾å¤‡åˆ—è¡¨ï¼ˆæœ€å¤š100å°ï¼‰**
    
    ã€‚æ‰“åŒ…åçš„.hapæ–‡ä»¶åªèƒ½åœ¨è¿™äº›è®¾å¤‡ä¸Šå®‰è£…ã€‚
    
- **åˆ†å‘æ–¹å¼**ï¼šä½ å¯ä»¥å°†.hapæ–‡ä»¶ä¸Šä¼ åˆ°å…¬å¸æœåŠ¡å™¨æˆ–ç¬¬ä¸‰æ–¹å†…æµ‹å¹³å°ï¼ˆå¦‚è’²å…¬è‹±ï¼‰ï¼Œç„¶åé€šè¿‡äºŒç»´ç æˆ–é“¾æ¥åˆ†äº«ç»™æˆæƒç”¨æˆ·å®‰è£…
    
    ã€‚
    

### ğŸš€ æ­£å¼ä¸Šæ¶åº”ç”¨å¸‚åœºï¼ˆå¿…é¡»ä½¿ç”¨å¸¦ç­¾åç‰ˆåŒ…åï¼‰

å½“ä½ å‡†å¤‡å°†åº”ç”¨å‘å¸ƒåˆ°åä¸ºåº”ç”¨å¸‚åœºç­‰å…¬å¼€æ¸ é“æ—¶ï¼Œè¿™æ˜¯æœ€ä¸¥æ ¼çš„åœºæ™¯ã€‚

- **æ ¸å¿ƒåŒºåˆ«**ï¼šä¸å†…éƒ¨åˆ†å‘ä¸åŒï¼Œåœ¨AGCä¸Šç”³è¯·Profileæ–‡ä»¶æ—¶ï¼Œ**ç±»å‹å¿…é¡»é€‰æ‹©â€œå‘å¸ƒâ€ï¼Œæ­¤æ—¶æ— éœ€ä¹Ÿæ— æ³•ç»‘å®šå…·ä½“è®¾å¤‡åˆ—è¡¨**
    
    ã€‚è¿™ä¸ªå‘å¸ƒProfileå…è®¸åº”ç”¨å®‰è£…åœ¨ä»»ä½•è®¾å¤‡ä¸Šã€‚
    
- **æäº¤å®¡æ ¸**ï¼šæœ€ç»ˆæ‰“åŒ…ç”Ÿæˆçš„æ˜¯.appæ–‡ä»¶ï¼Œéœ€è¦æäº¤åˆ°AGCï¼Œå¹¶èµ°åº”ç”¨å¸‚åœºçš„å®¡æ ¸æµç¨‹
    
    ã€‚å®¡æ ¸é€šè¿‡åï¼Œåº”ç”¨æ‰èƒ½è¢«æ‰€æœ‰ç”¨æˆ·æœç´¢å’Œä¸‹è½½ã€‚
    

### âš ï¸ è¿›é˜¶åœºæ™¯ä¸é¿å‘æŒ‡å—

- **â€œé©¬ç”²åŒ…â€æˆ–å¤šæ¸ é“æ‰“åŒ…**ï¼šå¦‚æœä½ éœ€è¦ä¸ºåŒä¸€å¥—ä»£ç æ„å»ºå¤šä¸ªä¸åŒåŒ…åï¼ˆä¾‹å¦‚ä¸åŒæ ‡è¯†ã€é…ç½®ï¼‰çš„åº”ç”¨ï¼Œå¯ä»¥åœ¨`build-profile.json5`ä¸­é…ç½®å¤šä¸ª`products`ï¼Œæ¯ä¸ªproductæŒ‡å®šä¸åŒçš„`bundleName`å’Œå…¶ä»–è‡ªå®šä¹‰å‚æ•°ï¼Œä»è€Œå®ç°ä¸€æ¬¡æ€§æ‰“å‡ºå¤šä¸ªåº”ç”¨åŒ…
    
    ã€‚
    
- **é‡è¦æé†’**ï¼š
    
    1. **åŒ…åå”¯ä¸€æ€§**ï¼šåŒ…åæ˜¯åº”ç”¨çš„å”¯ä¸€èº«ä»½è¯ï¼Œä¸€æ—¦åœ¨AGCåˆ›å»ºåº”ç”¨å¹¶ä¸Šæ¶ï¼Œ**åŒ…åå°†æ— æ³•æ›´æ”¹**
        
        ã€‚å› æ­¤åˆå§‹è®¾å®šéå¸¸é‡è¦ã€‚
        
    2. **ç­¾åæ–‡ä»¶å¤‡ä»½**ï¼šå‘å¸ƒè¯ä¹¦å’Œç§é’¥æ˜¯åº”ç”¨çš„æ ¸å¿ƒèµ„äº§ï¼Œ**åŠ¡å¿…å¦¥å–„å¤‡ä»½**ã€‚ä¸€æ—¦ä¸¢å¤±ï¼Œä½ å°†æ— æ³•ä¸ºåº”ç”¨çš„åç»­ç‰ˆæœ¬æ›´æ–°ç­¾åï¼Œå¯¼è‡´æ— æ³•ä¸Šæ¶
        
        ã€‚
        
    3. **Profileä¸è¯ä¹¦åŒ¹é…**ï¼šç¡®ä¿åœ¨å·¥ç¨‹ä¸­é…ç½®çš„Profileæ–‡ä»¶ä¸ä½ ä½¿ç”¨çš„ç­¾åè¯ä¹¦æ˜¯åŒ¹é…çš„ï¼Œå¦åˆ™ç­¾åä¼šå¤±è´¥
        
        ã€‚
        
    

å¸Œæœ›è¿™ä»½è¯¦ç»†çš„è§£é‡Šèƒ½å¸®åŠ©ä½ æ¸…æ™°åœ°åˆ¤æ–­åœ¨é¸¿è’™åº”ç”¨å¼€å‘çš„ä¸åŒé˜¶æ®µï¼Œåº”è¯¥å¦‚ä½•é€‰æ‹©å’Œä½¿ç”¨åŒ…åä¸ç­¾åã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/bbs_huaweicloud_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/ask_dcloud_net_cn.ico)

æº

å¦‚æœæ˜¯äº‘ç«¯çš„é™¤äº†åœ¨ä»£ç é‡Œé¢è®¾ç½®ï¼Œè¿˜åº”è¯¥åœ¨åä¸ºå®˜ç½‘åšå“ªäº›è®¾ç½®ï¼Ÿå¦‚ä½•æŠŠå°è‰ºå¹³å°å¼€å‘çš„æ™ºèƒ½ä½“åŠ è¿›åº”ç”¨é‡Œï¼Œå°è‰ºå¹³å°åˆ›å»ºé«˜å¾·MCPå†å¯¼å…¥é¸¿è’™åº”ç”¨ï¼Œç”¨htmlåŠ¨æ€è®¾è®¡é‡‡ç”¨webviewæ–¹å¼åŠ è¿›åº”ç”¨è¿™äº›æ–¹å¼èƒ½å¦åŒæ—¶å­˜åœ¨ï¼Œå¦‚ä½•åŠ è¿›åº”ç”¨ä¸­ä¹Ÿæ˜¯é‡è¦éœ€è¦è¯¦ç»†å±•å¼€çš„è¯¾ç¨‹ï¼Œç»§ç»­å¼€å‘è¯¾ç¨‹

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶6ç§’)

å¥½çš„ï¼Œç”¨æˆ·æ­£åœ¨æ·±å…¥å¼€å‘é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹ï¼Œç°åœ¨å…³æ³¨çš„æ˜¯äº‘ç«¯æœåŠ¡é…ç½®å’Œæ™ºèƒ½ä½“é›†æˆçš„é«˜çº§è¯¾é¢˜ã€‚ä»å¯¹è¯å†å²çœ‹ï¼Œç”¨æˆ·å·²ç»å®Œæˆäº†åŸºç¡€å¼€å‘ç¯å¢ƒæ­å»ºã€é«˜å¾·SDKé›†æˆå’ŒåŸºç¡€åŠŸèƒ½å®ç°ï¼Œç°åœ¨éœ€è¦æ›´æ·±å…¥çš„äº‘ç«¯ååŒå’ŒAIèƒ½åŠ›æ•´åˆæŒ‡å¯¼ã€‚

ç”¨æˆ·çš„é—®é¢˜å¾ˆå…·ä½“ï¼Œä¸»è¦é›†ä¸­åœ¨ä¸‰ä¸ªå±‚é¢ï¼šäº‘ç«¯æœåŠ¡é™¤äº†ä»£ç è®¾ç½®è¿˜éœ€è¦å“ªäº›å¹³å°é…ç½®ã€å¦‚ä½•å°†å°è‰ºå¹³å°çš„æ™ºèƒ½ä½“é›†æˆåˆ°åº”ç”¨ä¸­ã€ä»¥åŠå¤šç§é›†æˆæ–¹å¼èƒ½å¦å…±å­˜ã€‚è¿™ç¡®å®æ˜¯ä¸€ä¸ªä»åŸºç¡€å¼€å‘å‘é«˜çº§åº”ç”¨è¿ˆè¿›çš„å…³é”®èŠ‚ç‚¹ã€‚

æˆ‘æ‰“ç®—å…ˆå¸®ç”¨æˆ·æ¢³ç†æ¸…æ¥šäº‘ç«¯é…ç½®çš„å®Œæ•´æµç¨‹ã€‚åä¸ºäº‘çš„é…ç½®ä¸ä»…é™äºä»£ç ï¼Œè¿˜éœ€è¦åœ¨å¼€å‘è€…å¹³å°è¿›è¡Œä¸€ç³»åˆ—è®¾ç½®ï¼Œæ¯”å¦‚æƒé™ç®¡ç†ã€æœåŠ¡æ¿€æ´»å’ŒAPIå¯†é’¥é…ç½®ã€‚è¿™äº›æ­¥éª¤ç¯ç¯ç›¸æ‰£ï¼Œç¼ºä¸€ä¸å¯

ã€‚

å¯¹äºå°è‰ºæ™ºèƒ½ä½“çš„é›†æˆï¼Œè¿™æ˜¯ä¸ªå¾ˆæœ‰ä»·å€¼çš„æ–¹å‘ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œåä¸ºç¡®å®æä¾›äº†å®Œæ•´çš„Agent Framework Kitæ¥æ”¯æŒè¿™ç§é›†æˆ

ã€‚æˆ‘éœ€è¦è¯¦ç»†è¯´æ˜å¦‚ä½•åœ¨å°è‰ºå¼€æ”¾å¹³å°åˆ›å»ºæ™ºèƒ½ä½“ï¼Œç„¶åé€šè¿‡æ ‡å‡†çš„APIæ–¹å¼åµŒå…¥åˆ°é¸¿è’™åº”ç”¨ä¸­ã€‚è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ°æ™ºèƒ½ä½“IDçš„è·å–ã€æƒé™å£°æ˜å’ŒUIç»„ä»¶çš„ä½¿ç”¨ã€‚

å…³äºå¤šç§é›†æˆæ–¹å¼çš„å…±å­˜é—®é¢˜ï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚é«˜å¾·MCPæœåŠ¡ã€å°è‰ºæ™ºèƒ½ä½“å’ŒWebViewåŠ¨æ€å†…å®¹å®Œå…¨å¯ä»¥ååŒå·¥ä½œã€‚å…³é”®åœ¨äºç†è§£å®ƒä»¬å„è‡ªçš„åº”ç”¨åœºæ™¯å’Œé›†æˆæ–¹å¼ï¼šMCPæœåŠ¡æ›´é€‚åˆåœ°å›¾ç›¸å…³åŠŸèƒ½ï¼Œå°è‰ºæ™ºèƒ½ä½“æä¾›å¯¹è¯å¼äº¤äº’ï¼Œè€ŒWebViewåˆ™é€‚åˆå±•ç¤ºå¤æ‚çš„å‰ç«¯é¡µé¢

ã€‚

æˆ‘å‡†å¤‡ç”¨è¡¨æ ¼çš„å½¢å¼å…ˆç»™ç”¨æˆ·ä¸€ä¸ªæ¸…æ™°çš„æ¦‚è§ˆï¼Œç„¶åé’ˆå¯¹æ¯ä¸ªé›†æˆæ–¹å¼æä¾›å…·ä½“çš„å®ç°æ­¥éª¤å’Œä»£ç ç¤ºä¾‹ã€‚ç‰¹åˆ«æ˜¯è¦å¼ºè°ƒæƒé™é…ç½®ã€å®‰å…¨è®¾ç½®å’Œæ€§èƒ½ä¼˜åŒ–è¿™äº›å®¹æ˜“å‡ºé”™çš„ç¯èŠ‚ã€‚

ç†è§£æ‚¨å¸Œæœ›å°†äº‘ç«¯æœåŠ¡ã€å°è‰ºæ™ºèƒ½ä½“å’Œé«˜å¾·MCPèƒ½åŠ›æ·±åº¦æ•´åˆåˆ°é¸¿è’™åº”ç”¨ä¸­ã€‚ä¸‹é¢æˆ‘å°†è¯¦ç»†è¯´æ˜åœ¨åä¸ºå®˜ç½‘çš„é…ç½®ã€å°è‰ºæ™ºèƒ½ä½“çš„æ¥å…¥æ–¹å¼ï¼Œä»¥åŠå¦‚ä½•åè°ƒå¤šç§é›†æˆæ–¹æ¡ˆã€‚

### â˜ï¸ äº‘ç«¯æœåŠ¡é…ç½®è¯¦è§£

é™¤äº†åœ¨`module.json5`ä¸­å£°æ˜æƒé™å’Œåœ¨ä»£ç ä¸­åˆå§‹åŒ–æœåŠ¡å¤–ï¼Œåœ¨åä¸ºå¼€å‘è€…è”ç›Ÿå’ŒAppGallery Connectå¹³å°çš„é…ç½®åŒæ ·å…³é”®ã€‚

1. **åœ¨åä¸ºå¼€å‘è€…è”ç›Ÿåˆ›å»ºåº”ç”¨å¹¶å¼€å¯æœåŠ¡**
    
    - ç™»å½•**åä¸ºå¼€å‘è€…è”ç›Ÿ**ã€‚
        
    - è¿›å…¥â€œç®¡ç†ä¸­å¿ƒâ€ > â€œåº”ç”¨æœåŠ¡â€ï¼Œç‚¹å‡»â€œåˆ›å»ºåº”ç”¨â€ã€‚
        
    - å¡«å†™åº”ç”¨ä¿¡æ¯ï¼ˆåŒ…åéœ€ä¸æ‚¨çš„é¡¹ç›®`bundleName`å®Œå…¨ä¸€è‡´ï¼‰ã€‚
        
    - åœ¨â€œåº”ç”¨æœåŠ¡â€åˆ—è¡¨ä¸­ï¼Œæ‰¾åˆ°å¹¶å¼€å¯æ‚¨éœ€è¦çš„æœåŠ¡ï¼Œä¾‹å¦‚ï¼š
        
        - **åœ°å›¾æœåŠ¡**ï¼šéœ€å…³è”æ‚¨åœ¨é«˜å¾·åœ°å›¾å¼€æ”¾å¹³å°ç”³è¯·çš„æœ‰æ•ˆAPI Keyã€‚
            
        - **æ¨é€æœåŠ¡**ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼šé…ç½®æœåŠ¡å™¨åœ°å€å’Œè¯ä¹¦ã€‚
            
        - **åˆ†ææœåŠ¡**ï¼šé€šå¸¸é»˜è®¤å¼€å¯ã€‚
            
        
    - **é‡ç‚¹**ï¼šåœ¨æ­¤å¤„å¼€å¯æœåŠ¡ï¼Œç›¸å½“äºåœ¨åä¸ºä¾§ä¸ºæ‚¨çš„åº”ç”¨æ³¨å†Œäº†ä½¿ç”¨è¿™äº›æœåŠ¡çš„â€œé€šè¡Œè¯â€ã€‚
        
    
2. **åœ¨AppGallery Connectè¿›è¡Œè¿è¥é…ç½®**
    
    - ç™»å½•**AppGallery Connect**ã€‚
        
    - é€‰æ‹©æ‚¨åˆšåˆ›å»ºçš„åº”ç”¨ã€‚
        
    - **é…ç½®ç­¾åè¯ä¹¦æŒ‡çº¹**ï¼šåœ¨â€œæˆ‘çš„é¡¹ç›®â€ > â€œé¡¹ç›®è®¾ç½®â€ä¸­ï¼Œæ·»åŠ æ‚¨ç”¨äºæ‰“åŒ…å‘å¸ƒåº”ç”¨çš„ç­¾åè¯ä¹¦çš„SHA256æŒ‡çº¹ã€‚**ç¡®ä¿æ­¤å¤„é…ç½®çš„æŒ‡çº¹ä¸æ‚¨åœ¨é«˜å¾·å¹³å°ç”³è¯·API Keyæ—¶ä½¿ç”¨çš„æŒ‡çº¹ä¸€è‡´**ï¼Œå¦åˆ™ä¼šå¯¼è‡´é‰´æƒå¤±è´¥
        
        ã€‚
        
    - **ç®¡ç†ä¾èµ–é¡¹**ï¼šåœ¨â€œå¢é•¿â€ > â€œä¾èµ–ç®¡ç†â€ä¸­ï¼Œå¯ä»¥æŸ¥çœ‹å’Œç®¡ç†åº”ç”¨æ‰€ä¾èµ–çš„å„ç±»æœåŠ¡Kitçš„ç‰ˆæœ¬ã€‚
        
    

### ğŸ¤– æ¥å…¥å°è‰ºå¹³å°æ™ºèƒ½ä½“

é¸¿è’™ç³»ç»Ÿæä¾›äº†`Agent Framework Kit`ï¼Œè®©åº”ç”¨å¯ä»¥æ–¹ä¾¿åœ°é›†æˆæ¥è‡ªå°è‰ºæ™ºèƒ½ä½“å¼€æ”¾å¹³å°çš„æ™ºèƒ½ä½“

ã€‚

1. **åœ¨å°è‰ºå¼€æ”¾å¹³å°åˆ›å»ºå¹¶å‘å¸ƒæ™ºèƒ½ä½“**
    
    - è®¿é—®å°è‰ºæ™ºèƒ½ä½“å¼€æ”¾å¹³å°ï¼Œä½¿ç”¨åä¸ºå¼€å‘è€…è´¦å·ç™»å½•ã€‚
        
    - æ ¹æ®æŒ‡å¼•åˆ›å»ºæ‚¨çš„æ™ºèƒ½ä½“ï¼Œä¾‹å¦‚â€œå‡ºè¡Œè§„åˆ’åŠ©æ‰‹â€ã€‚åœ¨åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œå¹³å°æ”¯æŒå¤šç§å¼€å‘æ¨¡å¼ï¼ŒåŒ…æ‹¬ç›´æ¥è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ã€æ„å»ºç»“æ„åŒ–å·¥ä½œæµï¼ˆWorkflowï¼‰ä»¥åŠå®ç°å¤šæ™ºèƒ½ä½“ååŒï¼ˆA2Aï¼‰
        
        ã€‚
        
    - é…ç½®æ™ºèƒ½ä½“çš„èƒ½åŠ›ã€è§¦å‘è¯å’Œå…ƒæ•°æ®ã€‚
        
    - å®Œæˆæµ‹è¯•åï¼Œæäº¤å®¡æ ¸å¹¶å‘å¸ƒã€‚å‘å¸ƒæˆåŠŸåï¼Œæ‚¨å°†è·å¾—ä¸€ä¸ªå”¯ä¸€çš„ **`agentId`**ã€‚
        
    
2. **åœ¨é¸¿è’™åº”ç”¨ä¸­é›†æˆæ™ºèƒ½ä½“ç»„ä»¶**
    
    - åœ¨é¡¹ç›®çš„`oh-package.json5`æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–ï¼š`"@kit.AgentFrameworkKit"`ã€‚
        
    - åœ¨éœ€è¦æ”¾ç½®æ™ºèƒ½ä½“å…¥å£çš„é¡µé¢ï¼ˆå¦‚`HomePage.ets`ï¼‰ä¸­ï¼Œä½¿ç”¨`FunctionComponent`å¹¶ä¼ å…¥`agentId`
        
        ã€‚
        
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // ç¤ºä¾‹ï¼šåœ¨é¦–é¡µæ·»åŠ æ™ºèƒ½ä½“å…¥å£
    import { FunctionComponent } from '@kit.AgentFrameworkKit';
    
    @Entry
    @Component
    struct HomePage {
      private travelAssistantAgentId: string = 'ä½ çš„å‡ºè¡ŒåŠ©æ‰‹æ™ºèƒ½ä½“AgentId'; // æ›¿æ¢ä¸ºå®é™…ID
    
      build() {
        Column() {
          // ... å…¶ä»–UIç»„ä»¶
          // æ™ºèƒ½ä½“å…¥å£ç»„ä»¶
          FunctionComponent({
            agentId: this.travelAssistantAgentId,
            onError: (err: BusinessError) => {
              console.error('æ™ºèƒ½ä½“è°ƒç”¨å¤±è´¥:', err.message);
            },
            options: {
              title: 'å‡ºè¡Œè§„åˆ’åŠ©æ‰‹', // è‡ªå®šä¹‰æ ‡é¢˜
              isShowShadow: true
            }
          })
        }
      }
    }
    ```
    
    - åœ¨`module.json5`ä¸­ç”³è¯·å¿…è¦çš„ç½‘ç»œç­‰æƒé™ã€‚
        
    

### ğŸ”„ å¤šç§é›†æˆæ–¹å¼çš„å…±å­˜ä¸ååŒ

æ‚¨æåˆ°çš„**é«˜å¾·MCPæœåŠ¡ã€å°è‰ºæ™ºèƒ½ä½“ã€HTML5åŠ¨æ€é¡µé¢**è¿™ä¸‰ç§æ–¹å¼å®Œå…¨å¯ä»¥å¹¶å­˜äºä¸€ä¸ªåº”ç”¨ä¸­ï¼Œå®ƒä»¬å„æœ‰ä¾§é‡ï¼Œå¯ä»¥å½¢æˆäº’è¡¥ã€‚

ä¸‹é¢çš„è¡¨æ ¼å¯¹æ¯”äº†è¿™ä¸‰ç§é›†æˆæ–¹å¼çš„æ ¸å¿ƒç‰¹æ€§å’Œåº”ç”¨åœºæ™¯ã€‚

|ç‰¹æ€§ç»´åº¦|**é«˜å¾· HarmonyOS SDK (MCPæœåŠ¡)**â€‹|**å°è‰ºæ™ºèƒ½ä½“ (Agent Framework Kit)**â€‹|**å†…éƒ¨ WebView (ArkWeb ç»„ä»¶)**â€‹|
|---|---|---|---|
|**æ ¸å¿ƒèƒ½åŠ›**â€‹|æä¾›**åŸç”Ÿåœ°å›¾æ¸²æŸ“ã€ç²¾å‡†å¯¼èˆªã€å®šä½**ç­‰åº•å±‚èƒ½åŠ›|æä¾›**å¯¹è¯å¼äº¤äº’ã€æ„å›¾ç†è§£ã€ä»»åŠ¡åˆ†è§£**çš„AIåŠ©æ‰‹|**æ¸²æŸ“åŠ¨æ€H5é¡µé¢**ï¼Œé€‚åˆå¤æ‚UIæˆ–é¢‘ç¹æ›´æ–°çš„å†…å®¹|
|**é›†æˆæ–¹å¼**â€‹|é€šè¿‡SDKä¾èµ–ï¼ŒAPIè°ƒç”¨|é€šè¿‡`FunctionComponent`åµŒå…¥æ™ºèƒ½ä½“å…¥å£|é€šè¿‡`Web`ç»„ä»¶åŠ è½½æœ¬åœ°æˆ–è¿œç¨‹URL|
|**ç”¨æˆ·ä½“éªŒ**â€‹|**é«˜æ€§èƒ½ã€æ— ç¼æµç•…**ï¼Œä¸ç³»ç»ŸUIä¸€è‡´|**è‡ªç„¶è¯­è¨€äº¤äº’**ï¼Œæ™ºèƒ½ä¾¿æ·|**çµæ´»æ€§é«˜**ï¼Œä½†æ€§èƒ½ä¸ä½“éªŒå¯èƒ½ç•¥ä½äºåŸç”Ÿ|
|**å…¸å‹åœºæ™¯**â€‹|æ˜¾ç¤ºåœ°å›¾ã€è·¯çº¿è§„åˆ’ã€å®æ—¶å¯¼èˆª|è¯­éŸ³æŸ¥è¯¢è·¯çº¿ã€æ™ºèƒ½æ¨èæ™¯ç‚¹ã€è§£ç­”å‡ºè¡Œé—®é¢˜|å±•ç¤ºæ´»åŠ¨ä¸“é¢˜é¡µã€ç”¨æˆ·åé¦ˆé¡µé¢ã€ç¬¬ä¸‰æ–¹æœåŠ¡é¡µ|

**ååŒå·¥ä½œæµç¤ºä¾‹**ï¼š

ä¸€ä¸ªå®Œæ•´çš„å‡ºè¡Œè§„åˆ’æµç¨‹å¯ä»¥è¿™æ ·è®¾è®¡ï¼š

1. ç”¨æˆ·é€šè¿‡**å°è‰ºæ™ºèƒ½ä½“**çš„è¯­éŸ³æˆ–æ–‡å­—è¾“å…¥ï¼šâ€œå¸®æˆ‘è§„åˆ’ä¸€ä¸ªå‘¨æœ«å»å¤åŒ—æ°´é•‡çš„è‡ªé©¾è¡Œç¨‹â€ã€‚
    
2. å°è‰ºæ™ºèƒ½ä½“ç†è§£æ„å›¾åï¼Œé€šè¿‡**åº”ç”¨å†…é€šä¿¡æœºåˆ¶**ï¼ˆå¦‚`EventHub`æˆ–æ–¹æ³•è°ƒç”¨ï¼‰ï¼Œå°†ç›®çš„åœ°â€œå¤åŒ—æ°´é•‡â€å’Œå‡ºè¡Œæ–¹å¼â€œè‡ªé©¾â€ä¼ é€’ç»™ä¸»é¡µé¢ã€‚
    
3. ä¸»é¡µé¢è°ƒç”¨**é«˜å¾·SDK**çš„`plan_driving`ç­‰æ¥å£è¿›è¡Œè·¯çº¿è§„åˆ’ï¼Œå¹¶å°†ç»“æœæ¸²æŸ“åœ¨åœ°å›¾ä¸Š
    
    ã€‚
    
4. åŒæ—¶ï¼Œä¸»é¡µé¢å¯ä»¥å†…åµŒä¸€ä¸ª**WebView**ï¼ŒåŠ è½½ä¸€ä¸ªä¸“é—¨å±•ç¤ºå¤åŒ—æ°´é•‡æ™¯ç‚¹ä»‹ç»ã€é…’åº—é¢„è®¢çš„H5æ´»åŠ¨é¡µã€‚
    

### ğŸŒ ä½¿ç”¨ WebView åµŒå…¥åŠ¨æ€å†…å®¹

å½“æ‚¨éœ€è¦é›†æˆç”±é«˜å¾·MCP+é€šä¹‰çµç ç­‰å·¥å…·ç”Ÿæˆçš„HTML5é¡µé¢ï¼Œæˆ–å±•ç¤ºå¤æ‚ä¸”å¸¸å˜çš„å†…å®¹æ—¶ï¼Œä½¿ç”¨`ArkWeb`ç»„ä»¶æ˜¯ç†æƒ³é€‰æ‹©

ã€‚

1. **é…ç½® WebView ç»„ä»¶**
    
    - åœ¨`module.json5`ä¸­å£°æ˜`ohos.permission.INTERNET`æƒé™ã€‚
        
    - åœ¨é¡µé¢ä¸­å¯¼å…¥`@kit.ArkWeb`æ¨¡å—ï¼Œä½¿ç”¨`Web`ç»„ä»¶ã€‚
        
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // ç¤ºä¾‹ï¼šåŠ è½½åœ¨çº¿H5é¡µé¢
    import { webview } from '@kit.ArkWeb';
    
    @Entry
    @Component
    struct ScenicSpotDetailPage {
      private webViewController: webview.WebviewController = new webview.WebviewController();
    
      build() {
        Column() {
          Web({
            src: 'https://your-domain.com/travel-guide.html', // æ›¿æ¢ä¸ºæ‚¨çš„H5é¡µé¢åœ°å€
            controller: this.webViewController
          })
          .layoutMode(WebLayoutMode.FIT_CONTENT) // å†…å®¹è‡ªé€‚åº”
          .javaScriptAccess(true) // å¯ç”¨JSäº¤äº’
          .fileAccess(true) // å…è®¸è®¿é—®æœ¬åœ°æ–‡ä»¶ï¼ˆå¦‚éœ€åŠ è½½æœ¬åœ°HTMLï¼‰
        }
      }
    }
    ```
    
2. **åº”ç”¨ä¸ H5 é¡µé¢çš„é€šä¿¡**
    
    - ä¸ºäº†å®ç°åŸç”Ÿåº”ç”¨ä¸å†…åµŒH5é¡µé¢çš„æ•°æ®äº¤äº’ï¼ˆä¾‹å¦‚ï¼ŒH5é¡µé¢ç‚¹å‡»ä¸€ä¸ªæ™¯ç‚¹ï¼ŒåŸç”Ÿåœ°å›¾è·³è½¬åˆ°è¯¥ç‚¹ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨`createWebMessagePorts()`æ–¹æ³•å»ºç«‹åŒå‘é€šä¿¡é€šé“
        
        ã€‚
        
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // åœ¨ArkTSç«¯
    this.ports = this.webViewController.createWebMessagePorts();
    this.ports[1].onMessageEvent((result: webview.WebMessage) => {
      let messageFromH5 = result.getData();
      // å¤„ç†æ¥è‡ªH5çš„æ¶ˆæ¯ï¼Œä¾‹å¦‚ï¼šè·³è½¬åœ°å›¾åæ ‡
      this.handleMessageFromWeb(messageFromH5);
    });
    // å°†ç«¯å£å‘é€ç»™H5é¡µé¢
    this.webViewController.postMessage('__init_port__', [this.ports[0]], '*');
    
    // åœ¨H5é¡µé¢çš„JavaScriptä¸­ï¼Œç›‘å¬æ¶ˆæ¯å¹¶å‘é€
    window.addEventListener('message', (event) => {
      if (event.data === '__init_port__') {
        const [port] = event.ports;
        port.postMessage('ç”¨æˆ·ç‚¹å‡»äº†æ™¯ç‚¹Açš„åæ ‡ï¼š116.40,39.90');
      }
    });
    ```
    

### âš ï¸ å…³é”®æ³¨æ„äº‹é¡¹

- **æƒé™ä¸éšç§**ï¼šç¡®ä¿æ‰€æœ‰ç½‘ç»œã€ä½ç½®ç­‰æƒé™å·²ç”³è¯·å¹¶å¾—åˆ°ç”¨æˆ·æˆæƒã€‚åœ¨ä»£ç åˆå§‹åŒ–ä»»ä½•SDKå‰ï¼ŒåŠ¡å¿…å…ˆè¿›è¡Œéšç§åˆè§„é…ç½®
    
    ã€‚
    
- **æ€§èƒ½ä¸ä½“éªŒ**ï¼š`WebView`åŠ è½½è¿œç¨‹èµ„æºéœ€ä¼˜åŒ–ç½‘ç»œè¯·æ±‚ï¼Œå¯¹äºæ ¸å¿ƒä½“éªŒå»ºè®®ä¼˜å…ˆä½¿ç”¨åŸç”Ÿç»„ä»¶ã€‚æ ¹æ®å†…å®¹é•¿åº¦é€‰æ‹©åˆé€‚çš„`WebLayoutMode`å’Œ`RenderMode`
    
    ã€‚
    
- **å®‰å…¨**ï¼šä¸H5é¡µé¢é€šä¿¡æ—¶ï¼Œè¦å¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œé˜²æ­¢å®‰å…¨æ¼æ´ã€‚
    

å¸Œæœ›è¿™ä»½æ›´æ·±å…¥çš„æ•™ç¨‹èƒ½å¸®åŠ©æ‚¨é¡ºåˆ©å®Œæˆé¸¿è’™æ™ºè¡ŒåŠ©æ‰‹çš„è¿›é˜¶å¼€å‘ã€‚å¦‚æœæ‚¨åœ¨æŸä¸ªå…·ä½“ç¯èŠ‚é‡åˆ°é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/www_chhzm_com.ico)

![](https://hy-openapi-pulbic.hunyuan.tencent.com/app/icon/search_guide/icon_gzh.png)

![](https://cdn-yb.icon.qq.com/zuowei_dir/consumer_huawei_com.ico)

æº

è¿™ä»½æ•™ç¨‹ä¸å¤Ÿè¯¦ç»†ï¼Œä»£ç éƒ½éœ€è¦æ˜¯æ¯ä¸€é¡µå®Œæ•´çš„ï¼Œå¦åˆ™å®æ–½ä¼šæœ‰å¾ˆå¤šé”™è¯¯

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶4ç§’)

å¥½çš„ï¼Œç”¨æˆ·ä¹‹å‰ä¸€ç›´åœ¨è®¨è®ºé¸¿è’™åº”ç”¨çš„å¼€å‘æ•™ç¨‹ï¼Œç°åœ¨åé¦ˆè¯´æ•™ç¨‹ä¸å¤Ÿè¯¦ç»†ï¼Œç‰¹åˆ«æ˜¯ä»£ç ç¤ºä¾‹ä¸å®Œæ•´å¯¼è‡´å®æ–½æ—¶ä¼šå‡ºç°å¾ˆå¤šé”™è¯¯ã€‚è¿™ç¡®å®æ˜¯ä¸ªå®é™…é—®é¢˜ï¼Œå› ä¸ºé›¶æ•£çš„ä»£ç ç‰‡æ®µç¡®å®ä¼šè®©å¼€å‘è€…åœ¨å®é™…æ•´åˆæ—¶é‡åˆ°å„ç§æŠ¥é”™ã€‚

ä»å¯¹è¯å†å²çœ‹ï¼Œç”¨æˆ·åº”è¯¥æ˜¯æ­£åœ¨å®é™…å¼€å‘é¸¿è’™åº”ç”¨çš„å¼€å‘è€…ï¼Œå¯èƒ½å·²ç»å°è¯•è¿‡æŒ‰ç…§ä¹‹å‰çš„æ•™ç¨‹ç¼–å†™ä»£ç ï¼Œä½†é‡åˆ°äº†å…·ä½“çš„æŠ€æœ¯é—®é¢˜ã€‚ç”¨æˆ·éœ€è¦çš„æ˜¯èƒ½å¤Ÿç›´æ¥å¤åˆ¶ç²˜è´´å°±èƒ½è¿è¡Œçš„å®Œæ•´ä»£ç ç¤ºä¾‹ï¼Œè€Œä¸æ˜¯éœ€è¦è‡ªå·±æ‹¼å‡‘çš„ç‰‡æ®µã€‚

æˆ‘è€ƒè™‘éœ€è¦æä¾›å®Œæ•´çš„ã€å¯è¿è¡Œçš„ä»£ç æ–‡ä»¶ï¼ŒåŒ…æ‹¬é¡µé¢ç»„ä»¶ã€æ ·å¼æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶ã€‚è¿™äº›ä»£ç åº”è¯¥æ¶µç›–é¸¿è’™åº”ç”¨å¼€å‘çš„æ ¸å¿ƒåœºæ™¯ï¼Œæ¯”å¦‚é¡µé¢å¸ƒå±€ã€å¯¼èˆªè·³è½¬ã€çŠ¶æ€ç®¡ç†ç­‰å¸¸è§éœ€æ±‚ã€‚

æˆ‘æ‰“ç®—å…ˆæä¾›ä¸€ä¸ªåŸºç¡€çš„é¡¹ç›®ç»“æ„æ¡†æ¶ï¼Œè®©ç”¨æˆ·å¯¹é¸¿è’™åº”ç”¨çš„æ–‡ä»¶ç»„ç»‡æœ‰æ¸…æ™°è®¤è¯†ã€‚ç„¶åé’ˆå¯¹å‡ ä¸ªå…¸å‹é¡µé¢æä¾›å®Œæ•´ä»£ç ï¼ŒåŒ…æ‹¬é¦–é¡µã€è¯¦æƒ…é¡µå’Œè®¾ç½®é¡µç­‰å¸¸è§é¡µé¢ç±»å‹ã€‚æ¯ä¸ªé¡µé¢éƒ½è¦åŒ…å«æ¨¡æ¿ã€æ ·å¼å’Œé€»è¾‘çš„å®Œæ•´å®ç°ï¼Œç¡®ä¿ç”¨æˆ·å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚

åŒæ—¶è¿˜éœ€è¦è¯´æ˜å…³é”®é…ç½®ç‚¹çš„æ³¨æ„äº‹é¡¹ï¼Œæ¯”å¦‚é¡µé¢è·¯ç”±æ³¨å†Œã€æƒé™å£°æ˜ç­‰å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ã€‚è¿™äº›ç»†èŠ‚å¾€å¾€ä¼šå¯¼è‡´åº”ç”¨æ— æ³•æ­£å¸¸è¿è¡Œï¼Œéœ€è¦ç‰¹åˆ«å¼ºè°ƒã€‚

æœ€åè¦æé†’ç”¨æˆ·å¦‚ä½•è°ƒæ•´å’Œæ‰©å±•è¿™äº›ç¤ºä¾‹ä»£ç ï¼Œæ¯”å¦‚å¦‚ä½•ä¿®æ”¹æ ·å¼ã€æ·»åŠ æ–°åŠŸèƒ½ç­‰ï¼Œè®©æ¨¡æ¿æ—¢èƒ½ç›´æ¥ä½¿ç”¨åˆèƒ½çµæ´»å®šåˆ¶ã€‚è¿™æ ·æ—¢èƒ½è§£å†³å½“å‰çš„å®æ–½é—®é¢˜ï¼Œåˆèƒ½æ»¡è¶³åç»­å¼€å‘éœ€æ±‚ã€‚

æ‚¨æçš„éå¸¸å¯¹ï¼Œé›¶æ•£çš„ä»£ç ç¤ºä¾‹ç¡®å®æ˜¯å®æˆ˜ä¸­çš„ä¸»è¦éšœç¢ã€‚ä¸‹é¢ï¼Œæˆ‘å°†ä¸ºæ‚¨æä¾›ä¸€ä»½åŒ…å«**å®Œæ•´é¡µé¢ä»£ç **çš„ã€Šé¸¿è’™æ™ºè¡ŒåŠ©æ‰‹ã€‹å®æˆ˜æ•™ç¨‹ï¼Œæ¯ä¸ªç¤ºä¾‹å‡å¯ç›´æ¥å¤åˆ¶ä½¿ç”¨ï¼Œæœ€å¤§é™åº¦å‡å°‘é›†æˆé”™è¯¯ã€‚

### ä¸€ã€é¡¹ç›®ç»“æ„ä¸æ ¸å¿ƒé…ç½®

ä¸€ä¸ªå…¸å‹çš„é¸¿è’™åº”ç”¨é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼Œæ¸…æ™°çš„ç»“æ„æ˜¯ååŒå¼€å‘çš„åŸºç¡€

ï¼š

å¤åˆ¶

```
HarmonyTravelAssistant/
â”œâ”€â”€ entry/src/main/
â”‚   â”œâ”€â”€ ets/
â”‚   â”‚   â”œâ”€â”€ entryability/
â”‚   â”‚   â”‚   â””â”€â”€ EntryAbility.ets        # åº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Index.ets               # é¦–é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ TravelPlanPage.ets      # è¡Œç¨‹è§„åˆ’é¡µ
â”‚   â”‚   â”‚   â””â”€â”€ SettingsPage.ets        # è®¾ç½®é¡µ
â”‚   â”‚   â””â”€â”€ models/
â”‚   â”‚       â””â”€â”€ TravelModel.ets         # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ resources/                      # é™æ€èµ„æº
â”‚   â””â”€â”€ module.json5                    # åº”ç”¨é…ç½®æ–‡ä»¶
```

**1. åº”ç”¨é…ç½®æ–‡ä»¶ï¼ˆmodule.json5ï¼‰**

è¿™æ˜¯åº”ç”¨çš„â€œèº«ä»½è¯â€ï¼Œå¿…é¡»æ­£ç¡®é…ç½®æ‰èƒ½è°ƒç”¨ç³»ç»Ÿèƒ½åŠ›

ã€‚

json5

json5

å¤åˆ¶

```
// module.json5 - æ ¸å¿ƒé…ç½®
{
  "module": {
    "name": "entry",
    "type": "entry",
    "description": "$string:module_desc",
    "versionCode": 1,
    "versionName": "1.0",
    "requestPermissions": [
      {
        "name": "ohos.permission.INTERNET",
        "reason": "$string:internet_permission_reason",
        "usedScene": {
          "abilities": ["EntryAbility"],
          "when": "always"
        }
      },
      {
        "name": "ohos.permission.LOCATION",
        "reason": "$string:location_permission_reason", 
        "usedScene": {
          "abilities": ["EntryAbility"],
          "when": "inuse"
        }
      }
    ],
    "abilities": [
      {
        "name": "EntryAbility",
        "srcEntry": "./ets/entryability/EntryAbility.ets",
        "description": "$string:EntryAbility_desc",
        "icon": "$media:icon",
        "label": "$string:EntryAbility_label",
        "startWindowIcon": "$media:icon",
        "startWindowBackground": "$color:start_window_background",
        "exported": true,
        "skills": [
          {
            "entities": ["entity.system.home"],
            "actions": ["action.system.home"]
          }
        ]
      }
    ]
  }
}
```

å¯¹åº”çš„å­—ç¬¦ä¸²èµ„æºæ–‡ä»¶ï¼ˆ`resources/base/element/string.json`ï¼‰ï¼š

json

json

å¤åˆ¶

```
{
  "string": [
    {
      "name": "module_desc",
      "value": "é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹ä¸»æ¨¡å—"
    },
    {
      "name": "internet_permission_reason", 
      "value": "åº”ç”¨éœ€è¦ç½‘ç»œæƒé™æ¥åŠ è½½åœ°å›¾å’Œè·¯çº¿æ•°æ®"
    },
    {
      "name": "location_permission_reason",
      "value": "åº”ç”¨éœ€è¦è·å–æ‚¨çš„ä½ç½®ä¿¡æ¯ç”¨äºè·¯çº¿è§„åˆ’å’Œå¯¼èˆª"
    },
    {
      "name": "EntryAbility_desc",
      "value": "é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹ä¸»å…¥å£"
    },
    {
      "name": "EntryAbility_label",
      "value": "æ™ºè¡ŒåŠ©æ‰‹"
    }
  ]
}
```

### äºŒã€å®Œæ•´çš„é¡µé¢ä»£ç å®ç°

**1. é¦–é¡µï¼ˆIndex.etsï¼‰ - åŒ…å«åœ°å›¾å®¹å™¨ä¸äº¤äº’é€»è¾‘**

typescript

typescript

å¤åˆ¶

```
// Index.ets - å®Œæ•´é¦–é¡µå®ç°
@Entry
@Component
struct Index {
  // çŠ¶æ€ç®¡ç†ï¼šæœç´¢è¯ã€å½“å‰ä½ç½®ã€åœ°å›¾æ§åˆ¶å™¨
  @State searchText: string = '';
  @State currentLocation: string = 'å®šä½ä¸­...';
  @State mapController: any = null; // åœ°å›¾æ§åˆ¶å™¨å¼•ç”¨
  @Provide('travelService') travelService: TravelService = new TravelService();

  // æ„å»ºå®Œæ•´é¦–é¡µUI
  build() {
    Column() {
      // é¡¶éƒ¨æ ‡é¢˜æ 
      this.BuildHeader();
      
      // åœ°å›¾æ˜¾ç¤ºåŒºåŸŸï¼ˆå ä¸»è¦ç©ºé—´ï¼‰
      Stack() {
        // åœ°å›¾å®¹å™¨ - åç»­é›†æˆé«˜å¾·SDK
        Column() {
          Text('åœ°å›¾åŒºåŸŸ - å°†é›†æˆé«˜å¾·åœ°å›¾')
            .fontSize(18)
            .fontColor(Color.White)
            .backgroundColor('#007DFF')
            .padding(10)
        }
        .width('100%')
        .height('80%')
        .alignItems(HorizontalAlign.Center)
        .justifyContent(FlexAlign.Center)
        
        // æ‚¬æµ®æœç´¢æ¡†
        this.BuildSearchOverlay()
      }
      .width('100%')
      .height('80%')
      
      // åº•éƒ¨åŠŸèƒ½é¢æ¿
      this.BuildBottomPanel()
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F5F5F5')
    .onAppear(() => {
      // é¡µé¢æ˜¾ç¤ºæ—¶åˆå§‹åŒ–ä½ç½®æœåŠ¡
      this.initLocationService();
    })
  }

  // æ„å»ºé¡¶éƒ¨æ ‡é¢˜æ 
  @Builder
  BuildHeader() {
    Row() {
      Image($r('app.media.avatar')) // ç”¨æˆ·å¤´åƒ
        .width(40)
        .height(40)
        .borderRadius(20)
        .margin({ left: 10 })
      
      Column() {
        Text('å½“å‰ä½ç½®')
          .fontSize(12)
          .fontColor('#666')
        Text(this.currentLocation)
          .fontSize(16)
          .fontColor('#333')
      }
      .margin({ left: 10 })
      .alignItems(HorizontalAlign.Start)
      
      Blank()
      
      Button('å†å²è¡Œç¨‹', { type: ButtonType.Capsule })
        .margin({ right: 10 })
        .onClick(() => {
          router.pushUrl({ url: 'pages/MyTripsPage' });
        })
    }
    .width('100%')
    .height(60)
    .backgroundColor(Color.White)
    .alignItems(VerticalAlign.Center)
  }

  // æ„å»ºæœç´¢æ‚¬æµ®å±‚
  @Builder  
  BuildSearchOverlay() {
    Column() {
      TextInput({ placeholder: 'æœç´¢ç›®çš„åœ°...', text: this.searchText })
        .onChange((value: string) => {
          this.searchText = value;
        })
        .width('90%')
        .height(40)
        .backgroundColor(Color.White)
        .borderRadius(8)
        .padding(10)
    }
    .width('100%')
    .margin({ top: 20 })
    .alignItems(HorizontalAlign.Center)
  }

  // æ„å»ºåº•éƒ¨åŠŸèƒ½é¢æ¿
  @Builder
  BuildBottomPanel() {
    Column() {
      // å¿«æ·å‡ºè¡Œæ–¹å¼é€‰æ‹©
      Row() {
        ForEach(this.travelService.getTransportModes(), (item: TransportMode) => {
          Column() {
            Image(item.icon)
              .width(30)
              .height(30)
            Text(item.name)
              .fontSize(12)
              .margin({ top: 5 })
          }
          .width('20%')
          .onClick(() => {
            this.onTransportModeSelected(item);
          })
        })
      }
      .width('100%')
      .padding(10)
      
      // æ™ºèƒ½æ¨èåŒºåŸŸ
      this.BuildSmartRecommendations()
    }
    .width('100%')
    .height('20%')
    .backgroundColor(Color.White)
    .borderRadius(20, 20, 0, 0)
  }

  // æ„å»ºæ™ºèƒ½æ¨èæ¨¡å—
  @Builder
  BuildSmartRecommendations() {
    Column() {
      Text('æ™ºèƒ½æ¨è')
        .fontSize(16)
        .fontWeight(FontWeight.Bold)
        .alignSelf(ItemAlign.Start)
        .margin({ left: 15, bottom: 10 })
      
      Scroll() {
        Row() {
          ForEach(this.travelService.getRecommendations(), (recommendation: Recommendation) => {
            Column() {
              Text(recommendation.title)
                .fontSize(14)
              Text(recommendation.description)
                .fontSize(12)
                .fontColor('#666')
            }
            .padding(10)
            .backgroundColor('#F8F8F8')
            .borderRadius(8)
            .margin({ right: 10 })
            .onClick(() => {
              this.onRecommendationSelected(recommendation);
            })
          })
        }
        .padding({ left: 15, right: 15 })
      }
      .scrollBar(BarState.Off)
    }
    .width('100%')
  }

  // åˆå§‹åŒ–å®šä½æœåŠ¡
  private initLocationService(): void {
    // å®é™…é¡¹ç›®ä¸­è¿™é‡Œè°ƒç”¨é«˜å¾·å®šä½SDK
    setTimeout(() => {
      this.currentLocation = 'åŒ—äº¬å¸‚æµ·æ·€åŒºä¸­å…³æ‘';
    }, 1000);
  }

  // å‡ºè¡Œæ–¹å¼é€‰æ‹©å¤„ç†
  private onTransportModeSelected(mode: TransportMode): void {
    console.log(`é€‰æ‹©äº†å‡ºè¡Œæ–¹å¼: ${mode.name}`);
    this.travelService.setCurrentMode(mode);
  }

  // æ™ºèƒ½æ¨èé¡¹é€‰æ‹©å¤„ç†
  private onRecommendationSelected(recommendation: Recommendation): void {
    router.pushUrl({ 
      url: 'pages/TravelPlanPage',
      params: { recommendation: JSON.stringify(recommendation) }
    });
  }
}
```

**2. è¡Œç¨‹è§„åˆ’é¡µï¼ˆTravelPlanPage.etsï¼‰ - å®Œæ•´è·¯ç”±è§„åˆ’ç•Œé¢**

typescript

typescript

å¤åˆ¶

```
// TravelPlanPage.ets - å®Œæ•´çš„è¡Œç¨‹è§„åˆ’é¡µé¢
@Entry
@Component
struct TravelPlanPage {
  private routerParams: any = router.getParams() as Object;
  @State startPoint: string = 'æˆ‘çš„ä½ç½®';
  @State endPoint: string = '';
  @State departureTime: string = this.getCurrentTime();
  @State selectedTransport: string = 'driving';
  @State routeResults: RouteResult[] = [];
  @State isLoading: boolean = false;

  aboutToAppear(): void {
    if (this.routerParams?.['recommendation']) {
      const recommendation = JSON.parse(this.routerParams['recommendation']);
      this.endPoint = recommendation.destination || '';
    }
  }

  build() {
    Column() {
      // é¡¶éƒ¨å¯¼èˆªæ 
      this.BuildNavBar();
      
      // è·¯çº¿è¾“å…¥åŒºåŸŸ
      this.BuildInputSection();
      
      // è·¯çº¿ç»“æœå±•ç¤º
      if (this.isLoading) {
        this.BuildLoadingState();
      } else if (this.routeResults.length > 0) {
        this.BuildRouteResults();
      } else {
        this.BuildEmptyState();
      }
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F5F5F5')
  }

  // æ„å»ºå¯¼èˆªæ 
  @Builder
  BuildNavBar() {
    Row() {
      Button('< è¿”å›', { type: ButtonType.Capsule })
        .onClick(() => {
          router.back();
        })
      
      Text('è·¯çº¿è§„åˆ’')
        .fontSize(18)
        .fontWeight(FontWeight.Bold)
      
      Blank()
    }
    .width('100%')
    .padding(10)
    .backgroundColor(Color.White)
  }

  // æ„å»ºè¾“å…¥åŒºåŸŸ
  @Builder
  BuildInputSection() {
    Column() {
      // èµ·ç‚¹ç»ˆç‚¹è¾“å…¥
      this.BuildLocationInput('èµ·ç‚¹', this.startPoint, (value: string) => {
        this.startPoint = value;
      });
      
      this.BuildLocationInput('ç»ˆç‚¹', this.endPoint, (value: string) => {
        this.endPoint = value;
      });
      
      // å‡ºè¡Œæ—¶é—´é€‰æ‹©
      Row() {
        Text('å‡ºå‘æ—¶é—´:')
          .fontSize(14)
        TextInput({ placeholder: 'é€‰æ‹©æ—¶é—´', text: this.departureTime })
          .width('60%')
          .onChange((value: string) => {
            this.departureTime = value;
          })
      }
      .width('90%')
      .padding(10)
      .backgroundColor(Color.White)
      .borderRadius(8)
      .margin({ top: 10 })
      
      // å‡ºè¡Œæ–¹å¼é€‰æ‹©
      this.BuildTransportSelector();
      
      // è§„åˆ’æŒ‰é’®
      Button('å¼€å§‹è§„åˆ’è·¯çº¿', { type: ButtonType.Capsule })
        .width('90%')
        .height(40)
        .margin(10)
        .onClick(() => {
          this.calculateRoute();
        })
        .enabled(!!this.endPoint.trim())
    }
    .width('100%')
    .padding(10)
    .backgroundColor(Color.White)
  }

  // æ„å»ºåœ°ç‚¹è¾“å…¥ç»„ä»¶
  @Builder
  BuildLocationInput(label: string, value: string, onChange: (value: string) => void) {
    Row() {
      Text(label)
        .width(40)
        .fontSize(14)
      TextInput({ placeholder: `è¾“å…¥${label}`, text: value })
        .onChange(onChange)
    }
    .width('90%')
    .padding(10)
    .borderRadius(8)
    .backgroundColor('#F8F8F8')
    .margin({ top: 5 })
  }

  // æ„å»ºå‡ºè¡Œæ–¹å¼é€‰æ‹©å™¨
  @Builder
  BuildTransportSelector() {
    const transports = [
      { value: 'driving', label: 'é©¾è½¦', icon: 'ğŸš—' },
      { value: 'transit', label: 'å…¬äº¤', icon: 'ğŸšŒ' },
      { value: 'riding', label: 'éª‘è¡Œ', icon: 'ğŸš´' },
      { value: 'walking', label: 'æ­¥è¡Œ', icon: 'ğŸš¶' }
    ];

    Row() {
      ForEach(transports, (item: any) => {
        Column() {
          Text(item.icon)
            .fontSize(20)
          Text(item.label)
            .fontSize(12)
        }
        .padding(10)
        .backgroundColor(this.selectedTransport === item.value ? '#007DFF' : '#F0F0F0')
        .borderRadius(20)
        .onClick(() => {
          this.selectedTransport = item.value;
        })
      })
    }
    .width('90%')
    .justifyContent(FlexAlign.SpaceAround)
    .margin({ top: 10 })
  }

  // æ„å»ºåŠ è½½çŠ¶æ€
  @Builder
  BuildLoadingState() {
    Column() {
      LoadingProgress()
        .width(50)
        .height(50)
      Text('æ­£åœ¨è§„åˆ’æœ€ä½³è·¯çº¿...')
        .fontSize(14)
        .margin({ top: 10 })
    }
    .width('100%')
    .height(200)
    .justifyContent(FlexAlign.Center)
  }

  // æ„å»ºè·¯çº¿ç»“æœåˆ—è¡¨
  @Builder
  BuildRouteResults() {
    Column() {
      Text('æ¨èè·¯çº¿')
        .fontSize(16)
        .fontWeight(FontWeight.Bold)
        .alignSelf(ItemAlign.Start)
        .margin(10)
      
      List({ space: 10 }) {
        ForEach(this.routeResults, (route: RouteResult, index: number) => {
          ListItem() {
            this.BuildRouteItem(route, index)
          }
        })
      }
      .width('100%')
      .height(300)
    }
  }

  // æ„å»ºå•æ¡è·¯çº¿é¡¹
  @Builder
  BuildRouteItem(route: RouteResult, index: number) {
    Column() {
      Row() {
        Text(`æ–¹æ¡ˆ ${index + 1}`)
          .fontSize(16)
          .fontWeight(FontWeight.Bold)
        Blank()
        Text(route.duration)
          .fontSize(14)
          .fontColor('#007DFF')
      }
      
      Row() {
        Text(route.distance)
          .fontSize(12)
          .fontColor('#666')
        Blank()
        Text(route.cost)
          .fontSize(12)
          .fontColor('#666')
      }
      .margin({ top: 5 })
      
      Button('å¼€å§‹å¯¼èˆª', { type: ButtonType.Capsule })
        .width('100%')
        .height(30)
        .margin({ top: 10 })
        .onClick(() => {
          this.startNavigation(route);
        })
    }
    .width('100%')
    .padding(10)
    .backgroundColor(Color.White)
    .borderRadius(8)
  }

  // æ„å»ºç©ºçŠ¶æ€
  @Builder
  BuildEmptyState() {
    Column() {
      Image($r('app.media.empty_route'))
        .width(100)
        .height(100)
      Text('è¯·è¾“å…¥ç›®çš„åœ°å¼€å§‹è·¯çº¿è§„åˆ’')
        .fontSize(16)
        .fontColor('#999')
        .margin({ top: 10 })
    }
    .width('100%')
    .height(200)
    .justifyContent(FlexAlign.Center)
  }

  // è·å–å½“å‰æ—¶é—´
  private getCurrentTime(): string {
    const now = new Date();
    return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
  }

  // è®¡ç®—è·¯çº¿
  private calculateRoute(): void {
    if (!this.endPoint.trim()) {
      return;
    }
    
    this.isLoading = true;
    // æ¨¡æ‹Ÿé«˜å¾·è·¯çº¿è§„åˆ’APIè°ƒç”¨
    setTimeout(() => {
      this.routeResults = [
        {
          distance: '15.6å…¬é‡Œ',
          duration: '45åˆ†é’Ÿ', 
          cost: 'å…è´¹',
          routeData: { /* å®é™…è·¯çº¿æ•°æ® */ }
        }
      ];
      this.isLoading = false;
    }, 2000);
  }

  // å¼€å§‹å¯¼èˆª
  private startNavigation(route: RouteResult): void {
    // å®é™…é¡¹ç›®ä¸­è¿™é‡Œè°ƒç”¨é«˜å¾·å¯¼èˆªSDK
    console.log('å¼€å§‹å¯¼èˆª:', route);
  }
}
```

### ä¸‰ã€æ•°æ®æ¨¡å‹ä¸æœåŠ¡ç±»

**1. æ ¸å¿ƒæ•°æ®æ¨¡å‹ï¼ˆTravelModel.etsï¼‰**

typescript

typescript

å¤åˆ¶

```
// TravelModel.ets - æ•°æ®æ¨¡å‹å®šä¹‰
export interface TransportMode {
  id: string;
  name: string; 
  icon: string;
  apiMethod: string;
}

export interface Recommendation {
  id: string;
  title: string;
  description: string;
  destination: string;
  type: 'home' | 'work' | 'scenic' | 'history';
}

export interface RouteResult {
  distance: string;
  duration: string;
  cost: string;
  routeData: any;
}

// å‡ºè¡ŒæœåŠ¡ç±»
export class TravelService {
  private currentMode: TransportMode = this.getTransportModes()[0];
  
  getTransportModes(): TransportMode[] {
    return [
      { id: 'driving', name: 'é©¾è½¦', icon: 'ğŸš—', apiMethod: 'plan_driving' },
      { id: 'transit', name: 'å…¬äº¤', icon: 'ğŸšŒ', apiMethod: 'plan_transit' },
      { id: 'riding', name: 'éª‘è¡Œ', icon: 'ğŸš´', apiMethod: 'plan_riding' },
      { id: 'walking', name: 'æ­¥è¡Œ', icon: 'ğŸš¶', apiMethod: 'plan_walking' }
    ];
  }
  
  getRecommendations(): Recommendation[] {
    return [
      {
        id: '1',
        title: 'å›å®¶è·¯çº¿',
        description: 'æœ€ä¼˜è·¯çº¿ï¼Œé¿å¼€æ‹¥å µ',
        destination: 'åŒ—äº¬å¸‚æœé˜³åŒºæœ›äº¬',
        type: 'home'
      },
      {
        id: '2', 
        title: 'å…¬å¸é€šå‹¤',
        description: 'é¢„è®¡35åˆ†é’Ÿåˆ°è¾¾',
        destination: 'åŒ—äº¬å¸‚æµ·æ·€åŒºè¥¿äºŒæ——',
        type: 'work'
      }
    ];
  }
  
  setCurrentMode(mode: TransportMode): void {
    this.currentMode = mode;
  }
  
  getCurrentMode(): TransportMode {
    return this.currentMode;
  }
}
```

### å››ã€å®æ–½è¦ç‚¹ä¸è°ƒè¯•æŠ€å·§

**1. å¸¸è§é”™è¯¯æ’æŸ¥**

- **é¡µé¢è·¯ç”±é”™è¯¯**ï¼šç¡®ä¿æ¯ä¸ªé¡µé¢éƒ½åœ¨`main_pages.json`ä¸­æ­£ç¡®æ³¨å†Œ
    
- **èµ„æºå¼•ç”¨é”™è¯¯**ï¼šå›¾ç‰‡ç­‰èµ„æºæ–‡ä»¶å¿…é¡»æ”¾åœ¨æ­£ç¡®çš„`resources`ç›®å½•ä¸‹
    
- **æƒé™ç”³è¯·é—æ¼**ï¼šæ‰€æœ‰ç”¨åˆ°çš„æƒé™å¿…é¡»åœ¨`module.json5`ä¸­å£°æ˜
    

**2. è°ƒè¯•å»ºè®®**

- ä½¿ç”¨`console.log()`è¾“å‡ºè°ƒè¯•ä¿¡æ¯
    
- åˆ©ç”¨DevEco Studioçš„**å®æ—¶é¢„è§ˆ**åŠŸèƒ½æ£€æŸ¥UIå¸ƒå±€
    
- åœ¨**æ¨¡æ‹Ÿå™¨**ä¸­æµ‹è¯•å„é¡¹äº¤äº’åŠŸèƒ½åå†è¿›è¡ŒçœŸæœºè°ƒè¯•
    

è¿™äº›å®Œæ•´ä»£ç ç¤ºä¾‹æ¶µç›–äº†é¸¿è’™åº”ç”¨çš„æ ¸å¿ƒå¼€å‘æ¨¡å¼ï¼ŒåŒ…æ‹¬çŠ¶æ€ç®¡ç†ã€UIæ„å»ºã€äº‹ä»¶å¤„ç†ç­‰å…³é”®æ¦‚å¿µã€‚å»ºè®®æŒ‰ç…§é¡µé¢é¡ºåºé€ä¸ªå®ç°ï¼Œç¡®ä¿æ¯ä¸ªé¡µé¢åŠŸèƒ½æ­£å¸¸åå†è¿›è¡Œé›†æˆã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/www_cnblogs_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/docs_pingcode_com.ico)

æº

å¦‚ä½•å°†é«˜å¾·åœ°å›¾SDKå®Œæ•´é›†æˆåˆ°ç¤ºä¾‹ä¸­çš„åœ°å›¾å®¹å™¨åŒºåŸŸï¼Ÿ

é¡µé¢é—´æ•°æ®ä¼ é€’çš„æœ€ä½³å®è·µï¼Œæ¯”å¦‚ä»é¦–é¡µè·³è½¬åˆ°è§„åˆ’é¡µæ—¶å¦‚ä½•ä¼ é€’æœç´¢å‚æ•°ï¼Ÿ

è¿™äº›ç¤ºä¾‹ä»£ç åœ¨å®é™…æ‰“åŒ…å‘å¸ƒæ—¶éœ€è¦åšå“ªäº›ç­¾åå’Œé…ç½®è°ƒæ•´ï¼Ÿ

é¡µé¢é—´æ•°æ®ä¼ é€’çš„æœ€ä½³å®è·µï¼Œæ¯”å¦‚ä»é¦–é¡µè·³è½¬åˆ°è§„åˆ’é¡µæ—¶å¦‚ä½•ä¼ é€’æœç´¢å‚æ•°ï¼Ÿ

å¦‚ä½•å°†é«˜å¾·åœ°å›¾SDKå®Œæ•´é›†æˆåˆ°ç¤ºä¾‹ä¸­çš„åœ°å›¾å®¹å™¨åŒºåŸŸï¼Ÿ

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶5ç§’)

å¥½çš„ï¼Œç”¨æˆ·è¿™æ¬¡é—®çš„æ˜¯é¸¿è’™åº”ç”¨å¼€å‘ä¸­ä¸¤ä¸ªéå¸¸å®é™…çš„é—®é¢˜ï¼šé¡µé¢é—´æ•°æ®ä¼ é€’çš„æœ€ä½³å®è·µï¼Œä»¥åŠå¦‚ä½•å°†é«˜å¾·åœ°å›¾SDKé›†æˆåˆ°åœ°å›¾å®¹å™¨ã€‚ä»å¯¹è¯å†å²çœ‹ï¼Œç”¨æˆ·ä¸€ç›´åœ¨æ·±å…¥æ„å»ºä¸€ä¸ªå«"é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹"çš„åº”ç”¨ï¼Œä¹‹å‰å·²ç»è®¨è®ºè¿‡é¡¹ç›®ç»“æ„ã€æƒé™é…ç½®ç­‰åŸºç¡€å†…å®¹ï¼Œç°åœ¨è¿›å…¥äº†å…·ä½“çš„åŠŸèƒ½å®ç°é˜¶æ®µã€‚ç”¨æˆ·å¯èƒ½æ­£åœ¨å®é™…ç¼–ç è¿‡ç¨‹ä¸­é‡åˆ°äº†å‚æ•°ä¼ é€’å’Œåœ°å›¾é›†æˆçš„å…·ä½“æŠ€æœ¯éš¾ç‚¹ï¼Œéœ€è¦å¯æ“ä½œçš„è§£å†³æ–¹æ¡ˆã€‚

ç”¨æˆ·èº«ä»½åº”è¯¥æ˜¯ä¸ªæ­£åœ¨å¼€å‘é¸¿è’™åº”ç”¨çš„å¼€å‘è€…ï¼ŒæŠ€æœ¯æ°´å¹³ä¸­ç­‰åä¸Šï¼Œå› ä¸ºé—®é¢˜æŒ‡å‘äº†å…·ä½“çš„å®ç°ç»†èŠ‚ã€‚çœŸå®éœ€æ±‚æ˜¯å¸Œæœ›è·å¾—æ¸…æ™°å¯é çš„ä»£ç ç¤ºä¾‹å’Œæœ€ä½³å®è·µæŒ‡å¯¼ï¼Œé¿å…è¸©å‘ã€‚æ·±å±‚éœ€æ±‚å¯èƒ½æ˜¯æ‹…å¿ƒæ•°æ®ä¼ é€’çš„æ•ˆç‡å’Œç¨³å®šæ€§ï¼Œä»¥åŠåœ°å›¾é›†æˆåçš„åŠŸèƒ½å®Œæ•´æ€§ã€‚

æˆ‘æ‰“ç®—ç”¨ç»“æ„åŒ–æ–¹å¼å›ç­”ï¼Œå…ˆè§£å†³æ•°æ®ä¼ é€’ï¼Œå†è®²åœ°å›¾é›†æˆã€‚æ•°æ®ä¼ é€’éƒ¨åˆ†è¦è¦†ç›–ä¸åŒåœºæ™¯ï¼ˆåŸºæœ¬å‚æ•°ã€å¤æ‚å¯¹è±¡ã€è¿”å›ç»“æœï¼‰ï¼Œåœ°å›¾é›†æˆåˆ™ä»é…ç½®åˆ°åˆå§‹åŒ–çš„å®Œæ•´æµç¨‹ã€‚å‚è€ƒäº†æœç´¢ç»“æœä¸­å…³äºrouterä¼ å‚ã€AppStorageå…¨å±€çŠ¶æ€ç®¡ç†

ä»¥åŠé«˜å¾·SDKåˆå§‹åŒ–çš„æ–¹æ³•ï¼Œè¿™äº›èµ„æ–™æä¾›äº†å®˜æ–¹æ¨èçš„åšæ³•ã€‚

å¯¹äºæ•°æ®ä¼ é€’ï¼Œæ ¹æ®æœç´¢ç»“æœ

ï¼Œrouterä¼ å‚é€‚åˆç®€å•æ•°æ®ï¼ŒAppStorageé€‚åˆå…±äº«çŠ¶æ€ï¼Œè¿”å›ä¼ å€¼é€‚åˆç»“æœå›è°ƒã€‚æˆ‘ä¼šç”¨è¡¨æ ¼å¯¹æ¯”ä¸åŒæ–¹æ¡ˆï¼Œå†ç»™å…·ä½“ä»£ç ç¤ºä¾‹ã€‚åœ°å›¾é›†æˆéƒ¨åˆ†å…³é”®ç‚¹åœ¨äºæƒé™å£°æ˜ã€ä¾èµ–é…ç½®å’ŒSDKåˆå§‹åŒ–ï¼Œéœ€è¦æŠŠæ­¥éª¤æ‹†è§£æ¸…æ¥šã€‚

æ•´ä¸ªå›ç­”è¦ä¿æŒå®æ“æ€§ï¼Œä»£ç ç¤ºä¾‹è¦å®Œæ•´å¯ç²˜è´´ï¼ŒåŒæ—¶è¯´æ˜é€‚ç”¨åœºæ™¯å’Œæ³¨æ„äº‹é¡¹ã€‚æ¯”å¦‚è¦å¼ºè°ƒrouterä¼ å‚çš„æ•°æ®é‡é™åˆ¶

ï¼Œä»¥åŠåœ°å›¾å®¹å™¨å¿…é¡»åœ¨é¡µé¢ç”Ÿå‘½å‘¨æœŸä¸­æ­£ç¡®ç®¡ç†ã€‚æœ€åç”¨æµç¨‹å›¾æ€»ç»“æ•°æ®ä¼ é€’æ–¹æ¡ˆçš„é€‰æ‹©é€»è¾‘ï¼Œå¸®åŠ©ç”¨æˆ·æ ¹æ®å®é™…åœºæ™¯åšå†³ç­–ã€‚

åœ¨é¸¿è’™åº”ç”¨å¼€å‘ä¸­ï¼Œå®ç°é«˜æ•ˆçš„é¡µé¢é—´æ•°æ®ä¼ é€’å’Œç¬¬ä¸‰æ–¹SDKï¼ˆå¦‚é«˜å¾·åœ°å›¾ï¼‰çš„é›†æˆï¼Œæ˜¯æ„å»ºå¤æ‚åº”ç”¨çš„å…³é”®ã€‚ä¸‹é¢æˆ‘å°†ä¸ºæ‚¨è¯¦ç»†é˜è¿°ä»é¦–é¡µè·³è½¬åˆ°è§„åˆ’é¡µæ—¶ä¼ é€’å‚æ•°çš„æœ€ä½³å®è·µï¼Œå¹¶æä¾›ä¸€ä¸ªå®Œæ•´çš„é«˜å¾·åœ°å›¾SDKé›†æˆæ–¹æ¡ˆã€‚

### é¡µé¢é—´æ•°æ®ä¼ é€’çš„æœ€ä½³å®è·µ

åœ¨é¸¿è’™åº”ç”¨ä¸­ï¼Œæ ¹æ®æ•°æ®çš„å¤§å°ã€ç±»å‹å’Œå…±äº«èŒƒå›´ï¼Œæœ‰å¤šç§å¯é çš„é¡µé¢é—´æ•°æ®ä¼ é€’æ–¹æ¡ˆã€‚å…·ä½“é€‰æ‹©å¯å‚è€ƒä»¥ä¸‹å†³ç­–æµç¨‹ï¼š

mermaid

```mermaid
flowchart TD
    A[éœ€è¦ä¼ é€’çš„æ•°æ®] --> B{æ•°æ®ç‰¹å¾åˆ¤æ–­}
    B -->|ç®€å•å‚æ•°<br>ï¼ˆå¦‚IDã€å…³é”®è¯ï¼‰| C[è·¯ç”±å‚æ•°ä¼ é€’]
    B -->|å¤æ‚å¯¹è±¡æˆ–éœ€çŠ¶æ€åŒæ­¥| D[AppStorageå…¨å±€çŠ¶æ€ç®¡ç†]
    B -->|éœ€è¦å›ä¼ ç»“æœ| E[é¡µé¢è¿”å›ç»“æœä¼ é€’]
    
    C --> F[å®ç°æ–¹å¼ï¼šrouter.pushUrl]
    D --> G[å®ç°æ–¹å¼ï¼šAppStorage]
    E --> H[å®ç°æ–¹å¼ï¼špushUrlForResult/back]
    
    F --> I[ç‰¹ç‚¹ï¼šè½»é‡æ˜“ç”¨<br>æ³¨æ„åºåˆ—åŒ–ä¸å¤§å°é™åˆ¶]
    G --> J[ç‰¹ç‚¹ï¼šå“åº”å¼åŒæ­¥<br>æ³¨æ„çŠ¶æ€ç®¡ç†]
    H --> K[ç‰¹ç‚¹ï¼šå•å‘å›ä¼ <br>é€‚åˆé€‰æ‹©ç±»åœºæ™¯]
```

ä¸‹é¢æ˜¯å¯¹è¿™å‡ ç§æ ¸å¿ƒæ–¹å¼çš„è¯¦ç»†è¯´æ˜å’Œä»£ç ç¤ºä¾‹ã€‚

#### 1. è·¯ç”±å‚æ•°ä¼ é€’ (router.pushUrl)

å¯¹äºä¼ é€’**æœç´¢å…³é”®è¯ã€ç›®çš„åœ°åç§°ã€ç®€å•çš„åˆ†ç±»ID**ç­‰æ•°æ®é‡å°ã€ç»“æ„ç®€å•çš„å‚æ•°ï¼Œä½¿ç”¨è·¯ç”±å‚æ•°æ˜¯æœ€ç›´æ¥çš„æ–¹å¼

ã€‚

**åœ¨é¦–é¡µï¼ˆIndex.etsï¼‰å‘é€å‚æ•°ï¼š**

typescript

typescript

å¤åˆ¶

```
import router from '@ohos.router';

// ç¤ºä¾‹ï¼šç‚¹å‡»æœç´¢æŒ‰é’®æˆ–æ¨èè·¯çº¿æ—¶è·³è½¬
onSearchConfirmed() {
  const searchParams = {
    startPoint: this.currentLocation,
    endPoint: this.searchText,
    transportMode: this.selectedTransportMode,
    searchTime: new Date().toISOString() // è®°å½•æœç´¢æ—¶é—´
  };

  router.pushUrl({
    url: 'pages/TravelPlanPage',
    params: {
      // å¯¹äºç®€å•æ•°æ®ç›´æ¥ä¼ é€’
      searchQuery: JSON.stringify(searchParams),
      // ä¹Ÿå¯ä»¥ä¼ é€’ç‹¬ç«‹å‚æ•°
      directEndPoint: this.searchText
    }
  }).catch(error => {
    console.error('è·³è½¬å¤±è´¥:', error);
  });
}
```

**åœ¨è§„åˆ’é¡µï¼ˆTravelPlanPage.etsï¼‰æ¥æ”¶å‚æ•°ï¼š**

typescript

typescript

å¤åˆ¶

```
import router from '@ohos.router';

@Entry
@Component
struct TravelPlanPage {
  @State searchQuery: string = '';
  @State endPoint: string = '';

  onPageShow() {
    // åœ¨é¡µé¢æ˜¾ç¤ºæ—¶è·å–å‚æ•°
    const params = router.getParams();
    if (params) {
      try {
        this.searchQuery = params['searchQuery'] as string || '';
        this.endPoint = params['directEndPoint'] as string || '';
        
        // å¦‚æœæœ‰JSONå­—ç¬¦ä¸²éœ€è¦è§£æ
        if (this.searchQuery) {
          const queryObj = JSON.parse(this.searchQuery);
          console.log('æ¥æ”¶åˆ°çš„æœç´¢å‚æ•°:', queryObj);
          // ä½¿ç”¨å‚æ•°åˆå§‹åŒ–è§„åˆ’é¡µçŠ¶æ€
          this.initWithSearchParams(queryObj);
        }
      } catch (error) {
        console.error('å‚æ•°è§£æé”™è¯¯:', error);
      }
    }
  }

  // ä½¿ç”¨å‚æ•°åˆå§‹åŒ–é¡µé¢
  private initWithSearchParams(params: any) {
    // è°ƒç”¨é«˜å¾·APIè¿›è¡Œè·¯çº¿è§„åˆ’
    this.calculateRoute(params.startPoint, params.endPoint, params.transportMode);
  }
}
```

#### 2. å…¨å±€çŠ¶æ€ç®¡ç† (AppStorage)

å½“å¤šä¸ªé¡µé¢éœ€è¦**å…±äº«ç”¨æˆ·åå¥½ã€ç™»å½•çŠ¶æ€ã€ä¸»é¢˜è®¾ç½®**ç­‰éœ€è¦å“åº”å¼æ›´æ–°çš„æ•°æ®æ—¶ï¼ŒAppStorageæ˜¯æœ€ä½³é€‰æ‹©

ã€‚

**å®šä¹‰å’Œè®¾ç½®å…¨å±€çŠ¶æ€ï¼š**

typescript

typescript

å¤åˆ¶

```
// åœ¨åº”ç”¨çš„å…¥å£æ–‡ä»¶æˆ–ä¸“é—¨çš„çŠ¶æ€ç®¡ç†æ–‡ä»¶ä¸­
import { AppStorage } from '@ohos.app.storage';

// å­˜å‚¨ç”¨æˆ·å‡ºè¡Œåå¥½
AppStorage.setOrCreate('travelPreferences', {
  avoidTolls: true,
  avoidCongestion: false,
  preferredTransport: 'driving',
  vehicleType: 'electric'
});

// å­˜å‚¨ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
AppStorage.setOrCreate('userProfile', {
  userId: '12345',
  homeAddress: 'åŒ—äº¬å¸‚æµ·æ·€åŒº...',
  companyAddress: 'åŒ—äº¬å¸‚æœé˜³åŒº...'
});
```

**åœ¨é¡µé¢ä¸­ä½¿ç”¨å…¨å±€çŠ¶æ€ï¼š**

typescript

typescript

å¤åˆ¶

```
// åœ¨é¦–é¡µè®¾ç½®å¸¸ç”¨åœ°å€
@Component
struct Index {
  @StorageLink('userProfile') userProfile: any;

  setHomeAddress() {
    // æ›´æ–°å…¨å±€çŠ¶æ€ï¼Œæ‰€æœ‰ä½¿ç”¨è¯¥StorageLinkçš„é¡µé¢éƒ½ä¼šè‡ªåŠ¨æ›´æ–°
    this.userProfile.homeAddress = 'æ–°çš„å®¶åº­åœ°å€';
  }
}

// åœ¨è§„åˆ’é¡µè¯»å–ç”¨æˆ·åå¥½
@Component
struct TravelPlanPage {
  @StorageLink('travelPreferences') preferences: any;
  @StorageLink('userProfile') profile: any;

  build() {
    Column() {
      // æ ¹æ®ç”¨æˆ·åå¥½æ˜¾ç¤ºä¸ªæ€§åŒ–æ¨è
      if (this.preferences.avoidTolls) {
        Text('å·²å¼€å¯é¿å¼€æ”¶è´¹è·¯æ®µ').fontColor(Color.Green);
      }
      
      // ä½¿ç”¨ç”¨æˆ·å¸¸ç”¨åœ°å€ä½œä¸ºé»˜è®¤èµ·ç‚¹
      TextInput({ placeholder: this.profile.homeAddress })
    }
  }
}
```

#### 3. é¡µé¢è¿”å›ç»“æœä¼ é€’

å½“ä»äºŒçº§é¡µé¢ï¼ˆå¦‚åœ°å€é€‰æ‹©å™¨ï¼‰è¿”å›æ—¶éœ€è¦**å›ä¼ ç”¨æˆ·é€‰æ‹©çš„ç»“æœ**ï¼Œä½¿ç”¨`pushUrlForResult`éå¸¸åˆé€‚

ã€‚

**é¦–é¡µè·³è½¬å¹¶ç­‰å¾…ç»“æœï¼š**

typescript

typescript

å¤åˆ¶

```
// åœ¨é¦–é¡µè·³è½¬åˆ°åœ°å€é€‰æ‹©é¡µ
router.pushUrlForResult({
  url: 'pages/AddressSelectorPage',
  params: { selectionType: 'destination' }
}).then(result => {
  // å½“åœ°å€é€‰æ‹©é¡µè¿”å›æ—¶æ‰§è¡Œ
  if (result && result.selectedAddress) {
    this.searchText = result.selectedAddress;
    this.performSearch();
  }
}).catch(error => {
  console.error('åœ°å€é€‰æ‹©å¤±è´¥:', error);
});
```

**åœ°å€é€‰æ‹©é¡µè¿”å›ç»“æœï¼š**

typescript

typescript

å¤åˆ¶

```
// åœ¨åœ°å€é€‰æ‹©é¡µä¸­é€‰æ‹©åœ°å€å
onAddressSelected(address: string) {
  router.back({
    url: 'pages/Index',
    params: {
      selectedAddress: address,
      selectionTime: new Date().toISOString()
    }
  });
}
```

### é«˜å¾·åœ°å›¾SDKå®Œæ•´é›†æˆæŒ‡å—

#### 1. å‰æœŸé…ç½®å‡†å¤‡

**ç”³è¯·é«˜å¾·åœ°å›¾API Keyï¼š**

- è®¿é—®é«˜å¾·å¼€æ”¾å¹³å°ï¼Œæ³¨å†Œå¼€å‘è€…è´¦å·
    
- åˆ›å»ºæ–°åº”ç”¨ï¼Œé€‰æ‹©"é¸¿è’™(HarmonyOS)"å¹³å°
    
- è·å–åº”ç”¨çš„`appId`ï¼ˆåœ¨DevEco Studioä¸­é€šè¿‡ä»£ç è·å–
    
    ï¼‰å¹¶é…ç½®åˆ°é«˜å¾·å¹³å°
    
- è·å¾—API Keyï¼Œè¿™æ˜¯è°ƒç”¨é«˜å¾·æœåŠ¡çš„å‰æ
    

**é…ç½®é¡¹ç›®ä¾èµ–ï¼š**

åœ¨`oh-package.json5`ä¸­æ·»åŠ ä¾èµ–ï¼š

json

json

å¤åˆ¶

```
{
  "dependencies": {
    "@amap/amap_lbs_map3d": "^2.2.5",
    "@amap/amap_lbs_search": "^1.0.2",
    "@amap/amap_lbs_common": "^1.2.3"
  }
}
```

è¿è¡Œ`ohpm install`å®‰è£…ä¾èµ–ã€‚

#### 2. æƒé™å£°æ˜å’Œåˆå§‹åŒ–

**åœ¨module.json5ä¸­å£°æ˜æƒé™ï¼š**

json

json

å¤åˆ¶

```
{
  "module": {
    "requestPermissions": [
      {
        "name": "ohos.permission.INTERNET",
        "reason": "åŠ è½½åœ°å›¾æ•°æ®"
      },
      {
        "name": "ohos.permission.LOCATION",
        "reason": "è·å–å½“å‰ä½ç½®ç”¨äºåœ°å›¾å®šä½"
      }
    ]
  }
}
```

**åœ¨EntryAbility.etsä¸­åˆå§‹åŒ–SDKï¼š**

typescript

typescript

å¤åˆ¶

```
import { MapsInitializer } from '@amap/amap_lbs_map3d';
import { AMapPrivacyShowStatus, AMapPrivacyInfoStatus, AMapPrivacyAgreeStatus } from '@amap/amap_lbs_common';

export default class EntryAbility extends UIAbility {
  onCreate(want: Want, launchParam: AbilityConstant.LaunchParam): void {
    // 1. éšç§åˆè§„é…ç½®ï¼ˆå¿…é¡»é¦–å…ˆè°ƒç”¨ï¼‰
    MapsInitializer.updatePrivacyShow(
      AMapPrivacyShowStatus.DidShow,
      AMapPrivacyInfoStatus.DidContain
    );
    MapsInitializer.updatePrivacyAgree(AMapPrivacyAgreeStatus.DidAgree);
    
    // 2. è®¾ç½®API Key
    MapsInitializer.setApiKey('ä½ çš„é«˜å¾·API Key'); // æ›¿æ¢ä¸ºå®é™…Key
    
    console.info('é«˜å¾·åœ°å›¾SDKåˆå§‹åŒ–å®Œæˆ');
  }
}
```

#### 3. åœ¨è§„åˆ’é¡µé›†æˆåœ°å›¾å®¹å™¨

**å®Œæ•´çš„åœ°å›¾é¡µé¢å®ç°ï¼š**

typescript

typescript

å¤åˆ¶

```
// TravelPlanPage.ets - å®Œæ•´åœ°å›¾é›†æˆç¤ºä¾‹
import { MapView, MapViewComponent, AMap, LatLng } from '@amap/amap_lbs_map3d';
import { SearchService } from '@amap/amap_lbs_search';

@Entry
@Component
struct TravelPlanPage {
  @State aMap: AMap | null = null;
  @State currentCenter: LatLng = { latitude: 39.909187, longitude: 116.397451 }; // é»˜è®¤åŒ—äº¬ä¸­å¿ƒ
  private searchService: SearchService = new SearchService();

  build() {
    Column() {
      // åœ°å›¾å®¹å™¨
      Stack() {
        MapComponent({
          mapOptions: {
            zoom: 12,
            center: this.currentCenter,
            zoomControlsEnabled: true,
            scaleControlsEnabled: true
          }
        })
        .width('100%')
        .height('80%')
        .onMapCreated((map: AMap) => {
          this.onMapCreated(map);
        })
        
        // åœ°å›¾ä¸Šçš„è¦†ç›–æ§ä»¶
        this.BuildMapOverlays()
      }
      
      // åº•éƒ¨æ“ä½œé¢æ¿
      this.BuildControlPanel()
    }
    .width('100%')
    .height('100%')
  }

  // åœ°å›¾åˆ›å»ºå›è°ƒ
  private onMapCreated(map: AMap): void {
    this.aMap = map;
    console.info('åœ°å›¾åˆå§‹åŒ–å®Œæˆ');
    
    // æ·»åŠ åœ°å›¾äº‹ä»¶ç›‘å¬
    this.setupMapEvents();
    
    // å¦‚æœå·²æœ‰æœç´¢å‚æ•°ï¼Œç›´æ¥æ‰§è¡Œè·¯çº¿è§„åˆ’
    if (this.searchQuery) {
      this.executeRoutePlanning();
    }
  }

  // è®¾ç½®åœ°å›¾äº‹ä»¶
  private setupMapEvents(): void {
    if (!this.aMap) return;
    
    // åœ°å›¾ç§»åŠ¨äº‹ä»¶
    this.aMap.on('cameraChange', (cameraPosition: any) => {
      this.currentCenter = cameraPosition.target;
    });
  }

  // æ‰§è¡Œè·¯çº¿è§„åˆ’
  private async executeRoutePlanning(): Promise<void> {
    if (!this.aMap || !this.searchQuery) return;
    
    try {
      const query = JSON.parse(this.searchQuery);
      const drivingResult = await this.searchService.searchDrivingRoute({
        origin: query.startPoint,
        destination: query.endPoint,
        strategy: this.getRouteStrategy() // æ ¹æ®åå¥½é€‰æ‹©ç­–ç•¥
      });
      
      // åœ¨åœ°å›¾ä¸Šç»˜åˆ¶è·¯çº¿
      this.drawRouteOnMap(drivingResult);
      
    } catch (error) {
      console.error('è·¯çº¿è§„åˆ’å¤±è´¥:', error);
    }
  }

  // æ„å»ºåœ°å›¾è¦†ç›–ç‰©
  @Builder
  BuildMapOverlays() {
    Stack() {
      // å®šä½æŒ‰é’®
      PositionComponent({
        onLocate: () => this.locateToCurrentPosition()
      })
      .position({ right: 20, top: 20 })
      
      // è·¯çº¿ä¿¡æ¯é¢æ¿
      if (this.routeInfo) {
        RouteInfoPanel({ info: this.routeInfo })
          .position({ bottom: 150, left: 20 })
      }
    }
  }

  // å®šä½åˆ°å½“å‰ä½ç½®
  private locateToCurrentPosition(): void {
    // è°ƒç”¨é«˜å¾·å®šä½SDKè·å–å½“å‰ä½ç½®
    // ç„¶åç§»åŠ¨åœ°å›¾ä¸­å¿ƒç‚¹åˆ°å½“å‰ä½ç½®
  }
}
```

### å®ç”¨æŠ€å·§ä¸æ³¨æ„äº‹é¡¹

1. **æ€§èƒ½ä¼˜åŒ–**
    
    - å¯¹äºé¢‘ç¹ä¼ é€’çš„æ•°æ®ï¼Œä½¿ç”¨AppStorageé¿å…é‡å¤åºåˆ—åŒ–
        
    - åœ°å›¾é¡µé¢åœ¨ä¸å¯è§æ—¶åŠæ—¶æ¸…ç†ç›‘å¬å™¨ï¼Œé¿å…å†…å­˜æ³„æ¼
        
    
2. **é”™è¯¯å¤„ç†**
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // è·¯ç”±è·³è½¬é”™è¯¯å¤„ç†
    router.pushUrl({url: 'pages/TravelPlanPage', params: {}})
      .then(() => console.info('è·³è½¬æˆåŠŸ'))
      .catch(error => {
        console.error('è·³è½¬å¤±è´¥:', error.code, error.message);
        // æä¾›ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º
      });
    ```
    
3. **æ•°æ®å®‰å…¨**
    
    - é¿å…é€šè¿‡è·¯ç”±ä¼ é€’æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç ã€tokenï¼‰
        
    - å¯¹ç”¨æˆ·è¾“å…¥çš„åœ°å›¾å‚æ•°è¿›è¡ŒéªŒè¯å’Œè½¬ä¹‰
        
    

è¿™äº›å®è·µæ–¹æ¡ˆåº”è¯¥èƒ½å¤Ÿå¸®åŠ©æ‚¨æ„å»ºä¸€ä¸ªç¨³å®šã€é«˜æ•ˆçš„é¸¿è’™å‡ºè¡Œåº”ç”¨ã€‚æ ¹æ®æ‚¨çš„å…·ä½“ä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„æ•°æ®ä¼ é€’æ–¹æ¡ˆï¼Œå¯ä»¥æ˜¾è‘—æå‡åº”ç”¨çš„å¯ç»´æŠ¤æ€§å’Œç”¨æˆ·ä½“éªŒã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/segmentfault_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/juejin_cn.ico)

æº

è¯·æä¾›åŒ…å«é«˜å¾·åœ°å›¾çš„å®Œæ•´ç¤ºä¾‹ä»£ç 

é«˜å¾·åœ°å›¾SDKé›†æˆåå¦‚ä½•å®ç°å®æ—¶è·¯å†µä¿¡æ¯ï¼Ÿ

å¦‚ä½•å®ç°åœ°å›¾é¡µé¢çš„è‡ªåŠ¨ç¼©æ”¾å’Œå®šä½ç²¾åº¦æ§åˆ¶ï¼Ÿ

é«˜å¾·åœ°å›¾SDKé›†æˆåå¦‚ä½•å®ç°å®æ—¶è·¯å†µä¿¡æ¯ï¼Ÿ

è¯·æä¾›åŒ…å«é«˜å¾·åœ°å›¾çš„å®Œæ•´ç¤ºä¾‹ä»£ç 

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶6ç§’)

å¥½çš„ï¼Œç”¨æˆ·è¯¢é—®çš„æ˜¯å¦‚ä½•åœ¨é¸¿è’™åº”ç”¨ä¸­é›†æˆé«˜å¾·åœ°å›¾SDKåå®ç°å®æ—¶è·¯å†µåŠŸèƒ½ï¼Œå¹¶å¸Œæœ›çœ‹åˆ°å®Œæ•´ç¤ºä¾‹ä»£ç ã€‚è¿™åº”è¯¥æ˜¯ä¸€ä¸ªæ­£åœ¨å¼€å‘å‡ºè¡Œç±»åº”ç”¨çš„å¼€å‘è€…ï¼Œå¯èƒ½é‡åˆ°äº†å…·ä½“çš„æŠ€æœ¯å®ç°é—®é¢˜ã€‚

æˆ‘éœ€è¦å…ˆç†è§£é«˜å¾·åœ°å›¾SDKä¸­å®æ—¶è·¯å†µåŠŸèƒ½çš„æ ¸å¿ƒå®ç°æ–¹å¼ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œä¸»è¦æœ‰ä¸¤ç§æŠ€æœ¯è·¯å¾„ï¼šä¸€ç§æ˜¯ä½¿ç”¨äº¤é€šæ€åŠ¿å›¾å±‚åœ¨åº•å›¾ä¸Šç›´æ¥å±•ç¤ºè·¯å†µ

ï¼Œå¦ä¸€ç§æ˜¯åœ¨è§„åˆ’è·¯çº¿ä¸Šå åŠ å®æ—¶è·¯å†µä¿¡æ¯ã€‚

ä»å®ç”¨æ€§è§’åº¦è€ƒè™‘ï¼Œç¬¬ä¸€ç§æ–¹æ¡ˆæ›´é€‚åˆå¿«é€Ÿé›†æˆã€‚æˆ‘çœ‹åˆ°

æä¾›äº†AMap.TileLayer.Trafficè¿™ä¸ªå®˜æ–¹ç±»ï¼Œå®ƒèƒ½å¤Ÿè‡ªåŠ¨ä»¥ä¸åŒé¢œè‰²æ˜¾ç¤ºé“è·¯æ‹¥å µç¨‹åº¦ï¼Œè¿˜æ”¯æŒè‡ªåŠ¨åˆ·æ–°ã€‚è€Œåˆ™å±•ç¤ºäº†å®Œæ•´çš„å®ç°ä»£ç ï¼ŒåŒ…æ‹¬å›¾å±‚æ§åˆ¶å’Œäº¤äº’é€»è¾‘ã€‚

ç”¨æˆ·ç‰¹åˆ«å¼ºè°ƒè¦"å®Œæ•´ç¤ºä¾‹ä»£ç "ï¼Œæ‰€ä»¥æˆ‘éœ€è¦æ„å»ºä¸€ä¸ªå¯è¿è¡Œçš„æ¡ˆä¾‹ã€‚æ ¸å¿ƒæ­¥éª¤åº”è¯¥åŒ…æ‹¬ï¼šåˆå§‹åŒ–åœ°å›¾ã€åˆ›å»ºäº¤é€šå›¾å±‚ã€æ·»åŠ æ§åˆ¶å¼€å…³ã€‚å…³é”®ç‚¹åœ¨äºtrafficLayer.setMap(map)è¿™è¡Œä»£ç ï¼Œè¿™æ˜¯æ¿€æ´»è·¯å†µæ˜¾ç¤ºçš„æ ¸å¿ƒ

ã€‚

è€ƒè™‘åˆ°ç”¨æˆ·å¯èƒ½éœ€è¦åœ¨ä¸åŒåœºæ™¯ä¸‹ä½¿ç”¨ï¼Œæˆ‘è¿˜åº”è¯¥è¡¥å……è·¯å†µå›¾å±‚çš„è¿›é˜¶æ§åˆ¶æ–¹æ³•ï¼Œæ¯”å¦‚æ‰‹åŠ¨åˆ·æ–°å’Œäº‹ä»¶ç›‘å¬

ã€‚åŒæ—¶è¦æé†’ç”¨æˆ·æ³¨æ„APIå¯†é’¥é…ç½®å’Œç½‘ç»œæƒé™ç”³è¯·ï¼Œè¿™äº›æ˜¯å®é™…å¼€å‘ä¸­å®¹æ˜“å‡ºé”™çš„ç¯èŠ‚ã€‚

è™½ç„¶

ä¸»è¦è®²çš„æ˜¯PHPå’ŒJavaæœåŠ¡ç«¯çš„å®ç°ï¼Œä¸é¸¿è’™å®¢æˆ·ç«¯å¼€å‘å…³ç³»ä¸å¤§ï¼Œä½†æåˆ°çš„è·¯çº¿è§„åˆ’çº§è·¯å†µæ–¹æ¡ˆå¯ä»¥ä½œä¸ºæ‹“å±•æ–¹å‘ï¼Œå½“ç”¨æˆ·éœ€è¦æ›´ç²¾ç¡®çš„å¯¼èˆªè·¯å†µæ—¶å¯ä»¥å€Ÿé‰´ã€‚

åœ¨é¸¿è’™åº”ç”¨ä¸­é›†æˆé«˜å¾·åœ°å›¾SDKåï¼Œå®ç°å®æ—¶è·¯å†µä¿¡æ¯ä¸»è¦å¯ä»¥é€šè¿‡**äº¤é€šæ€åŠ¿å›¾å±‚**å’Œ**è·¯çº¿è§„åˆ’è·¯å†µ**ä¸¤ç§æ–¹å¼ã€‚ä¸‹é¢æˆ‘ä¸ºä½ è¯¦ç»†ä»‹ç»è¿™ä¸¤ç§æ–¹æ³•ï¼Œå¹¶æä¾›å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚

### ğŸ—ºï¸ æ ¸å¿ƒæ–¹æ³•ä¸€ï¼šäº¤é€šæ€åŠ¿å›¾å±‚

è¿™ç§æ–¹å¼èƒ½åœ¨åœ°å›¾ä¸Šç›´è§‚å±•ç¤ºæ•´ä¸ªåŒºåŸŸçš„å®æ—¶è·¯å†µï¼Œéå¸¸é€‚åˆå‡ºè¡Œå‰äº†è§£æ•´ä½“äº¤é€šçŠ¶å†µã€‚

**æ ¸å¿ƒå®ç°æ­¥éª¤ï¼š**

1. **åˆ›å»ºå®æ—¶äº¤é€šè·¯å†µå›¾å±‚**ï¼šä½¿ç”¨ `AMap.TileLayer.Traffic`ç±»ã€‚
    
2. **é…ç½®å›¾å±‚å±æ€§**ï¼šå¦‚æ˜¯å¦è‡ªåŠ¨åˆ·æ–°ã€åˆ·æ–°é—´éš”ç­‰ã€‚
    
3. **å°†å›¾å±‚æ·»åŠ åˆ°åœ°å›¾**ï¼šé€šè¿‡ `map.add(trafficLayer)`å®ç°ã€‚
    

**å®Œæ•´ç¤ºä¾‹ä»£ç ï¼š**

html

html

ä¸‹è½½

å¤åˆ¶

é¢„è§ˆ

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no, width=device-width">
    <title>é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹-å®æ—¶è·¯å†µ</title>
    <style>
        html, body, #container {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <div id="container"></div>
    <script src="https://webapi.amap.com/maps?v=2.0&key=YOUR_API_KEY"></script>
    <script>
        // åˆå§‹åŒ–åœ°å›¾
        var map = new AMap.Map('container', {
            center: [116.397428, 39.90923], // åŒ—äº¬ä¸­å¿ƒç‚¹åæ ‡
            zoom: 11
        });

        // åˆ›å»ºå®æ—¶äº¤é€šå›¾å±‚[5](@ref)
        var trafficLayer = new AMap.TileLayer.Traffic({
            autoRefresh: true,    // è‡ªåŠ¨åˆ·æ–°
            interval: 180         // åˆ·æ–°é—´éš”180ç§’[5](@ref)
        });

        // å°†äº¤é€šå›¾å±‚æ·»åŠ åˆ°åœ°å›¾
        trafficLayer.setMap(map);

        // è·¯å†µå›¾å±‚æ§åˆ¶å‡½æ•°[3](@ref)
        var isTrafficVisible = true;
        
        function toggleTraffic() {
            if (isTrafficVisible) {
                trafficLayer.hide(); // éšè—è·¯å†µ
                isTrafficVisible = false;
            } else {
                trafficLayer.show(); // æ˜¾ç¤ºè·¯å†µ
                isTrafficVisible = true;
            }
        }

        // æ·»åŠ æ§åˆ¶æŒ‰é’®åˆ°åœ°å›¾
        map.addControl(new AMap.ToolBar());
    </script>
</body>
</html>
```

**å…³é”®é…ç½®è¯´æ˜ï¼š**

- **autoRefresh**ï¼šè®¾ä¸º `true`å¯å®ç°è·¯å†µè‡ªåŠ¨æ›´æ–°
    
    ã€‚
    
- **interval**ï¼šæ§åˆ¶è·¯å†µæ•°æ®åˆ·æ–°é¢‘ç‡ï¼Œå•ä½ä¸ºç§’
    
    ã€‚
    
- **è·¯å†µé¢œè‰²å«ä¹‰**ï¼šç»¿è‰²-é€šç•…ï¼Œé»„è‰²-ç¼“è¡Œï¼Œçº¢è‰²-æ‹¥å µï¼Œç°è‰²-æ— æ•°æ®ã€‚
    

### ğŸš— æ ¸å¿ƒæ–¹æ³•äºŒï¼šè·¯çº¿è§„åˆ’è·¯å†µ

è¿™ç§æ–¹å¼åœ¨å…·ä½“è·¯çº¿è§„åˆ’æ—¶æ˜¾ç¤ºè·¯å¾„ä¸Šçš„å®æ—¶è·¯å†µï¼Œæ›´é€‚åˆå¯¼èˆªåœºæ™¯ã€‚

**å®ç°æ­¥éª¤ï¼š**

1. **è¿›è¡Œè·¯çº¿è§„åˆ’**ï¼šä½¿ç”¨é©¾è½¦è·¯å¾„è§„åˆ’æ¥å£ã€‚
    
2. **å¼€å¯äº¤é€šçº¿æ˜¾ç¤º**ï¼šåœ¨è·¯çº¿è¦†ç›–ç‰©ä¸Šè®¾ç½®äº¤é€šçº¿åŠŸèƒ½
    
    ã€‚
    

**ç¤ºä¾‹ä»£ç ï¼š**

javascript

javascript

ä¸‹è½½

å¤åˆ¶

è¿è¡Œ

```
// ä»¥Androidå¯¼èˆªSDKä¸ºä¾‹[4](@ref)
// è®¡ç®—é©¾è½¦è·¯çº¿
List<NaviLatLng> startList = new ArrayList<>();
List<NaviLatLng> endList = new ArrayList<>();
startList.add(new NaviLatLng(39.989614, 116.481763));
endList.add(new NaviLatLng(39.983456, 116.315495));

mAMapNavi.calculateDriveRoute(startList, endList, null, PathPlanningStrategy.DRIVING_DEFAULT);

// è·¯çº¿è§„åˆ’æˆåŠŸå›è°ƒ
@Override
public void onCalculateRouteSuccess(AMapNaviRoute naviRoute) {
    // åˆ›å»ºè·¯çº¿è¦†ç›–ç‰©
    RouteOverLay routeOverlay = new RouteOverLay(mAMap, naviRoute.getPath(), this);
    routeOverlay.setTrafficLine(true); // å¼€å¯äº¤é€šçº¿æ˜¾ç¤º[4](@ref)
    routeOverlay.addToMap(); // æ·»åŠ åˆ°åœ°å›¾[4](@ref)
    
    // è®¾ç½®è·¯çº¿å±‚çº§å’Œé€æ˜åº¦
    routeOverlay.setTransparency(0.8f); // è®¾ç½®é€æ˜åº¦[4](@ref)
}
```

### ğŸ”§ è¿›é˜¶åŠŸèƒ½ä¸ä¼˜åŒ–å»ºè®®

1. **è·¯å†µå›¾å±‚æ§åˆ¶**
    
    javascript
    
    javascript
    
    ä¸‹è½½
    
    å¤åˆ¶
    
    è¿è¡Œ
    
    ```
    // æ‰‹åŠ¨åˆ·æ–°è·¯å†µæ•°æ®
    trafficLayer.reload();
    
    // ç›‘å¬è·¯å†µå›¾å±‚äº‹ä»¶
    trafficLayer.on('complete', function(){
        console.log('è·¯å†µæ•°æ®åŠ è½½å®Œæˆ');
    });
    ```
    
2. **æ€§èƒ½ä¼˜åŒ–å»ºè®®**
    
    - åœ¨ä¸éœ€è¦å®æ—¶è·¯å†µæ—¶åŠæ—¶ç§»é™¤å›¾å±‚ï¼š`map.remove(trafficLayer)`
        
    - æ ¹æ®ç¼©æ”¾çº§åˆ«åŠ¨æ€æ˜¾ç¤ºè·¯å†µï¼Œé¿å…åœ¨å°æ¯”ä¾‹å°ºä¸‹ä¸å¿…è¦çš„æ¸²æŸ“
        
    - ä½¿ç”¨åˆé€‚çš„åˆ·æ–°é—´éš”å¹³è¡¡å®æ—¶æ€§å’Œæ€§èƒ½
        
    
3. **é”™è¯¯å¤„ç†**
    
    javascript
    
    javascript
    
    ä¸‹è½½
    
    å¤åˆ¶
    
    è¿è¡Œ
    
    ```
    try {
        trafficLayer.setMap(map);
    } catch (error) {
        console.error('è·¯å†µå›¾å±‚åŠ è½½å¤±è´¥:', error);
        // é™çº§æ–¹æ¡ˆï¼šæ˜¾ç¤ºé™æ€è·¯å†µæç¤º
    }
    ```
    

### âš ï¸ å®æ–½æ³¨æ„äº‹é¡¹

1. **APIå¯†é’¥é…ç½®**ï¼šç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„é«˜å¾·åœ°å›¾API Key
    
    ã€‚
    
2. **ç½‘ç»œæƒé™**ï¼šå®æ—¶è·¯å†µéœ€è¦ç½‘ç»œè¿æ¥ï¼Œç¡®ä¿åº”ç”¨æœ‰ç›¸åº”çš„ç½‘ç»œæƒé™
    
    ã€‚
    
3. **ç”¨æˆ·ä½“éªŒ**ï¼šé¦–æ¬¡åŠ è½½è·¯å†µæ—¶æ·»åŠ åŠ è½½æç¤ºï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚
    

ä»¥ä¸Šä¸¤ç§æ–¹æ¡ˆå¯ä»¥æ ¹æ®ä½ çš„å…·ä½“éœ€æ±‚é€‰æ‹©ä½¿ç”¨ã€‚äº¤é€šæ€åŠ¿å›¾å±‚é€‚åˆå®è§‚è·¯å†µå±•ç¤ºï¼Œè€Œè·¯çº¿è§„åˆ’è·¯å†µæ›´é€‚åˆå…·ä½“çš„å¯¼èˆªåœºæ™¯ã€‚å»ºè®®å…ˆå®ç°åŸºç¡€çš„è·¯å†µå›¾å±‚åŠŸèƒ½ï¼Œå†æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€æ­¥å®Œå–„é«˜çº§ç‰¹æ€§ã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/m_php_cn.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/developer_amap_com.ico)

æº

èƒ½å¦æä¾›é¸¿è’™åº”ç”¨ä¸­é«˜å¾·å®æ—¶è·¯å†µç¤ºä¾‹ä»£ç ï¼Ÿ

é¸¿è’™æ™ºè¡ŒåŠ©æ‰‹å¦‚ä½•å®ç°å¤šé€”ç»ç‚¹å®æ—¶è·¯å†µï¼Ÿ

å¦‚ä½•å®ç°è·¯å†µå›¾å±‚çš„è‡ªå®šä¹‰æ ·å¼ï¼Œæ¯”å¦‚é¢œè‰²å’Œå›¾æ ‡ï¼Ÿ

é¡µé¢é—´æ•°æ®ä¼ é€’çš„æœ€ä½³å®è·µï¼Œæ¯”å¦‚ä»é¦–é¡µè·³è½¬åˆ°è§„åˆ’é¡µæ—¶å¦‚ä½•ä¼ é€’æœç´¢å‚æ•°ï¼Ÿ

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶6ç§’)

å¥½çš„ï¼Œç”¨æˆ·æ­£åœ¨å¼€å‘ä¸€ä¸ªé¸¿è’™åº”ç”¨ï¼Œå…·ä½“åœºæ™¯æ˜¯ä»é¦–é¡µè·³è½¬åˆ°è§„åˆ’é¡µæ—¶éœ€è¦ä¼ é€’æœç´¢å‚æ•°ã€‚è¿™æ¶‰åŠåˆ°é¡µé¢é—´æ•°æ®ä¼ é€’çš„é—®é¢˜ï¼Œç”¨æˆ·æƒ³è¦äº†è§£æœ€ä½³å®è·µã€‚ä»å¯¹è¯å†å²æ¥çœ‹ï¼Œç”¨æˆ·ä¹‹å‰å·²ç»åœ¨å¼€å‘ä¸€ä¸ªé¸¿è’™æ™ºè¡ŒåŠ©æ‰‹ï¼Œç°åœ¨é‡åˆ°äº†å…·ä½“çš„å®ç°é—®é¢˜ã€‚

ç”¨æˆ·å¯èƒ½ä¸ä»…æƒ³çŸ¥é“åŸºç¡€çš„æ“ä½œæ–¹æ³•ï¼Œæ›´å¸Œæœ›äº†è§£ä¸åŒåœºæ™¯ä¸‹çš„æœ€ä½³é€‰æ‹©ï¼Œä»¥åŠå¦‚ä½•é¿å…å¸¸è§é™·é˜±ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå®é™…çš„å¼€å‘é—®é¢˜ï¼Œéœ€è¦ç»™å‡ºæ¸…æ™°å®ç”¨çš„æŒ‡å¯¼ã€‚

æˆ‘çœ‹åˆ°äº†å¾ˆå¤šå…³äºé¸¿è’™é¡µé¢é—´æ•°æ®ä¼ é€’çš„æœç´¢ç»“æœï¼Œå†…å®¹éƒ½æ¯”è¾ƒè¯¦ç»†ã€‚

å’Œæä¾›äº†æœ€å…¨é¢çš„è·¯ç”±ä¼ å‚æ–¹æ¡ˆï¼Œæ¶µç›–äº†åŸºæœ¬çš„router.pushUrlä½¿ç”¨æ–¹æ³•å’Œå‚æ•°å¤„ç†ã€‚è¿˜æœ‰ä¸€ä¸ªå¾ˆå®ç”¨çš„å®æˆ˜æ¡ˆä¾‹ï¼Œå±•ç¤ºäº†å•†å“åˆ—è¡¨åˆ°è¯¦æƒ…é¡µçš„å®Œæ•´æµç¨‹ã€‚

å’Œå¯¹ä¸åŒçš„æ•°æ®ä¼ é€’æ–¹å¼è¿›è¡Œäº†ç³»ç»Ÿçš„å¯¹æ¯”åˆ†æï¼ŒåŒ…æ‹¬AppStorageã€LocalStorageç­‰ï¼Œè¿™å¯¹ç”¨æˆ·é€‰æ‹©åˆé€‚æ–¹æ¡ˆå¾ˆæœ‰å¸®åŠ©ã€‚è¿˜æåˆ°äº†emitteräº‹ä»¶æ€»çº¿çš„æ–¹å¼ï¼Œå¯ä»¥ä½œä¸ºè¡¥å……æ–¹æ¡ˆã€‚

è¿™äº›æœç´¢ç»“æœçš„è´¨é‡æ•´ä½“ä¸é”™ï¼Œéƒ½æ˜¯æŠ€æœ¯åšå®¢å†…å®¹ï¼Œè™½ç„¶æƒå¨æ€§ä¸ç®—å¾ˆé«˜ï¼Œä½†æä¾›çš„ä»£ç ç¤ºä¾‹å’Œæ€è·¯æ¯”è¾ƒå®ç”¨ã€‚æˆ‘éœ€è¦æŠŠè¿™äº›ä¿¡æ¯æ•´åˆæˆä¸€ä¸ªæ¸…æ™°çš„æŒ‡å—ï¼ŒæŒ‰ç…§ä»ç®€å•åˆ°å¤æ‚çš„é¡ºåºæ¥ç»„ç»‡ï¼Œå¸®åŠ©ç”¨æˆ·æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©åˆé€‚çš„æ–¹æ³•ã€‚

æˆ‘å‡†å¤‡å…ˆç”¨ä¸€ä¸ªè¡¨æ ¼å¯¹æ¯”ä¸åŒæ–¹æ¡ˆï¼Œè®©ç”¨æˆ·å¿«é€Ÿäº†è§£å„ç§é€‰æ‹©ï¼Œç„¶åè¯¦ç»†è¯´æ˜æœ€å¸¸ç”¨çš„è·¯ç”±ä¼ å‚æ–¹æ¡ˆï¼Œæœ€åè¡¥å……å…¶ä»–é«˜çº§æ–¹æ¡ˆçš„ä½¿ç”¨åœºæ™¯ã€‚è¡¨æ ¼å¯ä»¥çªå‡ºæ¯ç§æ–¹æ¡ˆçš„æ ¸å¿ƒç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯ï¼Œè¿™æ ·ç”¨æˆ·èƒ½å¿«é€Ÿåšå‡ºé€‰æ‹©ã€‚å¯¹äºè·¯ç”±ä¼ å‚è¿™ç§æœ€å¸¸ç”¨çš„æ–¹æ¡ˆï¼Œæˆ‘éœ€è¦ç»™å‡ºå®Œæ•´çš„ä»£ç ç¤ºä¾‹ï¼ŒåŒ…æ‹¬å‚æ•°ä¼ é€’å’Œæ¥æ”¶çš„å®Œæ•´æµç¨‹ï¼Œä»¥åŠé”™è¯¯å¤„ç†ç­‰ç»†èŠ‚ã€‚å…¶ä»–æ–¹æ¡ˆå¯ä»¥ç®€è¦è¯´æ˜é€‚ç”¨åœºæ™¯ï¼Œè®©ç”¨æˆ·çŸ¥é“åœ¨ä»€ä¹ˆæƒ…å†µä¸‹åº”è¯¥è€ƒè™‘ä½¿ç”¨ã€‚

åœ¨é¸¿è’™åº”ç”¨å¼€å‘ä¸­ï¼Œé¡µé¢é—´æ•°æ®ä¼ é€’æ˜¯æ„å»ºæµç•…ç”¨æˆ·ä½“éªŒçš„å…³é”®ã€‚ä¸‹é¢è¿™ä¸ªè¡¨æ ¼æ±‡æ€»äº†ä¸åŒåœºæ™¯ä¸‹çš„æœ€ä½³å®è·µæ–¹æ¡ˆï¼Œæ–¹ä¾¿ä½ å¿«é€Ÿé€‰æ‹©ã€‚

|ä¼ é€’æ–¹å¼|æ ¸å¿ƒç‰¹ç‚¹|é€‚ç”¨åœºæ™¯|æ•°æ®é‡å»ºè®®|
|---|---|---|---|
|**è·¯ç”±å‚æ•°ä¼ é€’**â€‹|é¡µé¢è·³è½¬æ—¶ä¸€æ¬¡æ€§ä¼ å…¥ï¼Œç®€å•ç›´æ¥|ä¼ é€’æœç´¢å…³é”®è¯ã€ç›®çš„åœ°ã€ç”¨æˆ·IDç­‰åˆå§‹åŒ–å‚æ•°|å»ºè®®å°äº **1MB**|
|**AppStorage**â€‹|åº”ç”¨å…¨å±€å“åº”å¼å…±äº«ï¼Œæ•°æ®å˜åŒ–æ‰€æœ‰å…³è”é¡µé¢è‡ªåŠ¨æ›´æ–°|ç”¨æˆ·ç™»å½•çŠ¶æ€ã€åº”ç”¨ä¸»é¢˜ã€å…¨å±€è®¾ç½®ç­‰|æ ¹æ®å®é™…éœ€è¦|
|**LocalStorage**â€‹|Abilityå†…é¡µé¢é—´å“åº”å¼å…±äº«ï¼Œç”Ÿå‘½å‘¨æœŸä¸Abilityä¸€è‡´|åŒä¸€åŠŸèƒ½æ¨¡å—å†…å¤šä¸ªé¡µé¢å…±äº«æ•°æ®ï¼ˆå¦‚è´­ç‰©è½¦ï¼‰|æ ¹æ®å®é™…éœ€è¦|
|**é¡µé¢è¿”å›ä¼ å€¼**â€‹|ä»ç›®æ ‡é¡µé¢è¿”å›æ—¶æºå¸¦ç»“æœæ•°æ®|ç›®çš„åœ°é€‰æ‹©ã€é…ç½®ç¡®è®¤ç­‰éœ€è¦å›ä¼ ç»“æœçš„åœºæ™¯|æ ¹æ®å®é™…éœ€è¦|
|**EventHub/emitter**â€‹|äº‹ä»¶é©±åŠ¨ï¼Œé€‚ç”¨äºé¡µé¢é—´æ¾è€¦åˆé€šä¿¡|é€šçŸ¥å…¶ä»–é¡µé¢æ‰§è¡Œæ“ä½œï¼ˆå¦‚åˆ·æ–°åˆ—è¡¨ï¼‰|æ ¹æ®å®é™…éœ€è¦|

### ğŸ’¡ è·¯ç”±å‚æ•°ä¼ é€’ï¼ˆæœ€å¸¸ç”¨ï¼‰

å¯¹äºä»é¦–é¡µè·³è½¬åˆ°è§„åˆ’é¡µä¼ é€’æœç´¢å‚æ•°è¿™ç§åœºæ™¯ï¼Œ**è·¯ç”±å‚æ•°ä¼ é€’**æ˜¯æœ€å¸¸ç”¨å’Œç›´æ¥çš„æ–¹å¼ã€‚

1. **åœ¨é¦–é¡µï¼ˆIndex.etsï¼‰ä¼ é€’å‚æ•°**
    
    ä½¿ç”¨ `router.pushUrl`æ–¹æ³•ï¼Œé€šè¿‡ `params`å­—æ®µæºå¸¦å‚æ•°ã€‚å¦‚æœå‚æ•°æ˜¯å¯¹è±¡ï¼Œè®°å¾—å…ˆåºåˆ—åŒ–
    
    ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    import router from '@ohos.router';
    
    // ç¤ºä¾‹ï¼šç‚¹å‡»æœç´¢æŒ‰é’®æˆ–æ¨èè·¯çº¿æ—¶è·³è½¬
    onSearchConfirmed() {
      const searchParams = {
        startPoint: this.currentLocation,
        endPoint: this.searchText,
        transportMode: this.selectedTransportMode,
        timestamp: new Date().getTime() // å¯é€‰ï¼Œç”¨äºæ ‡è¯†æœç´¢æ—¶é—´
      };
    
      router.pushUrl({
        url: 'pages/TravelPlanPage',
        params: {
          // å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²
          searchQuery: JSON.stringify(searchParams),
          // ä¹Ÿå¯ä»¥ç›´æ¥ä¼ é€’ç®€å•å‚æ•°
          directEndPoint: this.searchText
        }
      }).catch((error) => {
        console.error('è·³è½¬å¤±è´¥:', error);
      });
    }
    ```
    
2. **åœ¨è§„åˆ’é¡µï¼ˆTravelPlanPage.etsï¼‰æ¥æ”¶å‚æ•°**
    
    åœ¨ç›®æ ‡é¡µé¢çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ˆå¦‚ `onPageShow`æˆ– `aboutToAppear`ï¼‰ä¸­ï¼Œä½¿ç”¨ `router.getParams()`è·å–å‚æ•°ï¼Œå¹¶è¿›è¡Œæ ¡éªŒå’Œè§£æ
    
    ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    import router from '@ohos.router';
    
    @Entry
    @Component
    struct TravelPlanPage {
      @State searchQuery: string = '';
      @State endPoint: string = '';
      @State parsedParams: any = null; // ç”¨äºå­˜å‚¨è§£æåçš„å‚æ•°å¯¹è±¡
    
      onPageShow() {
        // åœ¨é¡µé¢æ˜¾ç¤ºæ—¶è·å–å‚æ•°
        const params = router.getParams();
        if (params) {
          try {
            this.searchQuery = params['searchQuery'] as string || '';
            this.endPoint = params['directEndPoint'] as string || '';
    
            // è§£æJSONå­—ç¬¦ä¸²
            if (this.searchQuery) {
              this.parsedParams = JSON.parse(this.searchQuery);
              console.log('æ¥æ”¶åˆ°æœç´¢å‚æ•°:', this.parsedParams);
              // è°ƒç”¨æ–¹æ³•ï¼Œä½¿ç”¨å‚æ•°åˆå§‹åŒ–è§„åˆ’é¡µ
              this.initWithSearchParams(this.parsedParams);
            }
          } catch (error) {
            console.error('å‚æ•°è§£æé”™è¯¯:', error);
            // å¯ä»¥åœ¨è¿™é‡Œè®¾ç½®é»˜è®¤å€¼æˆ–ç»™å‡ºç”¨æˆ·æç¤º
          }
        }
      }
    
      // ä½¿ç”¨å‚æ•°åˆå§‹åŒ–é¡µé¢çŠ¶æ€
      private initWithSearchParams(params: any) {
        // ä¾‹å¦‚ï¼Œæ ¹æ®å‚æ•°è°ƒç”¨é«˜å¾·åœ°å›¾APIè¿›è¡Œè·¯çº¿è§„åˆ’
        this.calculateRoute(params.startPoint, params.endPoint, params.transportMode);
      }
    }
    ```
    

### ğŸ”„ å…¶ä»–åœºæ™¯çš„å®ç”¨æ–¹æ³•

- **ä½¿ç”¨AppStorageç®¡ç†å…¨å±€çŠ¶æ€**ï¼šå½“æ•°æ®ï¼ˆå¦‚ç”¨æˆ·åå¥½è®¾ç½®ã€ç™»å½•çŠ¶æ€ï¼‰éœ€è¦åœ¨**å¤šä¸ªä¸ç›´æ¥å…³è”çš„é¡µé¢**å…±äº«ï¼Œå¹¶ä¸”å¸Œæœ›æ•°æ®å˜åŒ–æ—¶ç›¸å…³UIèƒ½è‡ªåŠ¨æ›´æ–°æ—¶ï¼Œ`AppStorage`æ˜¯ç†æƒ³é€‰æ‹©
    
    ã€‚ä½¿ç”¨æ–¹æ³•æ˜¯åœ¨éœ€è¦å…±äº«æ•°æ®çš„åœ°æ–¹ä½¿ç”¨ `@StorageLink`è£…é¥°å™¨ã€‚
    
- **éœ€è¦å›ä¼ ç»“æœæ—¶ä½¿ç”¨é¡µé¢è¿”å›ä¼ å€¼**ï¼šå½“ä»è§„åˆ’é¡µé€‰æ‹©æŸä¸ªå…·ä½“æ–¹æ¡ˆåï¼Œéœ€è¦è¿”å›é¦–é¡µå¹¶æºå¸¦ç»“æœæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `router.pushUrlForResult`è·³è½¬ï¼Œåœ¨è§„åˆ’é¡µä½¿ç”¨ `router.back`è¿”å›ç»“æœ
    
    ã€‚
    

### âš ï¸ é¿å‘æŒ‡å—

- **å‚æ•°å¤§å°é™åˆ¶**ï¼šé¿å…é€šè¿‡è·¯ç”±ä¼ é€’è¿‡å¤§çš„æ•°æ®ï¼ˆå¦‚é«˜æ¸…å›¾ç‰‡ã€å¤§å‹æ•°æ®é›†ï¼‰ï¼Œè¿™å¯èƒ½å¼•å‘æ€§èƒ½é—®é¢˜æˆ–ä¼ é€’å¤±è´¥ã€‚å¯¹äºå¤§æ•°æ®ï¼Œè€ƒè™‘ä½¿ç”¨ `AppStorage`æˆ–æ•°æ®åº“ç­‰æ–¹å¼
    
    ã€‚
    
- **æ•æ„Ÿä¿¡æ¯å¤„ç†**ï¼šåˆ‡å‹¿é€šè¿‡è·¯ç”±å‚æ•°ä¼ é€’å¯†ç ã€ä»¤ç‰Œç­‰æ•æ„Ÿä¿¡æ¯ï¼Œå› ä¸ºè¿™äº›å‚æ•°å¯èƒ½åœ¨æ—¥å¿—æˆ–è°ƒè¯•å·¥å…·ä¸­å¯è§ã€‚
    
- **å‚æ•°æ ¡éªŒ**ï¼šå§‹ç»ˆå¯¹è·å–åˆ°çš„å‚æ•°è¿›è¡Œæœ‰æ•ˆæ€§æ ¡éªŒï¼Œé˜²æ­¢å› å‚æ•°ç¼ºå¤±æˆ–æ ¼å¼é”™è¯¯å¯¼è‡´é¡µé¢å´©æºƒ
    
    ã€‚
    
- **é¡µé¢æ³¨å†Œ**ï¼šç¡®ä¿ç›®æ ‡é¡µé¢å·²åœ¨ `src/main/resources/base/profile/main_pages.json`æ–‡ä»¶ä¸­æ­£ç¡®æ³¨å†Œï¼Œå¦åˆ™è·¯ç”±è·³è½¬ä¼šå¤±è´¥
    
    ã€‚
    

å¸Œæœ›è¿™äº›å…·ä½“çš„æ–¹æ¡ˆå’Œä»£ç ç¤ºä¾‹èƒ½å¸®åŠ©ä½ é¡ºåˆ©å®ç°é¡µé¢é—´çš„æ•°æ®ä¼ é€’ã€‚å¦‚æœä½ åœ¨å®ç°è¿‡ç¨‹ä¸­é‡åˆ°æ›´å…·ä½“çš„åœºæ™¯æˆ–é—®é¢˜ï¼Œæ¬¢è¿éšæ—¶æå‡ºï¼

![](https://cdn-yb.icon.qq.com/zuowei_dir/segmentfault_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_51cto_com.ico)

æº

å¦‚ä½•åœ¨è§„åˆ’é¡µç›‘å¬é¦–é¡µæœç´¢å‚æ•°å˜åŒ–ï¼Ÿ

é¸¿è’™åº”ç”¨ä¸­é¡µé¢é—´æ•°æ®ä¼ é€’æœ‰å“ªäº›é«˜çº§ç”¨æ³•ï¼Ÿ

å¦‚ä½•å®ç°é¡µé¢è¿”å›æ—¶æºå¸¦å¤§é‡æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ã€æ–‡ä»¶ï¼‰ï¼Ÿ

å¦‚ä½•å°†é«˜å¾·åœ°å›¾SDKå®Œæ•´é›†æˆåˆ°ç¤ºä¾‹ä¸­çš„åœ°å›¾å®¹å™¨åŒºåŸŸï¼Ÿ

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶6ç§’)

å¥½çš„ï¼Œç”¨æˆ·è¿™æ¬¡é—®çš„æ˜¯å¦‚ä½•å°†é«˜å¾·åœ°å›¾SDKå®Œæ•´é›†æˆåˆ°é¸¿è’™åº”ç”¨çš„åœ°å›¾å®¹å™¨åŒºåŸŸã€‚ä»å¯¹è¯å†å²çœ‹ï¼Œç”¨æˆ·ä¹‹å‰å·²ç»äº†è§£äº†é¡µé¢é—´æ•°æ®ä¼ é€’å’Œå®æ—¶è·¯å†µç­‰æ¦‚å¿µï¼Œç°åœ¨éœ€è¦å…·ä½“çš„é›†æˆæŒ‡å¯¼ã€‚è¿™åº”è¯¥æ˜¯ä¸€ä¸ªæ­£åœ¨å¼€å‘é¸¿è’™åº”ç”¨çš„å¼€å‘è€…ï¼Œå¯èƒ½æ­£åœ¨æ„å»ºä¸€ä¸ªéœ€è¦åœ°å›¾åŠŸèƒ½çš„åº”ç”¨ã€‚

æˆ‘æ‰“ç®—ä»é¡¹ç›®é…ç½®ã€ä»£ç é›†æˆåˆ°åŠŸèƒ½å®ç°çš„å®Œæ•´æµç¨‹æ¥å›ç­”ã€‚é¦–å…ˆéœ€è¦è¯´æ˜åŸºæœ¬çš„ä¾èµ–é…ç½®å’Œæƒé™è®¾ç½®ï¼Œè¿™æ˜¯é›†æˆçš„åŸºç¡€ã€‚ç„¶åè¦è¯¦ç»†è¯´æ˜å¦‚ä½•åœ¨ArkTSé¡µé¢ä¸­åˆå§‹åŒ–å’Œæ˜¾ç¤ºåœ°å›¾ï¼Œè¿™åŒ…æ‹¬åœ°å›¾å®¹å™¨çš„åˆ›å»ºã€ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ä»¥åŠåŸºæœ¬çš„åœ°å›¾æ“ä½œã€‚æœ€åå¯ä»¥è¡¥å……ä¸€äº›å¢å¼ºåŠŸèƒ½ï¼Œæ¯”å¦‚å®æ—¶è·¯å†µå’Œè‡ªå®šä¹‰æ ‡è®°ï¼Œè®©å›ç­”æ›´å®ç”¨ã€‚

æ ¹æ®æœç´¢ç»“æœï¼Œ

å’Œæä¾›äº†æœ€æƒå¨å’Œè¯¦ç»†çš„é›†æˆæŒ‡å—ï¼Œç‰¹åˆ«æ˜¯å¯¹åœ°å›¾ç”Ÿå‘½å‘¨æœŸçš„è®²è§£å¾ˆé€å½»ã€‚è™½ç„¶æƒå¨æ€§ç¨ä½ä½†æä¾›äº†å®é™…å¯è¿è¡Œçš„demoä»£ç ï¼Œå¾ˆæœ‰å‚è€ƒä»·å€¼ã€‚å’Œçš„åšå®¢å†…å®¹å¯ä»¥ä½œä¸ºè¡¥å……ï¼Œè€Œçš„é—®ç­”ç›¸å…³æ€§è¾ƒå¼±ï¼Œæˆ‘ä¼šè°¨æ…å‚è€ƒã€‚

æˆ‘ä¼šå…ˆæ•´ç†å‡ºæ¸…æ™°çš„æ­¥éª¤è¡¨æ ¼ï¼Œè®©ç”¨æˆ·å¯¹æ•´ä½“æµç¨‹æœ‰æŠŠæ¡ï¼Œç„¶åå†å±•å¼€æ¯ä¸ªæ­¥éª¤çš„ç»†èŠ‚ã€‚è¿™æ ·æ—¢ä¿è¯é€»è¾‘æ¸…æ™°ï¼Œåˆèƒ½æä¾›è¶³å¤Ÿçš„æŠ€æœ¯æ·±åº¦ã€‚ç‰¹åˆ«è¦æ³¨æ„å¼ºè°ƒåƒæƒé™å£°æ˜ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†è¿™äº›å®¹æ˜“å‡ºé”™çš„ç¯èŠ‚ï¼Œå¸®åŠ©ç”¨æˆ·é¿å…å¸¸è§é™·é˜±ã€‚

åœ¨é¸¿è’™åº”ç”¨ä¸­å®Œæ•´é›†æˆé«˜å¾·åœ°å›¾SDKï¼Œå…³é”®åœ¨äºæ­£ç¡®çš„é¡¹ç›®é…ç½®ã€åœ°å›¾å®¹å™¨çš„åˆ›å»ºä¸ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚ä¸‹é¢ä¸ºæ‚¨æ¢³ç†æ ¸å¿ƒæ­¥éª¤å’Œä»£ç ç¤ºä¾‹ã€‚

### ğŸ“‹ é¡¹ç›®é…ç½®

é¦–å…ˆï¼Œéœ€è¦è¿›è¡Œå¿…è¦çš„é¡¹ç›®é…ç½®ï¼ŒåŒ…æ‹¬æƒé™å£°æ˜å’Œä¾èµ–å¼•å…¥ã€‚

1. **å£°æ˜æƒé™**ï¼šåœ¨ `module.json5`æ–‡ä»¶ä¸­å£°æ˜ç½‘ç»œå’Œå®šä½æƒé™ï¼Œè¿™æ˜¯åœ°å›¾èƒ½å¤ŸåŠ è½½æ•°æ®å’Œè·å–ä½ç½®çš„åŸºç¡€
    
    ã€‚
    
    json
    
    json
    
    å¤åˆ¶
    
    ```
    {
      "module": {
        "requestPermissions": [
          {
            "name": "ohos.permission.INTERNET",
            "reason": "ç”¨äºåŠ è½½åœ°å›¾ç“¦ç‰‡æ•°æ®"
          },
          {
            "name": "ohos.permission.LOCATION",
            "reason": "ç”¨äºè·å–è®¾å¤‡å½“å‰ä½ç½®å¹¶åœ¨åœ°å›¾ä¸Šæ˜¾ç¤º",
            "usedScene": {
              "abilities": ["EntryAbility"],
              "when": "inuse"
            }
          }
        ]
      }
    }
    ```
    
2. **æ·»åŠ ä¾èµ–**ï¼šåœ¨é¡¹ç›®çš„ `oh-package.json5`æ–‡ä»¶ä¸­æ·»åŠ é«˜å¾·åœ°å›¾SDKçš„ä¾èµ–
    
    ã€‚
    
    json
    
    json
    
    å¤åˆ¶
    
    ```
    {
      "dependencies": {
        "@amap/amap_lbs_common": ">=1.2.2",
        "@amap/amap_lbs_map3d": ">=2.2.4",
        "@amap/amap_lbs_search": ">=1.0.1"
      }
    }
    ```
    
    æ·»åŠ åï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œ `ohpm install`å‘½ä»¤æ¥å®‰è£…ä¾èµ–ã€‚
    

### ğŸ—ºï¸ åœ°å›¾åˆå§‹åŒ–ä¸æ˜¾ç¤º

é…ç½®å®Œæˆåï¼Œå³å¯åœ¨Abilityå’Œé¡µé¢ä¸­åˆå§‹åŒ–å’Œæ˜¾ç¤ºåœ°å›¾ã€‚

1. **åœ¨EntryAbilityä¸­åˆå§‹åŒ–SDK**ï¼šåœ¨åº”ç”¨å…¥å£åˆå§‹åŒ–åœ°å›¾SDKå¹¶è®¾ç½®API Keyï¼Œæ³¨æ„éšç§åˆè§„é…ç½®åº”æœ€å…ˆè®¾ç½®
    
    ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // EntryAbility.ets
    import { MapsInitializer } from '@amap/amap_lbs_map3d';
    import { AMapPrivacyShowStatus, AMapPrivacyInfoStatus, AMapPrivacyAgreeStatus } from '@amap/amap_lbs_common';
    
    export default class EntryAbility extends UIAbility {
      onCreate(want: Want, launchParam: AbilityConstant.LaunchParam): void {
        // 1. éšç§åˆè§„é…ç½®ï¼ˆå¿…é¡»é¦–å…ˆè°ƒç”¨ï¼‰
        MapsInitializer.updatePrivacyShow(AMapPrivacyShowStatus.DidShow, AMapPrivacyInfoStatus.DidContain);
        MapsInitializer.updatePrivacyAgree(AMapPrivacyAgreeStatus.DidAgree);
    
        // 2. è®¾ç½®API Key
        MapsInitializer.setApiKey("æ‚¨çš„é«˜å¾·åœ°å›¾API Key"); // è¯·æ›¿æ¢ä¸ºå®é™…Key
      }
    }
    ```
    
2. **åœ¨é¡µé¢ä¸­åˆ›å»ºåœ°å›¾å®¹å™¨**ï¼šåœ¨é¡µé¢ç»„ä»¶ä¸­ï¼Œä½¿ç”¨ `MapViewComponent`å¹¶ç®¡ç†åœ°å›¾çš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™æ˜¯åœ°å›¾æ˜¾ç¤ºçš„æ ¸å¿ƒ
    
    ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    // MapPage.ets
    import {
      AMap,
      MapView,
      MapViewComponent,
      MapViewManager,
      MapViewCreateCallback,
      CameraUpdateFactory,
      LatLng
    } from '@amap/amap_lbs_map3d';
    
    const MAP_VIEW_NAME = 'MyMap';
    
    @Entry
    @Component
    struct MapPage {
      private mapView: MapView | undefined = undefined;
      private aMap: AMap | undefined = undefined;
      @State isMapReady: boolean = false;
    
      // åœ°å›¾åˆ›å»ºå›è°ƒ
      private mapViewCreateCallback: MapViewCreateCallback = (mapview: MapView | undefined, mapViewName: string | undefined) => {
        if (!mapview || mapViewName !== MAP_VIEW_NAME) {
          return;
        }
        this.mapView = mapview;
        this.mapView.onCreate(); // åˆå§‹åŒ–åœ°å›¾ï¼Œå¿…é¡»è°ƒç”¨ [4](@ref)
    
        this.mapView.getMapAsync((map: AMap) => {
          this.aMap = map;
          this.isMapReady = true;
          // åœ°å›¾å°±ç»ªï¼Œå¯è¿›è¡Œåç»­æ“ä½œï¼Œå¦‚ç§»åŠ¨åˆ°åˆå§‹ä½ç½®
          this.aMap.moveCamera(CameraUpdateFactory.newLatLngZoom(new LatLng(39.909187, 116.397451), 15));
        });
      };
    
      aboutToAppear(): void {
        // æ³¨å†Œåœ°å›¾åˆ›å»ºå›è°ƒ
        MapViewManager.getInstance().registerMapViewCreatedCallback(this.mapViewCreateCallback);
      }
    
      aboutToDisappear(): void {
        // åœ¨é¡µé¢æ¶ˆå¤±æ—¶ï¼Œæ³¨é”€å›è°ƒå¹¶é”€æ¯åœ°å›¾ä»¥é‡Šæ”¾èµ„æº [4](@ref)
        MapViewManager.getInstance().unregisterMapViewCreatedCallback(this.mapViewCreateCallback);
        if (this.mapView) {
          this.mapView.onDestroy();
        }
      }
    
      build() {
        Column() {
          // åœ°å›¾å®¹å™¨ç»„ä»¶
          MapViewComponent({ mapViewName: MAP_VIEW_NAME })
            .width('100%')
            .height('100%')
        }
        .width('100%')
        .height('100%')
      }
    }
    ```
    

### âš™ï¸ å¸¸ç”¨åŠŸèƒ½ä¸äº¤äº’

åœ°å›¾æ˜¾ç¤ºåï¼Œå¯ä»¥è¿›ä¸€æ­¥æ·»åŠ äº¤äº’å’Œå¸¸ç”¨åŠŸèƒ½ã€‚

- **å¼€å¯å®æ—¶è·¯å†µ**ï¼šè·å–åˆ° `AMap`å¯¹è±¡åï¼Œå¯ä»¥è°ƒç”¨ä¸€è¡Œä»£ç å¼€å¯å®æ—¶è·¯å†µå›¾å±‚
    
    ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    this.mapView.getMapAsync((map: AMap) => {
      this.aMap = map;
      this.aMap.setTrafficEnabled(true); // å¼€å¯å®æ—¶è·¯å†µ
    });
    ```
    
- **æ·»åŠ åœ°å›¾æ ‡è®°ï¼ˆMarkerï¼‰**ï¼šå¯ä»¥åœ¨åœ°å›¾ä¸Šæ·»åŠ è‡ªå®šä¹‰æ ‡è®°ç‚¹
    
    ã€‚
    
    typescript
    
    typescript
    
    å¤åˆ¶
    
    ```
    import { MarkerOptions, BitmapDescriptorFactory } from '@amap/amap_lbs_map3d';
    
    // åœ¨ getMapAsync å›è°ƒä¸­æˆ–ä¹‹åæ‰§è¡Œ
    let markerOptions = new MarkerOptions()
      .setPosition(new LatLng(39.909187, 116.397451)) // æ ‡è®°ä½ç½®
      .setTitle("å¤©å®‰é—¨"); // æ ‡é¢˜
    
    this.aMap?.addMarker(markerOptions);
    ```
    

### ğŸ’¡ é‡è¦æç¤º

- **ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼šåŠ¡å¿…åœ¨ `aboutToAppear`ä¸­æ³¨å†Œå›è°ƒï¼Œåœ¨ `aboutToDisappear`ä¸­æ³¨é”€å›è°ƒå’Œé”€æ¯åœ°å›¾ (`onDestroy`)ï¼Œè¿™æ˜¯é¿å…å†…å­˜æ³„æ¼å’Œåœ°å›¾æ˜¾ç¤ºå¼‚å¸¸çš„å…³é”®
    
    ã€‚
    
- **API Key**ï¼šè¯·ç¡®ä¿åœ¨é«˜å¾·å¼€æ”¾å¹³å°ç”³è¯·æ­£ç¡®çš„API Keyï¼Œå¹¶å°†å…¶æ›¿æ¢åˆ°ä»£ç ä¸­ã€‚Keyéœ€è¦ä¸é¡¹ç›®çš„åŒ…åå’Œç­¾åæŒ‡çº¹ç»‘å®š
    
    ã€‚
    

å¸Œæœ›è¿™ä»½è¯¦ç»†çš„æŒ‡å—èƒ½å¸®åŠ©æ‚¨é¡ºåˆ©å°†é«˜å¾·åœ°å›¾é›†æˆåˆ°æ‚¨çš„é¸¿è’™åº”ç”¨ä¸­ï¼å¦‚æœæ‚¨åœ¨å…·ä½“å®æ–½è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œéšæ—¶å¯ä»¥æé—®ã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/lbs_amap_com.ico)

![](https://hy-openapi-pulbic.hunyuan.tencent.com/app/icon/search_guide/icon_gzh.png)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

æº

é«˜å¾·åœ°å›¾SDKé›†æˆåå¦‚ä½•å®ç°è‡ªå®šä¹‰åœ°å›¾æ ·å¼ï¼Ÿ

é«˜å¾·åœ°å›¾SDKé›†æˆåå¦‚ä½•å®ç°ç¦»çº¿åœ°å›¾ä¸‹è½½ï¼Ÿ

å¦‚ä½•è§£å†³é«˜å¾·åœ°å›¾SDKé›†æˆæ—¶å‡ºç°çš„åœ°å›¾åŠ è½½å¤±è´¥é—®é¢˜ï¼Ÿ

å¦‚ä½•è§£å†³é«˜å¾·åœ°å›¾SDKé›†æˆæ—¶å‡ºç°çš„åœ°å›¾åŠ è½½å¤±è´¥é—®é¢˜ï¼Ÿ

å·²æ·±åº¦æ€è€ƒ(ç”¨æ—¶7ç§’)

å¥½çš„ï¼Œç”¨æˆ·æ­£åœ¨è¯¢é—®å¦‚ä½•è§£å†³é«˜å¾·åœ°å›¾SDKé›†æˆæ—¶å‡ºç°çš„åœ°å›¾åŠ è½½å¤±è´¥é—®é¢˜ã€‚ä»å¯¹è¯å†å²çœ‹ï¼Œç”¨æˆ·ä¹‹å‰å·²ç»åœ¨å¼€å‘é¸¿è’™åº”ç”¨å¹¶é›†æˆé«˜å¾·åœ°å›¾SDKï¼Œç°åœ¨é‡åˆ°äº†å…·ä½“çš„æŠ€æœ¯éšœç¢ï¼Œéœ€è¦è¯¦ç»†çš„æ•…éšœæ’é™¤æ–¹æ¡ˆã€‚

ç”¨æˆ·å¯èƒ½æ˜¯ä¸€ä½ç§»åŠ¨åº”ç”¨å¼€å‘è€…ï¼Œæ­£åœ¨å¼€å‘ä¸€ä¸ªé›†æˆåœ°å›¾åŠŸèƒ½çš„åº”ç”¨ï¼Œä½†åœ¨é›†æˆé«˜å¾·åœ°å›¾SDKæ—¶é‡åˆ°äº†åœ°å›¾æ— æ³•åŠ è½½çš„é—®é¢˜ã€‚ç”¨æˆ·éœ€è¦çš„ä¸ä»…æ˜¯ä¸€èˆ¬çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯å…·ä½“ã€å¯æ“ä½œã€æœ‰æ­¥éª¤çš„æ’æŸ¥æŒ‡å—ã€‚

æˆ‘æ‰“ç®—ä»å‡ ä¸ªæ ¸å¿ƒç»´åº¦æ¥æ„å»ºè¿™ä¸ªå›ç­”ï¼šé¦–å…ˆæ˜¯æœ€åŸºç¡€çš„é…ç½®æ£€æŸ¥ï¼Œç„¶åæ˜¯æƒé™å’Œç½‘ç»œç­‰ç¯å¢ƒå› ç´ ï¼Œæ¥ç€æ˜¯ä»£ç å®ç°ç»†èŠ‚ï¼Œæœ€åæ˜¯ä¸€äº›å¹³å°ç‰¹å®šçš„é—®é¢˜ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæˆ‘å‘ç°

æä¾›äº†æ¯”è¾ƒç³»ç»Ÿçš„æ’æŸ¥æ¡†æ¶ï¼Œè€Œåˆ™åŒ…å«äº†ä¸€äº›å…·ä½“é”™è¯¯åœºæ™¯çš„è§£å†³æ–¹æ¡ˆã€‚

æˆ‘è€ƒè™‘å…ˆç”¨ä¸€ä¸ªæ¸…æ™°çš„è¡¨æ ¼æ¥æ¦‚æ‹¬ä¸»è¦æ’æŸ¥æ–¹å‘ï¼Œè¿™æ ·ç”¨æˆ·èƒ½å¿«é€ŸæŠ“ä½é‡ç‚¹ã€‚è¡¨æ ¼åº”è¯¥åŒ…å«é—®é¢˜ç±»å‹ã€å…·ä½“è¡¨ç°å’Œæ ¸å¿ƒè§£å†³æ€è·¯ï¼Œè®©ç”¨æˆ·èƒ½å¯¹ç—‡ä¸‹è¯ã€‚ç„¶åå†é’ˆå¯¹æ¯ä¸ªæ–¹å‘å±•å¼€è¯¦ç»†è¯´æ˜ï¼Œç‰¹åˆ«æ˜¯è¦åŒ…å«å…·ä½“çš„ä»£ç ç¤ºä¾‹å’Œé…ç½®ä¿®æ”¹æ–¹æ³•ã€‚

ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œ

éƒ½å¼ºè°ƒäº†ä¸‰è¦ç´ ï¼šç½‘ç»œè¿æ¥ã€æƒé™é…ç½®å’ŒAPI Keyè®¾ç½®ï¼Œè¿™åº”è¯¥æ˜¯æ’æŸ¥çš„é‡ç‚¹ã€‚ä½œä¸ºå®˜æ–¹æ–‡æ¡£æä¾›äº†è®¾å¤‡å±‚é¢çš„ä¸€äº›ç‰¹æ®Šæƒ…å†µçš„è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚ç™½å±å’Œç½‘æ ¼æ˜¾ç¤ºé—®é¢˜ã€‚æåˆ°çš„SOæ–‡ä»¶é…ç½®é—®é¢˜å’Œæåˆ°çš„å®¹å™¨é«˜åº¦é—®é¢˜éƒ½æ˜¯æ¯”è¾ƒéšè”½ä½†å…³é”®çš„ç»†èŠ‚ã€‚

æˆ‘ä¼šåœ¨å›ç­”ä¸­ç‰¹åˆ«å¼ºè°ƒAPI Keyé…ç½®çš„æ­£ç¡®æ€§ï¼Œå› ä¸ºè¿™æ˜¯æœ€å¸¸è§çš„é—®é¢˜æºå¤´ä¹‹ä¸€ã€‚åŒæ—¶ä¹Ÿä¼šæé†’ç”¨æˆ·æ³¨æ„ä¸€äº›å®¹æ˜“è¢«å¿½ç•¥çš„ç»†èŠ‚ï¼Œæ¯”å¦‚å®¹å™¨å¿…é¡»æœ‰æ˜ç¡®çš„é«˜åº¦å®šä¹‰ã€SOæ–‡ä»¶çš„æ¶æ„æ”¯æŒç­‰ã€‚å¯¹äºé¸¿è’™ç¯å¢ƒçš„ç‰¹æ®Šæ€§ï¼Œè™½ç„¶æœç´¢ç»“æœä¸­æ²¡æœ‰ä¸“é—¨æåŠï¼Œä½†æˆ‘ä¼šç»“åˆå¼€å‘ç»éªŒè¡¥å……ä¸€äº›æ³¨æ„äº‹é¡¹ã€‚

æœ€åè¦ç»™å‡ºä¸€ä¸ªç³»ç»ŸåŒ–çš„æ’æŸ¥æµç¨‹å»ºè®®ï¼Œå¸®åŠ©ç”¨æˆ·æœ‰æ¡ç†åœ°é€æ­¥è§£å†³é—®é¢˜ï¼Œè€Œä¸æ˜¯ç›²ç›®å°è¯•ã€‚

åœ¨é«˜å¾·åœ°å›¾SDKé›†æˆè¿‡ç¨‹ä¸­ï¼Œåœ°å›¾åŠ è½½å¤±è´¥ç¡®å®ä»¤äººå¤´ç–¼ã€‚æˆ‘å°†å¸®ä½ æ¢³ç†ä¸€ä¸ªæ¸…æ™°çš„æ’æŸ¥æ€è·¯ï¼Œä¸‹è¡¨æ±‡æ€»äº†å¸¸è§é—®é¢˜ç°è±¡åŠå…¶æ ¸å¿ƒè§£å†³æ–¹å‘ï¼š

|é—®é¢˜ç°è±¡|å¯èƒ½åŸå› |æ ¸å¿ƒæ’æŸ¥ç‚¹|
|---|---|---|
|**ç™½å±/é»‘å±**â€‹|èµ„æºç¼ºå¤±ã€SOåº“é…ç½®é”™è¯¯ã€æƒé™ä¸è¶³|æ£€æŸ¥Assetsæ–‡ä»¶å¤¹ã€SOåº“é…ç½®ã€å­˜å‚¨æƒé™|
|**ç½‘æ ¼åœ°å›¾**â€‹|ç½‘ç»œè¿æ¥é—®é¢˜|æ£€æŸ¥ç½‘ç»œçŠ¶æ€åŠæƒé™|
|**å®šä½å¤±è´¥/ä½ç½®ä¸å‡†**â€‹|ä½ç½®æƒé™æœªæˆäºˆã€API Keyé…ç½®é”™è¯¯|æ£€æŸ¥å®šä½æƒé™å’ŒAPI Keyé…ç½®|
|**é¦–æ¬¡åŠ è½½å¤±è´¥**â€‹|ç”Ÿå‘½å‘¨æœŸç®¡ç†ä¸å½“ã€åˆå§‹åŒ–é¡ºåºé”™è¯¯|æ£€æŸ¥åœ°å›¾åˆå§‹åŒ–æ—¶æœºå’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•è°ƒç”¨|
|**Nativeæ–¹æ³•æ‰¾ä¸åˆ°**â€‹|SOåº“æ–‡ä»¶ç¼ºå¤±æˆ–æ¶æ„ä¸åŒ¹é…|æ£€æŸ¥SOåº“æ–‡ä»¶æ˜¯å¦å®Œæ•´æ­£ç¡®æ‰“åŒ…|

### ğŸ”§ æ ¸å¿ƒé…ç½®æ£€æŸ¥

1. **éªŒè¯API Keyé…ç½®**
    
    è¿™æ˜¯æœ€å¸¸è§çš„å¤±è´¥åŸå› ã€‚è¯·ç¡®ä¿ï¼š
    
    - åœ¨é«˜å¾·å¼€æ”¾å¹³å°ç”³è¯·Keyæ—¶ï¼Œ**åº”ç”¨çš„åŒ…åå’Œç­¾åè¯ä¹¦SHA1æŒ‡çº¹**å¿…é¡»ä¸APPå®Œå…¨ä¸€è‡´ã€‚
        
    - åœ¨ `AndroidManifest.xml`çš„ `<application>`æ ‡ç­¾å†…æ­£ç¡®é…ç½®ï¼š
        
        xml
        
        xml
        
        å¤åˆ¶
        
        ```
        <meta-data
            android:name="com.amap.api.v2.apikey"
            android:value="æ‚¨ç”³è¯·çš„é«˜å¾·API Key" />
        ```
        
    - æ£€æŸ¥æ˜¯å¦åœ¨**ä¸»çº¿ç¨‹**ä¸­ã€**åœ°å›¾Viewåˆå§‹åŒ–ä¹‹å‰**å®Œæˆäº†API Keyçš„è®¾ç½®
        
        ã€‚
        
    
2. **æ£€æŸ¥SOåº“æ–‡ä»¶ï¼ˆé’ˆå¯¹NativeæŠ¥é”™ï¼‰**
    
    å¦‚æœé‡åˆ° `UnsatisfiedLinkError`æˆ– "Native method not found" é”™è¯¯
    
    ï¼š
    
    - ç¡®è®¤å°†é«˜å¾·SDKæä¾›çš„æ‰€æœ‰SOåº“æ–‡ä»¶ï¼ˆå¦‚ `armeabi-v7a`, `arm64-v8a`ç­‰ï¼‰å®Œæ•´æ”¾ç½®äº `app/src/main/jniLibs`ç›®å½•ä¸‹ã€‚
        
    - åœ¨ `build.gradle`ä¸­æ­£ç¡®é…ç½®NDKè¿‡æ»¤ï¼Œç¡®ä¿æ‰“åŒ…æ—¶åŒ…å«æ‰€éœ€æ¶æ„ï¼š
        
        gradle
        
        gradle
        
        å¤åˆ¶
        
        ```
        android {
            defaultConfig {
                ndk {
                    // æ ¹æ®éœ€æ±‚é€‰æ‹©ABIï¼Œå‡å°‘APKä½“ç§¯
                    abiFilters 'armeabi-v7a', 'arm64-v8a'
                }
            }
        }
        ```
        
    

### ğŸ“± ä»£ç ä¸å®ç°æ’æŸ¥

1. **æƒé™ä¸ç½‘ç»œçŠ¶æ€**
    
    - **æƒé™**ï¼šä¸ä»…è¦åœ¨ `AndroidManifest.xml`ä¸­å£°æ˜ç½‘ç»œå’Œå®šä½æƒé™ï¼Œåœ¨Android 6.0ä»¥ä¸Šç³»ç»Ÿè¿˜éœ€åœ¨ä»£ç ä¸­**åŠ¨æ€ç”³è¯·**ç²¾ç¡®å®šä½æƒé™ï¼ˆ`ACCESS_FINE_LOCATION`ï¼‰
        
        ã€‚
        
    - **ç½‘ç»œçŠ¶æ€**ï¼šåœ¨åœ°å›¾åˆå§‹åŒ–å‰ï¼Œæ£€æŸ¥è®¾å¤‡ç½‘ç»œæ˜¯å¦é€šç•…
        
        ã€‚
        
    
2. **åœ°å›¾ç”Ÿå‘½å‘¨æœŸç®¡ç†**
    
    ç¡®ä¿æ­£ç¡®è°ƒç”¨ `MapView`çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œè¿™ä¸Activityçš„ç”Ÿå‘½å‘¨æœŸç´§å¯†ç›¸å…³
    
    ï¼š
    
    java
    
    java
    
    ä¸‹è½½
    
    å¤åˆ¶
    
    è¿è¡Œ
    
    ```
    public class MainActivity extends AppCompatActivity {
        private MapView mMapView;
    
        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            mMapView = findViewById(R.id.mapView);
            mMapView.onCreate(savedInstanceState); // å¿…é¡»è°ƒç”¨
        }
    
        @Override
        protected void onResume() {
            super.onResume();
            mMapView.onResume();
        }
    
        @Override
        protected void onPause() {
            super.onPause();
            mMapView.onPause();
        }
    
        @Override
        protected void onDestroy() {
            super.onDestroy();
            mMapView.onDestroy();
        }
    
        @Override
        protected void onSaveInstanceState(Bundle outState) {
            super.onSaveInstanceState(outState);
            mMapView.onSaveInstanceState(outState);
        }
    }
    ```
    
3. **å®¹å™¨ä¸å¸ƒå±€**
    
    - ç¡®ä¿åœ°å›¾å®¹å™¨ `MapView`å·²è·å¾—æœ‰æ•ˆçš„**å®½åº¦å’Œé«˜åº¦**ã€‚å¦‚æœé«˜åº¦ä¸º0ï¼Œåœ°å›¾å°†æ— æ³•æ˜¾ç¤ºã€‚æœ‰æ—¶åœ¨å¸ƒå±€å¤æ‚æ—¶ï¼Œéœ€è¦æ£€æŸ¥å¸ƒå±€è®¡ç®—æˆ–å°è¯•ç»™ `MapView`è®¾ç½®å›ºå®šé«˜åº¦
        
        ã€‚
        
    - æ£€æŸ¥ `MapView`æˆ–å…¶çˆ¶å®¹å™¨æ˜¯å¦è¢«å…¶ä»–è§†å›¾ï¼ˆå¦‚å¼¹çª—ã€é«˜ `z-index`çš„å…ƒç´ ï¼‰é®æŒ¡ã€‚è°ƒæ•´å±‚çº§æˆ– `z-index`ç¡®ä¿åœ°å›¾å¯è§
        
        ã€‚
        
    

### ğŸ› ï¸ è¿›é˜¶æ’æŸ¥ä¸ä¼˜åŒ–

1. **å…³é—­Instant Run**
    
    Android Studioçš„Instant RunåŠŸèƒ½å¯èƒ½ä¼šå¹²æ‰°èµ„æºçš„æ­£å¸¸æ‰“åŒ…å’ŒåŠ è½½ï¼Œå¯¼è‡´åœ°å›¾ç™½å±ã€‚å°è¯•**å…³é—­Instant Run**åé‡æ–°ç¼–è¯‘è¿è¡Œ
    
    ã€‚
    
2. **å¼€å¯è¯¦ç»†æ—¥å¿—è°ƒè¯•**
    
    é«˜å¾·åœ°å›¾SDKæä¾›äº†è¯¦ç»†çš„æ—¥å¿—åŠŸèƒ½ï¼Œåœ¨å¼€å‘é˜¶æ®µå¼€å¯å®ƒæœ‰åŠ©äºå®šä½é—®é¢˜ï¼š
    
    java
    
    java
    
    ä¸‹è½½
    
    å¤åˆ¶
    
    è¿è¡Œ
    
    ```
    // åœ¨åˆå§‹åŒ–åœ°å›¾å‰è®¾ç½®
    MapsInitializer.setLogEnable(true); // å¼€å¯SDKçš„æ—¥å¿—è¾“å‡º
    ```
    
    é€šè¿‡è¿‡æ»¤ `Amap`æˆ– `map`ç­‰å…³é”®å­—ï¼Œåœ¨Logcatä¸­è§‚å¯Ÿé”™è¯¯æˆ–è­¦å‘Šä¿¡æ¯ã€‚
    
3. **æ£€æŸ¥æ··æ·†è§„åˆ™**
    
    å¦‚æœé¡¹ç›®å¼€å¯äº†ä»£ç æ··æ·†ï¼ˆProguardï¼‰ï¼Œéœ€åœ¨ `proguard-rules.pro`æ–‡ä»¶ä¸­ä¸ºé«˜å¾·SDKæ·»åŠ å¯¹åº”çš„æ··æ·†ä¿ç•™è§„åˆ™ï¼Œé¿å…SDKçš„ç±»å’Œæ–¹æ³•è¢«æ··æ·†åæ— æ³•æ­£å¸¸è°ƒç”¨ã€‚è§„åˆ™é€šå¸¸åœ¨é«˜å¾·å®˜æ–¹æ–‡æ¡£ä¸­æä¾›ã€‚
    

### æ¸…æ™°çš„æ’æŸ¥è·¯å¾„å»ºè®®

å½“é—®é¢˜å‘ç”Ÿæ—¶ï¼Œå»ºè®®æŒ‰ä»¥ä¸‹é¡ºåºæ’æŸ¥ï¼š

1. **ç¬¬ä¸€æ­¥ï¼šç¡®è®¤åŸºç¡€é…ç½®**
    
    æ£€æŸ¥API Keyçš„åŒ…åã€ç­¾åæ˜¯å¦åŒ¹é…ï¼Œå¹¶ç¡®ä¿ç½‘ç»œå’Œå®šä½æƒé™å·²è·å–ã€‚
    
2. **ç¬¬äºŒæ­¥ï¼šæ£€æŸ¥é›†æˆç¯å¢ƒ**
    
    ç¡®è®¤SOåº“æ–‡ä»¶å·²æ­£ç¡®æ”¾å…¥é¡¹ç›®ï¼Œå¹¶æ£€æŸ¥ `MapView`çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ˜¯å¦åœ¨ä¸Activityå¯¹åº”çš„æ—¶æœºè¢«è°ƒç”¨ã€‚
    
3. **ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹è¿è¡Œæ—¶çŠ¶æ€**
    
    å¼€å¯SDKæ—¥å¿—ï¼Œè§‚å¯ŸLogcatä¸­çš„é”™è¯¯ä¿¡æ¯ï¼›æ£€æŸ¥ `MapView`çš„å¸ƒå±€å®½é«˜æ˜¯å¦æœ‰æ•ˆã€‚
    
4. **ç¬¬å››æ­¥ï¼šå¯»æ±‚å®˜æ–¹æ”¯æŒ**
    
    è‹¥ä»¥ä¸Šæ­¥éª¤å‡æ— æ³•è§£å†³é—®é¢˜ï¼Œå¯ä»¥åˆ°é«˜å¾·å¼€æ”¾å¹³å°ç¤¾åŒºæé—®ï¼Œæé—®æ—¶è¯·è¯¦ç»†æè¿°é—®é¢˜ç°è±¡ã€å¤ç°æ­¥éª¤ã€é”™è¯¯æ—¥å¿—ä»¥åŠå·²å°è¯•çš„æ’æŸ¥æ–¹æ³•ã€‚
    

å¸Œæœ›è¿™ä»½è¯¦ç»†çš„æŒ‡å—èƒ½å¸®åŠ©ä½ å¿«é€Ÿå®šä½å¹¶è§£å†³é—®é¢˜ã€‚å¦‚æœä½ åœ¨æŸä¸ªå…·ä½“ç¯èŠ‚é‡åˆ°å›°éš¾ï¼Œæˆ–æœ‰æ›´è¯¦ç»†çš„ç°è±¡æè¿°ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·±å…¥æ¢è®¨ã€‚

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_51cto_com.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/blog_csdn_net.ico)

![](https://cdn-yb.icon.qq.com/zuowei_dir/developer_amap_com.ico)

æº

è¯·æä¾›é«˜å¾·åœ°å›¾SDKé›†æˆç¤ºä¾‹é¡¹ç›®

é«˜å¾·åœ°å›¾SDKé›†æˆåå¦‚ä½•å®ç°åœ°å›¾ç¼©æ”¾çº§åˆ«é™åˆ¶ï¼Ÿ

å¦‚ä½•é€šè¿‡Logcatæ—¥å¿—å¿«é€Ÿå®šä½é«˜å¾·åœ°å›¾SDKçš„åŠ è½½å¤±è´¥åŸå› ï¼Ÿ